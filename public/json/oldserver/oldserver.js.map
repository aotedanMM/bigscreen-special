{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///./node_modules/_@babel_runtime@7.12.1@@babel/runtime/helpers/defineProperty.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/a-function.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/a-possible-prototype.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/add-to-unscopables.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/advance-string-index.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/an-object.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/array-for-each.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/array-includes.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/array-iteration.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/array-method-has-species-support.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/array-method-is-strict.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/array-method-uses-to-length.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/array-species-create.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/classof-raw.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/classof.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/copy-constructor-properties.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/correct-is-regexp-logic.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/create-non-enumerable-property.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/create-property-descriptor.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/create-property.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/descriptors.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/document-create-element.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/dom-iterables.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/engine-user-agent.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/engine-v8-version.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/enum-bug-keys.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/export.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/fails.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/fix-regexp-well-known-symbol-logic.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/function-bind-context.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/get-built-in.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/global.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/has.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/hidden-keys.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/html.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/ie8-dom-define.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/indexed-object.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/inherit-if-required.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/inspect-source.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/internal-state.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/is-array.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/is-forced.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/is-object.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/is-pure.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/is-regexp.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/native-symbol.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/native-weak-map.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/not-a-regexp.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/object-create.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/object-define-properties.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/object-define-property.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/object-get-own-property-descriptor.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/object-get-own-property-names.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/object-get-own-property-symbols.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/object-keys-internal.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/object-keys.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/object-property-is-enumerable.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/object-set-prototype-of.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/object-to-string.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/own-keys.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/path.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/redefine.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/regexp-exec-abstract.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/regexp-exec.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/regexp-flags.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/regexp-sticky-helpers.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/require-object-coercible.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/same-value.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/set-global.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/shared-key.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/shared-store.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/shared.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/species-constructor.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/string-multibyte.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/string-repeat.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/string-trim-forced.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/string-trim.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/this-number-value.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/to-absolute-index.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/to-indexed-object.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/to-integer.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/to-length.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/to-object.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/to-primitive.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/to-string-tag-support.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/uid.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/use-symbol-as-uid.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/well-known-symbol.js","webpack:///./node_modules/_core-js@3.6.5@core-js/internals/whitespaces.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.array.concat.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.array.filter.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.array.find.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.array.for-each.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.array.includes.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.array.index-of.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.array.join.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.array.map.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.array.slice.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.array.sort.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.function.name.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.number.constructor.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.number.to-fixed.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.object.keys.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.object.to-string.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.regexp.exec.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.regexp.to-string.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.string.ends-with.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.string.includes.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.string.match.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.string.replace.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.string.search.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.string.split.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.string.starts-with.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/es.string.trim.js","webpack:///./node_modules/_core-js@3.6.5@core-js/modules/web.dom-collections.for-each.js","webpack:///(webpack)/buildin/global.js","webpack:///./public/json/oldserver/BaseDataService.js","webpack:///./public/json/oldserver/CommonService.js","webpack:///./public/json/oldserver/CoordTransformUtil.js","webpack:///./public/json/oldserver/DetailInfoServices.js","webpack:///./public/json/oldserver/DistrictUtil.js","webpack:///./public/json/oldserver/EmerSourceService.js","webpack:///./public/json/oldserver/HazardQueryService.js","webpack:///./public/json/oldserver/RescueAssistanceService.js","webpack:///./public/json/oldserver/RescueAssistanceServiceChartExt.js","webpack:///./public/json/oldserver/RescueAssistanceServiceExt.js","webpack:///./public/json/oldserver/RescueHelpService.js","webpack:///./public/json/oldserver/RescueTeamService.js","webpack:///./public/json/oldserver/ResourceQueryService.js","webpack:///./public/json/oldserver/RiskQueryServiceConfig.js","webpack:///./public/json/oldserver/RiskSourceService.js","webpack:///./public/json/oldserver/RiskTroubleQueryService.js","webpack:///./public/json/oldserver/ServiceModule.js","webpack:///./public/json/oldserver/bufferService.js","webpack:///./public/json/oldserver/index.js","webpack:///./public/json/oldserver/provinceData.js","webpack:///./public/json/oldserver/queryData.js","webpack:///./public/json/oldserver/queryservice.js","webpack:///./public/json/oldserver/typeTree.js"],"names":["window","Service","opts","options","resourceKeys","jQuery","extend","commonService","EMapServerV2","CommonService","prototype","getStatistics","callback","ctx","slice","err","data","call","getStatisticsByFilter","filter","districtCode","getDataList","flatTag","getNearbyList","radius","config","getEventData","eventType","configRadius","tag","SEARCH_DIST","isNaN","parseFloat","i","length","resourceKey","hasOwnProperty","resultSet","list","item","codeKey","itemList","rangeMap","range","Number","MAX_VALUE","itemCount","j","rowObj","sumCount","SUMOUTPUT","rangeKey","rangeObj","rangeArr","push","newData","k","BaseDataService","configUrl","serverUrl","EMAP_CONFIG","common","mongoService","_resourceTemp","_configTemp","seperator","eventTypeList","getResources","self","aggregate","path","preserveNullAndEmptyArrays","$project","$sort","query","dataSetId","JSON","stringify","eId","url","type","dataType","success","error","Error","ajax","getResourceConfig","plainConfig","resources","resourceSet","resource","serviceObj","service","children","Object","keys","childKey","resourceId","childResource","serviceObjClone","id","tableFields","tableName","districtField","keyWordFields","keyField","idKey","fieldMap","sort","sumField","getResourceTreeByEventType","cb","allList","rootId","nodeMap","matchNodeMap","filterType","index","itemId","NODEID","tempObj","name","NAME","parentId","PARENTID","resourceTag","NODEKEY","e_orderNum","orderNum","ORDERNUM","allCount","ALLTEAMNUM","limit","NEARBYTEAMNUM","READYTEANUM","resultMap","nodeId","matchNode","handleEachNode","newList","nId","treeData","formatTree","pIdField","idField","visitAndSortByDepth","idx","a","b","_order_num","aN","bN","node","matchMap","fullMap","visitParent","visitChildren","parent","ensureOrderNum","kk","tempNode","obj","fullNodeSet","nodeTemp","getResourcesByEventType","resourceNodeMap","regex","test","groups","exec","getEventType","TYPECODE","nodes","nodeList","temp","pId","orig","visitMap","visitNode","parentNode","arguments","callee","treeNode","getFilterResources","aggregateList","aggregateObj","getStatisticsAggregate","statisticsMulti","resultList","total","resourceList","r","rk","count","parseInt","title","tabTitle","tabNumber","districtMatch","getDistrictMatch","queryParams","$match","or","gte","lte","$count","searchId","queryIndex","getMapDataList","param","getSelectColumn","fields","fieldProject","$and","geometry","geom","$geoIntersects","$geometry","con","$or","keyWord","keywordMatch","getSearchMatch","select","$","res","formatResultColumns","forEach","element","flatObject","key","value","selectArr","originField","projectedField","includes","result","join","keyword","fbsArr","indexOf","replace","resourceKeyList","split","getAllListAggregate","pageSize","pageIndex","resourceFilter","aggregateMulti","itemData","e","skipVal","limitVal","$limit","kwMatch","getIdMatch","$skip","project","projectSuffix","field","toString","lookUpObj","lookupAlias","as","$lookup","$unwind","_key","match","districtCodes","districtKey","eachFilter","$regex","getDistrictRegex","code","c","substr","getRecordIdListByFilter","tables","tableCount","tableObj","itemResult","idList","_id","kw","kwquery","idquery","searchid","datasetid","agregate","assign","near","d","Array","isArray","_count","resourceObj","thisConfig","point","Keyword","getNearbyAggregate","buffer","paging","distanceField","resultArr","itemObj","itemConfig","resultObj","geoNear","maxDistance","spherical","coordinates","includeLocs","parseProject","getListByFilter","queryResources","qResource","getListByFilterAggregate","resultKey","$in","G","import","util","x_PI","PI","ee","bd09togcj02","bd_lonlat","bd_lon","bd_lat","x","y","z","Math","sqrt","sin","theta","atan2","cos","gg_lng","gg_lat","gcj02_lonlat","gcj02tobd09","gcj_lnglat","lat","lng","bd_lng","wgs84togcj02","wgs_lnglat","out_of_china","console","log","dlat","transformlat","dlng","transformlng","radlat","magic","sqrtmagic","mglat","mglng","gcj02towgs84","gcj_lonlat","wgslng","wgslat","ret","abs","CoordTransformUtil","getFireTeamDetail","getRescueTeamDetail","getReposityDetail","getWarBaseDetail","getExpertDataDetail","getShelterDataDetail","getDangerQYDetail","dataServerStatistics","getGMQYDetail","getMKQYDetail","getFMKQYDetail","getGEODISASTERDetail","getYHBZQYDetail","getDangerDetail","getBaseDataDetail","tablename","getEquipDataDetail","DetailInfoServices","DistrictUtil","getDistrict","context","requestHandler","status","xhr","utils","CommonUtil","isFunction","info","msg","districtCodeArr","len","table","_getDicTableName","endsWith","ajaxGetData","_getQueryUrl","evacuationIndex","fullName","districtTables","static","tableCfg","shortName","evacuationParams","_getStaticsQueryUrl","getDistrictPipline","replaceStrs","classifyKey","parse","showLoading","ajaxGet","s","f","results","refineStatisticsData","extra","agg","statisticsLevel","strOper","tableCfgs","dicTable","lookup","src","regexs","replaces","dataArr","getTwoObjHas","oneObj","twoObj","doClassifyKeyUndefined","dicts","district","dict","gov","lnglats","trim","longitude","latitude","adcode","doClassifyKeyHas","itemKeys","classifyVal","items","key0","getServiceConfig","dataServerIP","dataServerPageQuery","_getMultiQueryUrl","dataServerQuery","search","ajaxPostData","async","_callback","startsWith","_addDistricPolygonToLayer_ProcessData","drawLayer","undefined","districEles","polygonGeometry","g2","sfs","GeometryFactory","createGeometryFromGeoJson","map","spatialReference","ring","Ring","addGeometry","polygonEle","Element","symbol","add","districGeoJsons","EmerSourceService","NewHazardQConfig","urlNew","queryMulti","isEmptyValue","R","fullRange","caculateDistancePoints","pt1","pt2","rad","lat1","lat2","acos","min","store","getEqStatistics","geoJsonReader","GeometryUtil","getGeoJSONReader","jtsGeometry","read","difference","pointJson","jtsPoint","distanceLimit","distance","resourceCol","resourceTables","server","resourceResult","levels","dataList","dataLen","levelResult","levelFn","level","getEqData","queryCol","queryItem","selectList","resultHandler","resultdata","resultCol","levelCode","dataItem","dataTemp","_table","_type","HazardQueryService","rescueWorker","resuceNeed","materialNeed","placement","materialSet","getRescueWorker","updateRescueWorker","getCounties","codeList","xy","getRescueNeed","updateRescueNeed","tlist","workers","num","getRescueCol","typeList","bufferGeom1","SpatialOPUtil","getBuffer","titlePoint","chinaRange","bufferGeom2","differGeom","_getRescue","querys","his","needNum","max","getRescueByTypeAndNeedLoc","byDistance","provideList","_caculateDispatchResult","numKey","needCount","fulfillCount","thisItem","attachNum","promiseCount","_caculateDispatchAttachResult","needSet","maxReposityCount","dispatchSet","provideItem","attachKey","attachList","attachItem","addNum","queryObj","bufferMeter","$geoNear","from","localField","foreignField","typeCode","typeName","address","carNum","contact","tel","RescueAssistanceServiceExt","RescueAssistanceServiceChartExt","RescueAssistanceService","ext","getTeamNeedSta","textList","chartData","typetitle","totalNum","getRescueWorkerSta","dataObj","team","unit","ydata","xdata","person","typeMap","teamValue","personValue","matchedType","val","getMaterialNeedSta","getMaterialNeed","transfering","onArrival","placed","placing","unplaced","mObj","getPlacementSta","getPlacement","notPlacedNum","capacity","totalPlacementLeft","totalCapacityLeft","totalPlacementVictims","totalPlacement","toFixed","totalCapacity","updateMaterialNeed","getNearbyReposity","_getNearbyReposity","dispatchResult","materials","materialObj","MATERIALNAME","MATERIALTYPE","MATERIALNUM","MEASUREUNIT","material","districts","DISTRICTNAME","LEVELNAME","getReposityDispatch","promise","current","dtd","Deferred","_pathAnalysis","start","end","then","resolve","done","repositySet","duration","reposityList","reposity","startTemp","endTemp","GaoDeService","GaoDeKey","route","paths","measureService","MeasureService","projectService","CoordinateTransform","line","reject","er","updatePlacement","totalCapacityPlaced","placeNum","placementPercentage","getRescueTeam","nearQuery","sortByDistance","getReposity","RescueHelpService","RescueTeamService","getGroupCounts","dataA","types","queryOpts","BigTypeCountQueryConfig","bufferList","servicemodule","bufferStatistics","message","getGroupCountsNoPoly","codes","ResourceQueryService","RiskQueryServiceConfig","RiskSourceService","ratio","queryData","RiskTroubleQueryService","confs","isNearbyQuery","conf","datasetId","TABLE_PREFIX","DICT_SUFFIX","EID","bufferCount","queryId","aggregates","keyWords","defaultSumObj","sumType","sumFields","groupObj","q","$sum","$group","dataSet","bufferResult","countResult","sumObj","bufferQuery","defaultLimit","defaults","projectMap","sorts","relations","relProjectSet","relationObj","relField","alias","fieldName","eachData","queryById","dataId","queryByAttr","bufferQueryMaterial","materialId","attachCount","dis","matchObj","debug","ServiceModule","bufferService","CONSTS","queryDataSet","tableNames","caculateDistance","geojson","point2d","transform","Point","geom2d","asGeoJson","jtsGeom","isObject","isString","handleEmptyValue","attrName","attrVal","EMPTY_STR","extractDictShowField","showField","handleContactTel","EQUIPMENT","TEAM","n","CONTACT","TEL","filterByKw","kwFields","flag","kwField","relShowField","mapName","jsts","io","GeoJSONReader","resourceConfig","initialize","tableIdSet","listFields","listFieldMap","listRelations","fieldObj","detailFields","detail","detailFieldMap","detailRelations","relateTables","relateTable","relateFieldMap","relateRelations","listKw","bufferOrPolygonQuery","polygon","getWktReader","getGeoJSONWriter","write","projService","pointGeom","pointGeom3857","polygonGeom","_query","districtQuery","districtTable","geojsonList","tempCoordinates","geoJsonItem","queryDetail","thisResourceObj","thisTable","relationTableNames","relationTables","relation","qItem","_makeQuery","_getTableMeta","concat","tableMetaSet","equConfig","tableMeta","attrObj","metaFields","model","attributes","relObj","kkVv","attribute","label","BELONG_RESCUE","attribute1","CONTACT_LABEL","attribute2","TEL_LABEL","metaField","fieldDesc","equTable","relationData","metaFieldsLen","fieldsLen","kkk","k4","queryEquDetail","getTypeList","configResources","resourceCount","tempSet","resourceIndex","resourceTypes","classification","newUUID","sortField","sortDirection","dictTable","idxArr","m","resultItem","resourcesOpt","queryResurces","resourceQueryTables","queryAllTable","resourceQueryTableSet","queryTable","tableQueryObj","filteredQueryTable","andList","shouldFilterOnServer","_kwFilterOnServer","orList","j1","resourceDataList","relationsLen","shouldMap","dataTempList","dataCount","tempItem","rIdx","mapField","table_name","table_label","fieldList","populate","fieldAlias","j2","dataSetIds","dataSetCache","dataSetIds2Query","statisticByDistrict","useCache","queryByDistrict","queryAllField","Util","require","provinceDistrictData","getConfig","equTableAndCodeConfig","callBack","hide","addTypeNameToEqu","find","attr","EquInfArr","tagInf","equTypeCode","EQUIPTYPECODE","equTableNameConfig","keyTwo","equTypeName","equConfigInf","equContrast","EQUIPTYPENAME","queryDataByBuffer","queryDataByDis","callBackFun","getRelevnceEquTypeName","getDetailEquTypeName","newTypeName","queryTree","queryEquById","queryAllEquField","DefenceObjConfig","QueryConfig","getpeopleInforData","EventTime","peopletable","currenttime","_querypeopleTotaldata","callBackGetData","people","POPU_DISTPOPU","POPTOTAL","getDistrictInforData","getCurrencyData","typecode","rescueTypecodes","earthLevel","typecodeArr","getCurrencyCount","queries","counter","typecodes","statisticsOpts","_queryDistricts","callback1","_queryDistrictPolygon","_queryTownPolygon","asWkt","contentType","centerid","tmpitem","pac","shape_area","shapeArea","createGeometryFromWkt","startpoint","endpoint","polyline","Polyline","Path","addPoint","_distance","objectid","_queryCity","getProctectObjectDatacount","typeCodeQuery","regStrArr","originalField","queryservice","typeTree","getZtree","setting","check","enable","chkboxType","view","dblClickExpand","simpleData","beforeClick","onCheck","data1","data2","edu_type_list","checked","learner_list","obj1","treeId","zTree","fn","getZTreeObj","checkNode","getCheckedNodes","v","l","isParent","substring","cityObj","showMenu","cityOffset","offset","show","css","left","top","outerHeight","slideDown","bind","onBodyDown","hideMenu","fadeOut","unbind","event","target","parents","document","ready","init","objTree1","objTree2"],"mappings":"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sHAAqC;AACxE,+BAA+B,mBAAO,CAAC,8HAAyC;;AAEhF;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACTA,YAAY,mBAAO,CAAC,oFAAoB;;AAExC;AACA;AACA,iCAAiC,MAAM,mBAAmB,UAAU,EAAE,EAAE;AACxE,CAAC;;;;;;;;;;;;ACLD,aAAa,mBAAO,CAAC,sFAAqB;AAC1C,eAAe,mBAAO,CAAC,4FAAwB;;AAE/C;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;;;;;ACTA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;AClCA,iBAAiB,mBAAO,CAAC,kGAA2B;;AAEpD;;;;;;;;;;;;ACFA,aAAa,mBAAO,CAAC,sFAAqB;AAC1C,gBAAgB,mBAAO,CAAC,4GAAgC;;AAExD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;;;;;;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACTA,aAAa,mBAAO,CAAC,sFAAqB;AAC1C,+BAA+B,mBAAO,CAAC,8IAAiD;AACxF,kCAAkC,mBAAO,CAAC,sIAA6C;AACvF,eAAe,mBAAO,CAAC,0FAAuB;AAC9C,gBAAgB,mBAAO,CAAC,8FAAyB;AACjD,gCAAgC,mBAAO,CAAC,gIAA0C;AAClF,eAAe,mBAAO,CAAC,4FAAwB;;AAE/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,mDAAmD;AACnD,GAAG;AACH,kCAAkC;AAClC;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACrDA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;;;;;;;;;;;;ACNa;AACb;AACA,mBAAO,CAAC,kGAA2B;AACnC,eAAe,mBAAO,CAAC,0FAAuB;AAC9C,YAAY,mBAAO,CAAC,oFAAoB;AACxC,sBAAsB,mBAAO,CAAC,4GAAgC;AAC9D,iBAAiB,mBAAO,CAAC,gGAA0B;AACnD,kCAAkC,mBAAO,CAAC,sIAA6C;;AAEvF;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB;AACrB;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,yBAAyB,4CAA4C;AACrE;AACA;AACA,CAAC;;AAED;AACA;;AAEA;AACA;AACA;AACA,6BAA6B,UAAU;AACvC;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA6C,WAAW;AACxD;AACA;AACA;;AAEA,2BAA2B,mBAAmB,aAAa;;AAE3D;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAkB;AAClB;AACA,gBAAgB;AAChB;AACA,cAAc;AACd,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA,gCAAgC,4CAA4C;AAC5E;AACA;AACA,2BAA2B,uCAAuC;AAClE;AACA;;AAEA;AACA;;;;;;;;;;;;AC5HA,gBAAgB,mBAAO,CAAC,8FAAyB;;AAEjD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACvBA,WAAW,mBAAO,CAAC,kFAAmB;AACtC,aAAa,mBAAO,CAAC,sFAAqB;;AAE1C;AACA;AACA;;AAEA;AACA;AACA;AACA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AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,qBAAqB,oBAAoB;AACzC;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,mBAAmB;AAC1C;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,CAAC;;;;;;;;;;;;;ACtIY;AACb,oCAAoC,mBAAO,CAAC,8IAAiD;AAC7F,eAAe,mBAAO,CAAC,4FAAwB;AAC/C,6BAA6B,mBAAO,CAAC,0HAAuC;AAC5E,gBAAgB,mBAAO,CAAC,8FAAyB;AACjD,iBAAiB,mBAAO,CAAC,kHAAmC;;AAE5D;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;;ACjCY;AACb,oCAAoC,mBAAO,CAAC,8IAAiD;AAC7F,eAAe,mBAAO,CAAC,4FAAwB;AAC/C,eAAe,mBAAO,CAAC,4FAAwB;AAC/C,6BAA6B,mBAAO,CAAC,0HAAuC;AAC5E,yBAAyB,mBAAO,CAAC,gHAAkC;AACnE,yBAAyB,mBAAO,CAAC,kHAAmC;AACpE,eAAe,mBAAO,CAAC,4FAAwB;AAC/C,qBAAqB,mBAAO,CAAC,kHAAmC;AAChE,iBAAiB,mBAAO,CAAC,gGAA0B;AACnD,YAAY,mBAAO,CAAC,oFAAoB;;AAExC;AACA;AACA;;AAEA;AACA,qCAAqC,iCAAiC,EAAE;;AAExE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+EAA+E;AAC/E;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,yBAAyB,mBAAmB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;;ACrIY;AACb,QAAQ,mBAAO,CAAC,sFAAqB;AACrC,+BAA+B,mBAAO,CAAC,8IAAiD;AACxF,eAAe,mBAAO,CAAC,4FAAwB;AAC/C,iBAAiB,mBAAO,CAAC,kGAA2B;AACpD,6BAA6B,mBAAO,CAAC,0HAAuC;AAC5E,2BAA2B,mBAAO,CAAC,wHAAsC;AACzE,cAAc,mBAAO,CAAC,wFAAsB;;AAE5C;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA,GAAG,uFAAuF;AAC1F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;;;;;;;;;;;;AC/BY;AACb,QAAQ,mBAAO,CAAC,sFAAqB;AACrC,YAAY,mBAAO,CAAC,gGAA0B;AAC9C,6BAA6B,mBAAO,CAAC,8GAAiC;;AAEtE;AACA;AACA,GAAG,wEAAwE;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","file":"oldserver.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","function _defineProperty(obj, key, value) {\n  if (key in obj) {\n    Object.defineProperty(obj, key, {\n      value: value,\n      enumerable: true,\n      configurable: true,\n      writable: true\n    });\n  } else {\n    obj[key] = value;\n  }\n\n  return obj;\n}\n\nmodule.exports = _defineProperty;","module.exports = function (it) {\n  if (typeof it != 'function') {\n    throw TypeError(String(it) + ' is not a function');\n  } return it;\n};\n","var isObject = require('../internals/is-object');\n\nmodule.exports = function (it) {\n  if (!isObject(it) && it !== null) {\n    throw TypeError(\"Can't set \" + String(it) + ' as a prototype');\n  } return it;\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\nvar create = require('../internals/object-create');\nvar definePropertyModule = require('../internals/object-define-property');\n\nvar UNSCOPABLES = wellKnownSymbol('unscopables');\nvar ArrayPrototype = Array.prototype;\n\n// Array.prototype[@@unscopables]\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\nif (ArrayPrototype[UNSCOPABLES] == undefined) {\n  definePropertyModule.f(ArrayPrototype, UNSCOPABLES, {\n    configurable: true,\n    value: create(null)\n  });\n}\n\n// add a key to Array.prototype[@@unscopables]\nmodule.exports = function (key) {\n  ArrayPrototype[UNSCOPABLES][key] = true;\n};\n","'use strict';\nvar charAt = require('../internals/string-multibyte').charAt;\n\n// `AdvanceStringIndex` abstract operation\n// https://tc39.github.io/ecma262/#sec-advancestringindex\nmodule.exports = function (S, index, unicode) {\n  return index + (unicode ? charAt(S, index).length : 1);\n};\n","var isObject = require('../internals/is-object');\n\nmodule.exports = function (it) {\n  if (!isObject(it)) {\n    throw TypeError(String(it) + ' is not an object');\n  } return it;\n};\n","'use strict';\nvar $forEach = require('../internals/array-iteration').forEach;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar STRICT_METHOD = arrayMethodIsStrict('forEach');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('forEach');\n\n// `Array.prototype.forEach` method implementation\n// https://tc39.github.io/ecma262/#sec-array.prototype.foreach\nmodule.exports = (!STRICT_METHOD || !USES_TO_LENGTH) ? function forEach(callbackfn /* , thisArg */) {\n  return $forEach(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n} : [].forEach;\n","var toIndexedObject = require('../internals/to-indexed-object');\nvar toLength = require('../internals/to-length');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\n\n// `Array.prototype.{ indexOf, includes }` methods implementation\nvar createMethod = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIndexedObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) {\n      if ((IS_INCLUDES || index in O) && O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.includes` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.includes\n  includes: createMethod(true),\n  // `Array.prototype.indexOf` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.indexof\n  indexOf: createMethod(false)\n};\n","var bind = require('../internals/function-bind-context');\nvar IndexedObject = require('../internals/indexed-object');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\nvar push = [].push;\n\n// `Array.prototype.{ forEach, map, filter, some, every, find, findIndex }` methods implementation\nvar createMethod = function (TYPE) {\n  var IS_MAP = TYPE == 1;\n  var IS_FILTER = TYPE == 2;\n  var IS_SOME = TYPE == 3;\n  var IS_EVERY = TYPE == 4;\n  var IS_FIND_INDEX = TYPE == 6;\n  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n  return function ($this, callbackfn, that, specificCreate) {\n    var O = toObject($this);\n    var self = IndexedObject(O);\n    var boundFunction = bind(callbackfn, that, 3);\n    var length = toLength(self.length);\n    var index = 0;\n    var create = specificCreate || arraySpeciesCreate;\n    var target = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;\n    var value, result;\n    for (;length > index; index++) if (NO_HOLES || index in self) {\n      value = self[index];\n      result = boundFunction(value, index, O);\n      if (TYPE) {\n        if (IS_MAP) target[index] = result; // map\n        else if (result) switch (TYPE) {\n          case 3: return true;              // some\n          case 5: return value;             // find\n          case 6: return index;             // findIndex\n          case 2: push.call(target, value); // filter\n        } else if (IS_EVERY) return false;  // every\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : target;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.forEach` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.foreach\n  forEach: createMethod(0),\n  // `Array.prototype.map` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.map\n  map: createMethod(1),\n  // `Array.prototype.filter` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.filter\n  filter: createMethod(2),\n  // `Array.prototype.some` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.some\n  some: createMethod(3),\n  // `Array.prototype.every` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.every\n  every: createMethod(4),\n  // `Array.prototype.find` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.find\n  find: createMethod(5),\n  // `Array.prototype.findIndex` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.findIndex\n  findIndex: createMethod(6)\n};\n","var fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar SPECIES = wellKnownSymbol('species');\n\nmodule.exports = function (METHOD_NAME) {\n  // We can't use this feature detection in V8 since it causes\n  // deoptimization and serious performance degradation\n  // https://github.com/zloirock/core-js/issues/677\n  return V8_VERSION >= 51 || !fails(function () {\n    var array = [];\n    var constructor = array.constructor = {};\n    constructor[SPECIES] = function () {\n      return { foo: 1 };\n    };\n    return array[METHOD_NAME](Boolean).foo !== 1;\n  });\n};\n","'use strict';\nvar fails = require('../internals/fails');\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call,no-throw-literal\n    method.call(null, argument || function () { throw 1; }, 1);\n  });\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar has = require('../internals/has');\n\nvar defineProperty = Object.defineProperty;\nvar cache = {};\n\nvar thrower = function (it) { throw it; };\n\nmodule.exports = function (METHOD_NAME, options) {\n  if (has(cache, METHOD_NAME)) return cache[METHOD_NAME];\n  if (!options) options = {};\n  var method = [][METHOD_NAME];\n  var ACCESSORS = has(options, 'ACCESSORS') ? options.ACCESSORS : false;\n  var argument0 = has(options, 0) ? options[0] : thrower;\n  var argument1 = has(options, 1) ? options[1] : undefined;\n\n  return cache[METHOD_NAME] = !!method && !fails(function () {\n    if (ACCESSORS && !DESCRIPTORS) return true;\n    var O = { length: -1 };\n\n    if (ACCESSORS) defineProperty(O, 1, { enumerable: true, get: thrower });\n    else O[1] = 1;\n\n    method.call(O, argument0, argument1);\n  });\n};\n","var isObject = require('../internals/is-object');\nvar isArray = require('../internals/is-array');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\n\n// `ArraySpeciesCreate` abstract operation\n// https://tc39.github.io/ecma262/#sec-arrayspeciescreate\nmodule.exports = function (originalArray, length) {\n  var C;\n  if (isArray(originalArray)) {\n    C = originalArray.constructor;\n    // cross-realm fallback\n    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;\n    else if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return new (C === undefined ? Array : C)(length === 0 ? 0 : length);\n};\n","var toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n","var TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar classofRaw = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\n// ES3 wrong here\nvar CORRECT_ARGUMENTS = classofRaw(function () { return arguments; }()) == 'Arguments';\n\n// fallback for IE11 Script Access Denied error\nvar tryGet = function (it, key) {\n  try {\n    return it[key];\n  } catch (error) { /* empty */ }\n};\n\n// getting tag from ES6+ `Object.prototype.toString`\nmodule.exports = TO_STRING_TAG_SUPPORT ? classofRaw : function (it) {\n  var O, tag, result;\n  return it === undefined ? 'Undefined' : it === null ? 'Null'\n    // @@toStringTag case\n    : typeof (tag = tryGet(O = Object(it), TO_STRING_TAG)) == 'string' ? tag\n    // builtinTag case\n    : CORRECT_ARGUMENTS ? classofRaw(O)\n    // ES3 arguments fallback\n    : (result = classofRaw(O)) == 'Object' && typeof O.callee == 'function' ? 'Arguments' : result;\n};\n","var has = require('../internals/has');\nvar ownKeys = require('../internals/own-keys');\nvar getOwnPropertyDescriptorModule = require('../internals/object-get-own-property-descriptor');\nvar definePropertyModule = require('../internals/object-define-property');\n\nmodule.exports = function (target, source) {\n  var keys = ownKeys(source);\n  var defineProperty = definePropertyModule.f;\n  var getOwnPropertyDescriptor = getOwnPropertyDescriptorModule.f;\n  for (var i = 0; i < keys.length; i++) {\n    var key = keys[i];\n    if (!has(target, key)) defineProperty(target, key, getOwnPropertyDescriptor(source, key));\n  }\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\n\nmodule.exports = function (METHOD_NAME) {\n  var regexp = /./;\n  try {\n    '/./'[METHOD_NAME](regexp);\n  } catch (e) {\n    try {\n      regexp[MATCH] = false;\n      return '/./'[METHOD_NAME](regexp);\n    } catch (f) { /* empty */ }\n  } return false;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = DESCRIPTORS ? function (object, key, value) {\n  return definePropertyModule.f(object, key, createPropertyDescriptor(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n","module.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n","'use strict';\nvar toPrimitive = require('../internals/to-primitive');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = function (object, key, value) {\n  var propertyKey = toPrimitive(key);\n  if (propertyKey in object) definePropertyModule.f(object, propertyKey, createPropertyDescriptor(0, value));\n  else object[propertyKey] = value;\n};\n","var fails = require('../internals/fails');\n\n// Thank's IE8 for his funny defineProperty\nmodule.exports = !fails(function () {\n  return Object.defineProperty({}, 1, { get: function () { return 7; } })[1] != 7;\n});\n","var global = require('../internals/global');\nvar isObject = require('../internals/is-object');\n\nvar document = global.document;\n// typeof document.createElement is 'object' in old IE\nvar EXISTS = isObject(document) && isObject(document.createElement);\n\nmodule.exports = function (it) {\n  return EXISTS ? document.createElement(it) : {};\n};\n","// iterable DOM collections\n// flag - `iterable` interface - 'entries', 'keys', 'values', 'forEach' methods\nmodule.exports = {\n  CSSRuleList: 0,\n  CSSStyleDeclaration: 0,\n  CSSValueList: 0,\n  ClientRectList: 0,\n  DOMRectList: 0,\n  DOMStringList: 0,\n  DOMTokenList: 1,\n  DataTransferItemList: 0,\n  FileList: 0,\n  HTMLAllCollection: 0,\n  HTMLCollection: 0,\n  HTMLFormElement: 0,\n  HTMLSelectElement: 0,\n  MediaList: 0,\n  MimeTypeArray: 0,\n  NamedNodeMap: 0,\n  NodeList: 1,\n  PaintRequestList: 0,\n  Plugin: 0,\n  PluginArray: 0,\n  SVGLengthList: 0,\n  SVGNumberList: 0,\n  SVGPathSegList: 0,\n  SVGPointList: 0,\n  SVGStringList: 0,\n  SVGTransformList: 0,\n  SourceBufferList: 0,\n  StyleSheetList: 0,\n  TextTrackCueList: 0,\n  TextTrackList: 0,\n  TouchList: 0\n};\n","var getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('navigator', 'userAgent') || '';\n","var global = require('../internals/global');\nvar userAgent = require('../internals/engine-user-agent');\n\nvar process = global.process;\nvar versions = process && process.versions;\nvar v8 = versions && versions.v8;\nvar match, version;\n\nif (v8) {\n  match = v8.split('.');\n  version = match[0] + match[1];\n} else if (userAgent) {\n  match = userAgent.match(/Edge\\/(\\d+)/);\n  if (!match || match[1] >= 74) {\n    match = userAgent.match(/Chrome\\/(\\d+)/);\n    if (match) version = match[1];\n  }\n}\n\nmodule.exports = version && +version;\n","// IE8- don't enum bug keys\nmodule.exports = [\n  'constructor',\n  'hasOwnProperty',\n  'isPrototypeOf',\n  'propertyIsEnumerable',\n  'toLocaleString',\n  'toString',\n  'valueOf'\n];\n","var global = require('../internals/global');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar redefine = require('../internals/redefine');\nvar setGlobal = require('../internals/set-global');\nvar copyConstructorProperties = require('../internals/copy-constructor-properties');\nvar isForced = require('../internals/is-forced');\n\n/*\n  options.target      - name of the target object\n  options.global      - target is the global object\n  options.stat        - export as static methods of target\n  options.proto       - export as prototype methods of target\n  options.real        - real prototype method for the `pure` version\n  options.forced      - export even if the native feature is available\n  options.bind        - bind methods to the target, required for the `pure` version\n  options.wrap        - wrap constructors to preventing global pollution, required for the `pure` version\n  options.unsafe      - use the simple assignment of property instead of delete + defineProperty\n  options.sham        - add a flag to not completely full polyfills\n  options.enumerable  - export as enumerable property\n  options.noTargetGet - prevent calling a getter on target\n*/\nmodule.exports = function (options, source) {\n  var TARGET = options.target;\n  var GLOBAL = options.global;\n  var STATIC = options.stat;\n  var FORCED, target, key, targetProperty, sourceProperty, descriptor;\n  if (GLOBAL) {\n    target = global;\n  } else if (STATIC) {\n    target = global[TARGET] || setGlobal(TARGET, {});\n  } else {\n    target = (global[TARGET] || {}).prototype;\n  }\n  if (target) for (key in source) {\n    sourceProperty = source[key];\n    if (options.noTargetGet) {\n      descriptor = getOwnPropertyDescriptor(target, key);\n      targetProperty = descriptor && descriptor.value;\n    } else targetProperty = target[key];\n    FORCED = isForced(GLOBAL ? key : TARGET + (STATIC ? '.' : '#') + key, options.forced);\n    // contained in target\n    if (!FORCED && targetProperty !== undefined) {\n      if (typeof sourceProperty === typeof targetProperty) continue;\n      copyConstructorProperties(sourceProperty, targetProperty);\n    }\n    // add a flag to not completely full polyfills\n    if (options.sham || (targetProperty && targetProperty.sham)) {\n      createNonEnumerableProperty(sourceProperty, 'sham', true);\n    }\n    // extend global\n    redefine(target, key, sourceProperty, options);\n  }\n};\n","module.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (error) {\n    return true;\n  }\n};\n","'use strict';\n// TODO: Remove from `core-js@4` since it's moved to entry points\nrequire('../modules/es.regexp.exec');\nvar redefine = require('../internals/redefine');\nvar fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar regexpExec = require('../internals/regexp-exec');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nvar SPECIES = wellKnownSymbol('species');\n\nvar REPLACE_SUPPORTS_NAMED_GROUPS = !fails(function () {\n  // #replace needs built-in support for named groups.\n  // #match works fine because it just return the exec results, even if it has\n  // a \"grops\" property.\n  var re = /./;\n  re.exec = function () {\n    var result = [];\n    result.groups = { a: '7' };\n    return result;\n  };\n  return ''.replace(re, '$<a>') !== '7';\n});\n\n// IE <= 11 replaces $0 with the whole match, as if it was $&\n// https://stackoverflow.com/questions/6024666/getting-ie-to-replace-a-regex-with-the-literal-string-0\nvar REPLACE_KEEPS_$0 = (function () {\n  return 'a'.replace(/./, '$0') === '$0';\n})();\n\nvar REPLACE = wellKnownSymbol('replace');\n// Safari <= 13.0.3(?) substitutes nth capture where n>m with an empty string\nvar REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE = (function () {\n  if (/./[REPLACE]) {\n    return /./[REPLACE]('a', '$0') === '';\n  }\n  return false;\n})();\n\n// Chrome 51 has a buggy \"split\" implementation when RegExp#exec !== nativeExec\n// Weex JS has frozen built-in prototypes, so use try / catch wrapper\nvar SPLIT_WORKS_WITH_OVERWRITTEN_EXEC = !fails(function () {\n  var re = /(?:)/;\n  var originalExec = re.exec;\n  re.exec = function () { return originalExec.apply(this, arguments); };\n  var result = 'ab'.split(re);\n  return result.length !== 2 || result[0] !== 'a' || result[1] !== 'b';\n});\n\nmodule.exports = function (KEY, length, exec, sham) {\n  var SYMBOL = wellKnownSymbol(KEY);\n\n  var DELEGATES_TO_SYMBOL = !fails(function () {\n    // String methods call symbol-named RegEp methods\n    var O = {};\n    O[SYMBOL] = function () { return 7; };\n    return ''[KEY](O) != 7;\n  });\n\n  var DELEGATES_TO_EXEC = DELEGATES_TO_SYMBOL && !fails(function () {\n    // Symbol-named RegExp methods call .exec\n    var execCalled = false;\n    var re = /a/;\n\n    if (KEY === 'split') {\n      // We can't use real regex here since it causes deoptimization\n      // and serious performance degradation in V8\n      // https://github.com/zloirock/core-js/issues/306\n      re = {};\n      // RegExp[@@split] doesn't call the regex's exec method, but first creates\n      // a new one. We need to return the patched regex when creating the new one.\n      re.constructor = {};\n      re.constructor[SPECIES] = function () { return re; };\n      re.flags = '';\n      re[SYMBOL] = /./[SYMBOL];\n    }\n\n    re.exec = function () { execCalled = true; return null; };\n\n    re[SYMBOL]('');\n    return !execCalled;\n  });\n\n  if (\n    !DELEGATES_TO_SYMBOL ||\n    !DELEGATES_TO_EXEC ||\n    (KEY === 'replace' && !(\n      REPLACE_SUPPORTS_NAMED_GROUPS &&\n      REPLACE_KEEPS_$0 &&\n      !REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE\n    )) ||\n    (KEY === 'split' && !SPLIT_WORKS_WITH_OVERWRITTEN_EXEC)\n  ) {\n    var nativeRegExpMethod = /./[SYMBOL];\n    var methods = exec(SYMBOL, ''[KEY], function (nativeMethod, regexp, str, arg2, forceStringMethod) {\n      if (regexp.exec === regexpExec) {\n        if (DELEGATES_TO_SYMBOL && !forceStringMethod) {\n          // The native String method already delegates to @@method (this\n          // polyfilled function), leasing to infinite recursion.\n          // We avoid it by directly calling the native @@method method.\n          return { done: true, value: nativeRegExpMethod.call(regexp, str, arg2) };\n        }\n        return { done: true, value: nativeMethod.call(str, regexp, arg2) };\n      }\n      return { done: false };\n    }, {\n      REPLACE_KEEPS_$0: REPLACE_KEEPS_$0,\n      REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE: REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE\n    });\n    var stringMethod = methods[0];\n    var regexMethod = methods[1];\n\n    redefine(String.prototype, KEY, stringMethod);\n    redefine(RegExp.prototype, SYMBOL, length == 2\n      // 21.2.5.8 RegExp.prototype[@@replace](string, replaceValue)\n      // 21.2.5.11 RegExp.prototype[@@split](string, limit)\n      ? function (string, arg) { return regexMethod.call(string, this, arg); }\n      // 21.2.5.6 RegExp.prototype[@@match](string)\n      // 21.2.5.9 RegExp.prototype[@@search](string)\n      : function (string) { return regexMethod.call(string, this); }\n    );\n  }\n\n  if (sham) createNonEnumerableProperty(RegExp.prototype[SYMBOL], 'sham', true);\n};\n","var aFunction = require('../internals/a-function');\n\n// optional / simple context binding\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 0: return function () {\n      return fn.call(that);\n    };\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n","var path = require('../internals/path');\nvar global = require('../internals/global');\n\nvar aFunction = function (variable) {\n  return typeof variable == 'function' ? variable : undefined;\n};\n\nmodule.exports = function (namespace, method) {\n  return arguments.length < 2 ? aFunction(path[namespace]) || aFunction(global[namespace])\n    : path[namespace] && path[namespace][method] || global[namespace] && global[namespace][method];\n};\n","var check = function (it) {\n  return it && it.Math == Math && it;\n};\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nmodule.exports =\n  // eslint-disable-next-line no-undef\n  check(typeof globalThis == 'object' && globalThis) ||\n  check(typeof window == 'object' && window) ||\n  check(typeof self == 'object' && self) ||\n  check(typeof global == 'object' && global) ||\n  // eslint-disable-next-line no-new-func\n  Function('return this')();\n","var hasOwnProperty = {}.hasOwnProperty;\n\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n","module.exports = {};\n","var getBuiltIn = require('../internals/get-built-in');\n\nmodule.exports = getBuiltIn('document', 'documentElement');\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar createElement = require('../internals/document-create-element');\n\n// Thank's IE8 for his funny defineProperty\nmodule.exports = !DESCRIPTORS && !fails(function () {\n  return Object.defineProperty(createElement('div'), 'a', {\n    get: function () { return 7; }\n  }).a != 7;\n});\n","var fails = require('../internals/fails');\nvar classof = require('../internals/classof-raw');\n\nvar split = ''.split;\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nmodule.exports = fails(function () {\n  // throws an error in rhino, see https://github.com/mozilla/rhino/issues/346\n  // eslint-disable-next-line no-prototype-builtins\n  return !Object('z').propertyIsEnumerable(0);\n}) ? function (it) {\n  return classof(it) == 'String' ? split.call(it, '') : Object(it);\n} : Object;\n","var isObject = require('../internals/is-object');\nvar setPrototypeOf = require('../internals/object-set-prototype-of');\n\n// makes subclassing work correct for wrapped built-ins\nmodule.exports = function ($this, dummy, Wrapper) {\n  var NewTarget, NewTargetPrototype;\n  if (\n    // it can work only with native `setPrototypeOf`\n    setPrototypeOf &&\n    // we haven't completely correct pre-ES6 way for getting `new.target`, so use this\n    typeof (NewTarget = dummy.constructor) == 'function' &&\n    NewTarget !== Wrapper &&\n    isObject(NewTargetPrototype = NewTarget.prototype) &&\n    NewTargetPrototype !== Wrapper.prototype\n  ) setPrototypeOf($this, NewTargetPrototype);\n  return $this;\n};\n","var store = require('../internals/shared-store');\n\nvar functionToString = Function.toString;\n\n// this helper broken in `3.4.1-3.4.4`, so we can't use `shared` helper\nif (typeof store.inspectSource != 'function') {\n  store.inspectSource = function (it) {\n    return functionToString.call(it);\n  };\n}\n\nmodule.exports = store.inspectSource;\n","var NATIVE_WEAK_MAP = require('../internals/native-weak-map');\nvar global = require('../internals/global');\nvar isObject = require('../internals/is-object');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar objectHas = require('../internals/has');\nvar sharedKey = require('../internals/shared-key');\nvar hiddenKeys = require('../internals/hidden-keys');\n\nvar WeakMap = global.WeakMap;\nvar set, get, has;\n\nvar enforce = function (it) {\n  return has(it) ? get(it) : set(it, {});\n};\n\nvar getterFor = function (TYPE) {\n  return function (it) {\n    var state;\n    if (!isObject(it) || (state = get(it)).type !== TYPE) {\n      throw TypeError('Incompatible receiver, ' + TYPE + ' required');\n    } return state;\n  };\n};\n\nif (NATIVE_WEAK_MAP) {\n  var store = new WeakMap();\n  var wmget = store.get;\n  var wmhas = store.has;\n  var wmset = store.set;\n  set = function (it, metadata) {\n    wmset.call(store, it, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return wmget.call(store, it) || {};\n  };\n  has = function (it) {\n    return wmhas.call(store, it);\n  };\n} else {\n  var STATE = sharedKey('state');\n  hiddenKeys[STATE] = true;\n  set = function (it, metadata) {\n    createNonEnumerableProperty(it, STATE, metadata);\n    return metadata;\n  };\n  get = function (it) {\n    return objectHas(it, STATE) ? it[STATE] : {};\n  };\n  has = function (it) {\n    return objectHas(it, STATE);\n  };\n}\n\nmodule.exports = {\n  set: set,\n  get: get,\n  has: has,\n  enforce: enforce,\n  getterFor: getterFor\n};\n","var classof = require('../internals/classof-raw');\n\n// `IsArray` abstract operation\n// https://tc39.github.io/ecma262/#sec-isarray\nmodule.exports = Array.isArray || function isArray(arg) {\n  return classof(arg) == 'Array';\n};\n","var fails = require('../internals/fails');\n\nvar replacement = /#|\\.prototype\\./;\n\nvar isForced = function (feature, detection) {\n  var value = data[normalize(feature)];\n  return value == POLYFILL ? true\n    : value == NATIVE ? false\n    : typeof detection == 'function' ? fails(detection)\n    : !!detection;\n};\n\nvar normalize = isForced.normalize = function (string) {\n  return String(string).replace(replacement, '.').toLowerCase();\n};\n\nvar data = isForced.data = {};\nvar NATIVE = isForced.NATIVE = 'N';\nvar POLYFILL = isForced.POLYFILL = 'P';\n\nmodule.exports = isForced;\n","module.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n","module.exports = false;\n","var isObject = require('../internals/is-object');\nvar classof = require('../internals/classof-raw');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar MATCH = wellKnownSymbol('match');\n\n// `IsRegExp` abstract operation\n// https://tc39.github.io/ecma262/#sec-isregexp\nmodule.exports = function (it) {\n  var isRegExp;\n  return isObject(it) && ((isRegExp = it[MATCH]) !== undefined ? !!isRegExp : classof(it) == 'RegExp');\n};\n","var fails = require('../internals/fails');\n\nmodule.exports = !!Object.getOwnPropertySymbols && !fails(function () {\n  // Chrome 38 Symbol has incorrect toString conversion\n  // eslint-disable-next-line no-undef\n  return !String(Symbol());\n});\n","var global = require('../internals/global');\nvar inspectSource = require('../internals/inspect-source');\n\nvar WeakMap = global.WeakMap;\n\nmodule.exports = typeof WeakMap === 'function' && /native code/.test(inspectSource(WeakMap));\n","var isRegExp = require('../internals/is-regexp');\n\nmodule.exports = function (it) {\n  if (isRegExp(it)) {\n    throw TypeError(\"The method doesn't accept regular expressions\");\n  } return it;\n};\n","var anObject = require('../internals/an-object');\nvar defineProperties = require('../internals/object-define-properties');\nvar enumBugKeys = require('../internals/enum-bug-keys');\nvar hiddenKeys = require('../internals/hidden-keys');\nvar html = require('../internals/html');\nvar documentCreateElement = require('../internals/document-create-element');\nvar sharedKey = require('../internals/shared-key');\n\nvar GT = '>';\nvar LT = '<';\nvar PROTOTYPE = 'prototype';\nvar SCRIPT = 'script';\nvar IE_PROTO = sharedKey('IE_PROTO');\n\nvar EmptyConstructor = function () { /* empty */ };\n\nvar scriptTag = function (content) {\n  return LT + SCRIPT + GT + content + LT + '/' + SCRIPT + GT;\n};\n\n// Create object with fake `null` prototype: use ActiveX Object with cleared prototype\nvar NullProtoObjectViaActiveX = function (activeXDocument) {\n  activeXDocument.write(scriptTag(''));\n  activeXDocument.close();\n  var temp = activeXDocument.parentWindow.Object;\n  activeXDocument = null; // avoid memory leak\n  return temp;\n};\n\n// Create object with fake `null` prototype: use iframe Object with cleared prototype\nvar NullProtoObjectViaIFrame = function () {\n  // Thrash, waste and sodomy: IE GC bug\n  var iframe = documentCreateElement('iframe');\n  var JS = 'java' + SCRIPT + ':';\n  var iframeDocument;\n  iframe.style.display = 'none';\n  html.appendChild(iframe);\n  // https://github.com/zloirock/core-js/issues/475\n  iframe.src = String(JS);\n  iframeDocument = iframe.contentWindow.document;\n  iframeDocument.open();\n  iframeDocument.write(scriptTag('document.F=Object'));\n  iframeDocument.close();\n  return iframeDocument.F;\n};\n\n// Check for document.domain and active x support\n// No need to use active x approach when document.domain is not set\n// see https://github.com/es-shims/es5-shim/issues/150\n// variation of https://github.com/kitcambridge/es5-shim/commit/4f738ac066346\n// avoid IE GC bug\nvar activeXDocument;\nvar NullProtoObject = function () {\n  try {\n    /* global ActiveXObject */\n    activeXDocument = document.domain && new ActiveXObject('htmlfile');\n  } catch (error) { /* ignore */ }\n  NullProtoObject = activeXDocument ? NullProtoObjectViaActiveX(activeXDocument) : NullProtoObjectViaIFrame();\n  var length = enumBugKeys.length;\n  while (length--) delete NullProtoObject[PROTOTYPE][enumBugKeys[length]];\n  return NullProtoObject();\n};\n\nhiddenKeys[IE_PROTO] = true;\n\n// `Object.create` method\n// https://tc39.github.io/ecma262/#sec-object.create\nmodule.exports = Object.create || function create(O, Properties) {\n  var result;\n  if (O !== null) {\n    EmptyConstructor[PROTOTYPE] = anObject(O);\n    result = new EmptyConstructor();\n    EmptyConstructor[PROTOTYPE] = null;\n    // add \"__proto__\" for Object.getPrototypeOf polyfill\n    result[IE_PROTO] = O;\n  } else result = NullProtoObject();\n  return Properties === undefined ? result : defineProperties(result, Properties);\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar definePropertyModule = require('../internals/object-define-property');\nvar anObject = require('../internals/an-object');\nvar objectKeys = require('../internals/object-keys');\n\n// `Object.defineProperties` method\n// https://tc39.github.io/ecma262/#sec-object.defineproperties\nmodule.exports = DESCRIPTORS ? Object.defineProperties : function defineProperties(O, Properties) {\n  anObject(O);\n  var keys = objectKeys(Properties);\n  var length = keys.length;\n  var index = 0;\n  var key;\n  while (length > index) definePropertyModule.f(O, key = keys[index++], Properties[key]);\n  return O;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\nvar anObject = require('../internals/an-object');\nvar toPrimitive = require('../internals/to-primitive');\n\nvar nativeDefineProperty = Object.defineProperty;\n\n// `Object.defineProperty` method\n// https://tc39.github.io/ecma262/#sec-object.defineproperty\nexports.f = DESCRIPTORS ? nativeDefineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return nativeDefineProperty(O, P, Attributes);\n  } catch (error) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar propertyIsEnumerableModule = require('../internals/object-property-is-enumerable');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar toPrimitive = require('../internals/to-primitive');\nvar has = require('../internals/has');\nvar IE8_DOM_DEFINE = require('../internals/ie8-dom-define');\n\nvar nativeGetOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// `Object.getOwnPropertyDescriptor` method\n// https://tc39.github.io/ecma262/#sec-object.getownpropertydescriptor\nexports.f = DESCRIPTORS ? nativeGetOwnPropertyDescriptor : function getOwnPropertyDescriptor(O, P) {\n  O = toIndexedObject(O);\n  P = toPrimitive(P, true);\n  if (IE8_DOM_DEFINE) try {\n    return nativeGetOwnPropertyDescriptor(O, P);\n  } catch (error) { /* empty */ }\n  if (has(O, P)) return createPropertyDescriptor(!propertyIsEnumerableModule.f.call(O, P), O[P]);\n};\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\nvar hiddenKeys = enumBugKeys.concat('length', 'prototype');\n\n// `Object.getOwnPropertyNames` method\n// https://tc39.github.io/ecma262/#sec-object.getownpropertynames\nexports.f = Object.getOwnPropertyNames || function getOwnPropertyNames(O) {\n  return internalObjectKeys(O, hiddenKeys);\n};\n","exports.f = Object.getOwnPropertySymbols;\n","var has = require('../internals/has');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar indexOf = require('../internals/array-includes').indexOf;\nvar hiddenKeys = require('../internals/hidden-keys');\n\nmodule.exports = function (object, names) {\n  var O = toIndexedObject(object);\n  var i = 0;\n  var result = [];\n  var key;\n  for (key in O) !has(hiddenKeys, key) && has(O, key) && result.push(key);\n  // Don't enum bug & hidden keys\n  while (names.length > i) if (has(O, key = names[i++])) {\n    ~indexOf(result, key) || result.push(key);\n  }\n  return result;\n};\n","var internalObjectKeys = require('../internals/object-keys-internal');\nvar enumBugKeys = require('../internals/enum-bug-keys');\n\n// `Object.keys` method\n// https://tc39.github.io/ecma262/#sec-object.keys\nmodule.exports = Object.keys || function keys(O) {\n  return internalObjectKeys(O, enumBugKeys);\n};\n","'use strict';\nvar nativePropertyIsEnumerable = {}.propertyIsEnumerable;\nvar getOwnPropertyDescriptor = Object.getOwnPropertyDescriptor;\n\n// Nashorn ~ JDK8 bug\nvar NASHORN_BUG = getOwnPropertyDescriptor && !nativePropertyIsEnumerable.call({ 1: 2 }, 1);\n\n// `Object.prototype.propertyIsEnumerable` method implementation\n// https://tc39.github.io/ecma262/#sec-object.prototype.propertyisenumerable\nexports.f = NASHORN_BUG ? function propertyIsEnumerable(V) {\n  var descriptor = getOwnPropertyDescriptor(this, V);\n  return !!descriptor && descriptor.enumerable;\n} : nativePropertyIsEnumerable;\n","var anObject = require('../internals/an-object');\nvar aPossiblePrototype = require('../internals/a-possible-prototype');\n\n// `Object.setPrototypeOf` method\n// https://tc39.github.io/ecma262/#sec-object.setprototypeof\n// Works with __proto__ only. Old v8 can't work with null proto objects.\n/* eslint-disable no-proto */\nmodule.exports = Object.setPrototypeOf || ('__proto__' in {} ? function () {\n  var CORRECT_SETTER = false;\n  var test = {};\n  var setter;\n  try {\n    setter = Object.getOwnPropertyDescriptor(Object.prototype, '__proto__').set;\n    setter.call(test, []);\n    CORRECT_SETTER = test instanceof Array;\n  } catch (error) { /* empty */ }\n  return function setPrototypeOf(O, proto) {\n    anObject(O);\n    aPossiblePrototype(proto);\n    if (CORRECT_SETTER) setter.call(O, proto);\n    else O.__proto__ = proto;\n    return O;\n  };\n}() : undefined);\n","'use strict';\nvar TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar classof = require('../internals/classof');\n\n// `Object.prototype.toString` method implementation\n// https://tc39.github.io/ecma262/#sec-object.prototype.tostring\nmodule.exports = TO_STRING_TAG_SUPPORT ? {}.toString : function toString() {\n  return '[object ' + classof(this) + ']';\n};\n","var getBuiltIn = require('../internals/get-built-in');\nvar getOwnPropertyNamesModule = require('../internals/object-get-own-property-names');\nvar getOwnPropertySymbolsModule = require('../internals/object-get-own-property-symbols');\nvar anObject = require('../internals/an-object');\n\n// all object keys, includes non-enumerable and symbols\nmodule.exports = getBuiltIn('Reflect', 'ownKeys') || function ownKeys(it) {\n  var keys = getOwnPropertyNamesModule.f(anObject(it));\n  var getOwnPropertySymbols = getOwnPropertySymbolsModule.f;\n  return getOwnPropertySymbols ? keys.concat(getOwnPropertySymbols(it)) : keys;\n};\n","var global = require('../internals/global');\n\nmodule.exports = global;\n","var global = require('../internals/global');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar has = require('../internals/has');\nvar setGlobal = require('../internals/set-global');\nvar inspectSource = require('../internals/inspect-source');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar getInternalState = InternalStateModule.get;\nvar enforceInternalState = InternalStateModule.enforce;\nvar TEMPLATE = String(String).split('String');\n\n(module.exports = function (O, key, value, options) {\n  var unsafe = options ? !!options.unsafe : false;\n  var simple = options ? !!options.enumerable : false;\n  var noTargetGet = options ? !!options.noTargetGet : false;\n  if (typeof value == 'function') {\n    if (typeof key == 'string' && !has(value, 'name')) createNonEnumerableProperty(value, 'name', key);\n    enforceInternalState(value).source = TEMPLATE.join(typeof key == 'string' ? key : '');\n  }\n  if (O === global) {\n    if (simple) O[key] = value;\n    else setGlobal(key, value);\n    return;\n  } else if (!unsafe) {\n    delete O[key];\n  } else if (!noTargetGet && O[key]) {\n    simple = true;\n  }\n  if (simple) O[key] = value;\n  else createNonEnumerableProperty(O, key, value);\n// add fake Function#toString for correct work wrapped methods / constructors with methods like LoDash isNative\n})(Function.prototype, 'toString', function toString() {\n  return typeof this == 'function' && getInternalState(this).source || inspectSource(this);\n});\n","var classof = require('./classof-raw');\nvar regexpExec = require('./regexp-exec');\n\n// `RegExpExec` abstract operation\n// https://tc39.github.io/ecma262/#sec-regexpexec\nmodule.exports = function (R, S) {\n  var exec = R.exec;\n  if (typeof exec === 'function') {\n    var result = exec.call(R, S);\n    if (typeof result !== 'object') {\n      throw TypeError('RegExp exec method returned something other than an Object or null');\n    }\n    return result;\n  }\n\n  if (classof(R) !== 'RegExp') {\n    throw TypeError('RegExp#exec called on incompatible receiver');\n  }\n\n  return regexpExec.call(R, S);\n};\n\n","'use strict';\nvar regexpFlags = require('./regexp-flags');\nvar stickyHelpers = require('./regexp-sticky-helpers');\n\nvar nativeExec = RegExp.prototype.exec;\n// This always refers to the native implementation, because the\n// String#replace polyfill uses ./fix-regexp-well-known-symbol-logic.js,\n// which loads this file before patching the method.\nvar nativeReplace = String.prototype.replace;\n\nvar patchedExec = nativeExec;\n\nvar UPDATES_LAST_INDEX_WRONG = (function () {\n  var re1 = /a/;\n  var re2 = /b*/g;\n  nativeExec.call(re1, 'a');\n  nativeExec.call(re2, 'a');\n  return re1.lastIndex !== 0 || re2.lastIndex !== 0;\n})();\n\nvar UNSUPPORTED_Y = stickyHelpers.UNSUPPORTED_Y || stickyHelpers.BROKEN_CARET;\n\n// nonparticipating capturing group, copied from es5-shim's String#split patch.\nvar NPCG_INCLUDED = /()??/.exec('')[1] !== undefined;\n\nvar PATCH = UPDATES_LAST_INDEX_WRONG || NPCG_INCLUDED || UNSUPPORTED_Y;\n\nif (PATCH) {\n  patchedExec = function exec(str) {\n    var re = this;\n    var lastIndex, reCopy, match, i;\n    var sticky = UNSUPPORTED_Y && re.sticky;\n    var flags = regexpFlags.call(re);\n    var source = re.source;\n    var charsAdded = 0;\n    var strCopy = str;\n\n    if (sticky) {\n      flags = flags.replace('y', '');\n      if (flags.indexOf('g') === -1) {\n        flags += 'g';\n      }\n\n      strCopy = String(str).slice(re.lastIndex);\n      // Support anchored sticky behavior.\n      if (re.lastIndex > 0 && (!re.multiline || re.multiline && str[re.lastIndex - 1] !== '\\n')) {\n        source = '(?: ' + source + ')';\n        strCopy = ' ' + strCopy;\n        charsAdded++;\n      }\n      // ^(? + rx + ) is needed, in combination with some str slicing, to\n      // simulate the 'y' flag.\n      reCopy = new RegExp('^(?:' + source + ')', flags);\n    }\n\n    if (NPCG_INCLUDED) {\n      reCopy = new RegExp('^' + source + '$(?!\\\\s)', flags);\n    }\n    if (UPDATES_LAST_INDEX_WRONG) lastIndex = re.lastIndex;\n\n    match = nativeExec.call(sticky ? reCopy : re, strCopy);\n\n    if (sticky) {\n      if (match) {\n        match.input = match.input.slice(charsAdded);\n        match[0] = match[0].slice(charsAdded);\n        match.index = re.lastIndex;\n        re.lastIndex += match[0].length;\n      } else re.lastIndex = 0;\n    } else if (UPDATES_LAST_INDEX_WRONG && match) {\n      re.lastIndex = re.global ? match.index + match[0].length : lastIndex;\n    }\n    if (NPCG_INCLUDED && match && match.length > 1) {\n      // Fix browsers whose `exec` methods don't consistently return `undefined`\n      // for NPCG, like IE8. NOTE: This doesn' work for /(.?)?/\n      nativeReplace.call(match[0], reCopy, function () {\n        for (i = 1; i < arguments.length - 2; i++) {\n          if (arguments[i] === undefined) match[i] = undefined;\n        }\n      });\n    }\n\n    return match;\n  };\n}\n\nmodule.exports = patchedExec;\n","'use strict';\nvar anObject = require('../internals/an-object');\n\n// `RegExp.prototype.flags` getter implementation\n// https://tc39.github.io/ecma262/#sec-get-regexp.prototype.flags\nmodule.exports = function () {\n  var that = anObject(this);\n  var result = '';\n  if (that.global) result += 'g';\n  if (that.ignoreCase) result += 'i';\n  if (that.multiline) result += 'm';\n  if (that.dotAll) result += 's';\n  if (that.unicode) result += 'u';\n  if (that.sticky) result += 'y';\n  return result;\n};\n","'use strict';\n\nvar fails = require('./fails');\n\n// babel-minify transpiles RegExp('a', 'y') -> /a/y and it causes SyntaxError,\n// so we use an intermediate function.\nfunction RE(s, f) {\n  return RegExp(s, f);\n}\n\nexports.UNSUPPORTED_Y = fails(function () {\n  // babel-minify transpiles RegExp('a', 'y') -> /a/y and it causes SyntaxError\n  var re = RE('a', 'y');\n  re.lastIndex = 2;\n  return re.exec('abcd') != null;\n});\n\nexports.BROKEN_CARET = fails(function () {\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=773687\n  var re = RE('^r', 'gy');\n  re.lastIndex = 2;\n  return re.exec('str') != null;\n});\n","// `RequireObjectCoercible` abstract operation\n// https://tc39.github.io/ecma262/#sec-requireobjectcoercible\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on \" + it);\n  return it;\n};\n","// `SameValue` abstract operation\n// https://tc39.github.io/ecma262/#sec-samevalue\nmodule.exports = Object.is || function is(x, y) {\n  // eslint-disable-next-line no-self-compare\n  return x === y ? x !== 0 || 1 / x === 1 / y : x != x && y != y;\n};\n","var global = require('../internals/global');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nmodule.exports = function (key, value) {\n  try {\n    createNonEnumerableProperty(global, key, value);\n  } catch (error) {\n    global[key] = value;\n  } return value;\n};\n","var shared = require('../internals/shared');\nvar uid = require('../internals/uid');\n\nvar keys = shared('keys');\n\nmodule.exports = function (key) {\n  return keys[key] || (keys[key] = uid(key));\n};\n","var global = require('../internals/global');\nvar setGlobal = require('../internals/set-global');\n\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || setGlobal(SHARED, {});\n\nmodule.exports = store;\n","var IS_PURE = require('../internals/is-pure');\nvar store = require('../internals/shared-store');\n\n(module.exports = function (key, value) {\n  return store[key] || (store[key] = value !== undefined ? value : {});\n})('versions', []).push({\n  version: '3.6.5',\n  mode: IS_PURE ? 'pure' : 'global',\n  copyright: '© 2020 Denis Pushkarev (zloirock.ru)'\n});\n","var anObject = require('../internals/an-object');\nvar aFunction = require('../internals/a-function');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\n\n// `SpeciesConstructor` abstract operation\n// https://tc39.github.io/ecma262/#sec-speciesconstructor\nmodule.exports = function (O, defaultConstructor) {\n  var C = anObject(O).constructor;\n  var S;\n  return C === undefined || (S = anObject(C)[SPECIES]) == undefined ? defaultConstructor : aFunction(S);\n};\n","var toInteger = require('../internals/to-integer');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `String.prototype.{ codePointAt, at }` methods implementation\nvar createMethod = function (CONVERT_TO_STRING) {\n  return function ($this, pos) {\n    var S = String(requireObjectCoercible($this));\n    var position = toInteger(pos);\n    var size = S.length;\n    var first, second;\n    if (position < 0 || position >= size) return CONVERT_TO_STRING ? '' : undefined;\n    first = S.charCodeAt(position);\n    return first < 0xD800 || first > 0xDBFF || position + 1 === size\n      || (second = S.charCodeAt(position + 1)) < 0xDC00 || second > 0xDFFF\n        ? CONVERT_TO_STRING ? S.charAt(position) : first\n        : CONVERT_TO_STRING ? S.slice(position, position + 2) : (first - 0xD800 << 10) + (second - 0xDC00) + 0x10000;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.codePointAt` method\n  // https://tc39.github.io/ecma262/#sec-string.prototype.codepointat\n  codeAt: createMethod(false),\n  // `String.prototype.at` method\n  // https://github.com/mathiasbynens/String.prototype.at\n  charAt: createMethod(true)\n};\n","'use strict';\nvar toInteger = require('../internals/to-integer');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `String.prototype.repeat` method implementation\n// https://tc39.github.io/ecma262/#sec-string.prototype.repeat\nmodule.exports = ''.repeat || function repeat(count) {\n  var str = String(requireObjectCoercible(this));\n  var result = '';\n  var n = toInteger(count);\n  if (n < 0 || n == Infinity) throw RangeError('Wrong number of repetitions');\n  for (;n > 0; (n >>>= 1) && (str += str)) if (n & 1) result += str;\n  return result;\n};\n","var fails = require('../internals/fails');\nvar whitespaces = require('../internals/whitespaces');\n\nvar non = '\\u200B\\u0085\\u180E';\n\n// check that a method works with the correct list\n// of whitespaces and has a correct name\nmodule.exports = function (METHOD_NAME) {\n  return fails(function () {\n    return !!whitespaces[METHOD_NAME]() || non[METHOD_NAME]() != non || whitespaces[METHOD_NAME].name !== METHOD_NAME;\n  });\n};\n","var requireObjectCoercible = require('../internals/require-object-coercible');\nvar whitespaces = require('../internals/whitespaces');\n\nvar whitespace = '[' + whitespaces + ']';\nvar ltrim = RegExp('^' + whitespace + whitespace + '*');\nvar rtrim = RegExp(whitespace + whitespace + '*$');\n\n// `String.prototype.{ trim, trimStart, trimEnd, trimLeft, trimRight }` methods implementation\nvar createMethod = function (TYPE) {\n  return function ($this) {\n    var string = String(requireObjectCoercible($this));\n    if (TYPE & 1) string = string.replace(ltrim, '');\n    if (TYPE & 2) string = string.replace(rtrim, '');\n    return string;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.{ trimLeft, trimStart }` methods\n  // https://tc39.github.io/ecma262/#sec-string.prototype.trimstart\n  start: createMethod(1),\n  // `String.prototype.{ trimRight, trimEnd }` methods\n  // https://tc39.github.io/ecma262/#sec-string.prototype.trimend\n  end: createMethod(2),\n  // `String.prototype.trim` method\n  // https://tc39.github.io/ecma262/#sec-string.prototype.trim\n  trim: createMethod(3)\n};\n","var classof = require('../internals/classof-raw');\n\n// `thisNumberValue` abstract operation\n// https://tc39.github.io/ecma262/#sec-thisnumbervalue\nmodule.exports = function (value) {\n  if (typeof value != 'number' && classof(value) != 'Number') {\n    throw TypeError('Incorrect invocation');\n  }\n  return +value;\n};\n","var toInteger = require('../internals/to-integer');\n\nvar max = Math.max;\nvar min = Math.min;\n\n// Helper for a popular repeating case of the spec:\n// Let integer be ? ToInteger(index).\n// If integer < 0, let result be max((length + integer), 0); else let result be min(integer, length).\nmodule.exports = function (index, length) {\n  var integer = toInteger(index);\n  return integer < 0 ? max(integer + length, 0) : min(integer, length);\n};\n","// toObject with fallback for non-array-like ES3 strings\nvar IndexedObject = require('../internals/indexed-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\nmodule.exports = function (it) {\n  return IndexedObject(requireObjectCoercible(it));\n};\n","var ceil = Math.ceil;\nvar floor = Math.floor;\n\n// `ToInteger` abstract operation\n// https://tc39.github.io/ecma262/#sec-tointeger\nmodule.exports = function (argument) {\n  return isNaN(argument = +argument) ? 0 : (argument > 0 ? floor : ceil)(argument);\n};\n","var toInteger = require('../internals/to-integer');\n\nvar min = Math.min;\n\n// `ToLength` abstract operation\n// https://tc39.github.io/ecma262/#sec-tolength\nmodule.exports = function (argument) {\n  return argument > 0 ? min(toInteger(argument), 0x1FFFFFFFFFFFFF) : 0; // 2 ** 53 - 1 == 9007199254740991\n};\n","var requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `ToObject` abstract operation\n// https://tc39.github.io/ecma262/#sec-toobject\nmodule.exports = function (argument) {\n  return Object(requireObjectCoercible(argument));\n};\n","var isObject = require('../internals/is-object');\n\n// `ToPrimitive` abstract operation\n// https://tc39.github.io/ecma262/#sec-toprimitive\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (input, PREFERRED_STRING) {\n  if (!isObject(input)) return input;\n  var fn, val;\n  if (PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) return val;\n  if (typeof (fn = input.valueOf) == 'function' && !isObject(val = fn.call(input))) return val;\n  if (!PREFERRED_STRING && typeof (fn = input.toString) == 'function' && !isObject(val = fn.call(input))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n","var wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar test = {};\n\ntest[TO_STRING_TAG] = 'z';\n\nmodule.exports = String(test) === '[object z]';\n","var id = 0;\nvar postfix = Math.random();\n\nmodule.exports = function (key) {\n  return 'Symbol(' + String(key === undefined ? '' : key) + ')_' + (++id + postfix).toString(36);\n};\n","var NATIVE_SYMBOL = require('../internals/native-symbol');\n\nmodule.exports = NATIVE_SYMBOL\n  // eslint-disable-next-line no-undef\n  && !Symbol.sham\n  // eslint-disable-next-line no-undef\n  && typeof Symbol.iterator == 'symbol';\n","var global = require('../internals/global');\nvar shared = require('../internals/shared');\nvar has = require('../internals/has');\nvar uid = require('../internals/uid');\nvar NATIVE_SYMBOL = require('../internals/native-symbol');\nvar USE_SYMBOL_AS_UID = require('../internals/use-symbol-as-uid');\n\nvar WellKnownSymbolsStore = shared('wks');\nvar Symbol = global.Symbol;\nvar createWellKnownSymbol = USE_SYMBOL_AS_UID ? Symbol : Symbol && Symbol.withoutSetter || uid;\n\nmodule.exports = function (name) {\n  if (!has(WellKnownSymbolsStore, name)) {\n    if (NATIVE_SYMBOL && has(Symbol, name)) WellKnownSymbolsStore[name] = Symbol[name];\n    else WellKnownSymbolsStore[name] = createWellKnownSymbol('Symbol.' + name);\n  } return WellKnownSymbolsStore[name];\n};\n","// a string of all valid unicode whitespaces\n// eslint-disable-next-line max-len\nmodule.exports = '\\u0009\\u000A\\u000B\\u000C\\u000D\\u0020\\u00A0\\u1680\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028\\u2029\\uFEFF';\n","'use strict';\nvar $ = require('../internals/export');\nvar fails = require('../internals/fails');\nvar isArray = require('../internals/is-array');\nvar isObject = require('../internals/is-object');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar createProperty = require('../internals/create-property');\nvar arraySpeciesCreate = require('../internals/array-species-create');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar IS_CONCAT_SPREADABLE = wellKnownSymbol('isConcatSpreadable');\nvar MAX_SAFE_INTEGER = 0x1FFFFFFFFFFFFF;\nvar MAXIMUM_ALLOWED_INDEX_EXCEEDED = 'Maximum allowed index exceeded';\n\n// We can't use this feature detection in V8 since it causes\n// deoptimization and serious performance degradation\n// https://github.com/zloirock/core-js/issues/679\nvar IS_CONCAT_SPREADABLE_SUPPORT = V8_VERSION >= 51 || !fails(function () {\n  var array = [];\n  array[IS_CONCAT_SPREADABLE] = false;\n  return array.concat()[0] !== array;\n});\n\nvar SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('concat');\n\nvar isConcatSpreadable = function (O) {\n  if (!isObject(O)) return false;\n  var spreadable = O[IS_CONCAT_SPREADABLE];\n  return spreadable !== undefined ? !!spreadable : isArray(O);\n};\n\nvar FORCED = !IS_CONCAT_SPREADABLE_SUPPORT || !SPECIES_SUPPORT;\n\n// `Array.prototype.concat` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.concat\n// with adding support of @@isConcatSpreadable and @@species\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  concat: function concat(arg) { // eslint-disable-line no-unused-vars\n    var O = toObject(this);\n    var A = arraySpeciesCreate(O, 0);\n    var n = 0;\n    var i, k, length, len, E;\n    for (i = -1, length = arguments.length; i < length; i++) {\n      E = i === -1 ? O : arguments[i];\n      if (isConcatSpreadable(E)) {\n        len = toLength(E.length);\n        if (n + len > MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        for (k = 0; k < len; k++, n++) if (k in E) createProperty(A, n, E[k]);\n      } else {\n        if (n >= MAX_SAFE_INTEGER) throw TypeError(MAXIMUM_ALLOWED_INDEX_EXCEEDED);\n        createProperty(A, n++, E);\n      }\n    }\n    A.length = n;\n    return A;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $filter = require('../internals/array-iteration').filter;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('filter');\n// Edge 14- issue\nvar USES_TO_LENGTH = arrayMethodUsesToLength('filter');\n\n// `Array.prototype.filter` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.filter\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT || !USES_TO_LENGTH }, {\n  filter: function filter(callbackfn /* , thisArg */) {\n    return $filter(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $find = require('../internals/array-iteration').find;\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar FIND = 'find';\nvar SKIPS_HOLES = true;\n\nvar USES_TO_LENGTH = arrayMethodUsesToLength(FIND);\n\n// Shouldn't skip holes\nif (FIND in []) Array(1)[FIND](function () { SKIPS_HOLES = false; });\n\n// `Array.prototype.find` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.find\n$({ target: 'Array', proto: true, forced: SKIPS_HOLES || !USES_TO_LENGTH }, {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables(FIND);\n","'use strict';\nvar $ = require('../internals/export');\nvar forEach = require('../internals/array-for-each');\n\n// `Array.prototype.forEach` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.foreach\n$({ target: 'Array', proto: true, forced: [].forEach != forEach }, {\n  forEach: forEach\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $includes = require('../internals/array-includes').includes;\nvar addToUnscopables = require('../internals/add-to-unscopables');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\n\n// `Array.prototype.includes` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.includes\n$({ target: 'Array', proto: true, forced: !USES_TO_LENGTH }, {\n  includes: function includes(el /* , fromIndex = 0 */) {\n    return $includes(this, el, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n// https://tc39.github.io/ecma262/#sec-array.prototype-@@unscopables\naddToUnscopables('includes');\n","'use strict';\nvar $ = require('../internals/export');\nvar $indexOf = require('../internals/array-includes').indexOf;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar nativeIndexOf = [].indexOf;\n\nvar NEGATIVE_ZERO = !!nativeIndexOf && 1 / [1].indexOf(1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('indexOf');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\n\n// `Array.prototype.indexOf` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.indexof\n$({ target: 'Array', proto: true, forced: NEGATIVE_ZERO || !STRICT_METHOD || !USES_TO_LENGTH }, {\n  indexOf: function indexOf(searchElement /* , fromIndex = 0 */) {\n    return NEGATIVE_ZERO\n      // convert -0 to +0\n      ? nativeIndexOf.apply(this, arguments) || 0\n      : $indexOf(this, searchElement, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar IndexedObject = require('../internals/indexed-object');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar nativeJoin = [].join;\n\nvar ES3_STRINGS = IndexedObject != Object;\nvar STRICT_METHOD = arrayMethodIsStrict('join', ',');\n\n// `Array.prototype.join` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.join\n$({ target: 'Array', proto: true, forced: ES3_STRINGS || !STRICT_METHOD }, {\n  join: function join(separator) {\n    return nativeJoin.call(toIndexedObject(this), separator === undefined ? ',' : separator);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $map = require('../internals/array-iteration').map;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('map');\n// FF49- issue\nvar USES_TO_LENGTH = arrayMethodUsesToLength('map');\n\n// `Array.prototype.map` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.map\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT || !USES_TO_LENGTH }, {\n  map: function map(callbackfn /* , thisArg */) {\n    return $map(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar isObject = require('../internals/is-object');\nvar isArray = require('../internals/is-array');\nvar toAbsoluteIndex = require('../internals/to-absolute-index');\nvar toLength = require('../internals/to-length');\nvar toIndexedObject = require('../internals/to-indexed-object');\nvar createProperty = require('../internals/create-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('slice');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('slice', { ACCESSORS: true, 0: 0, 1: 2 });\n\nvar SPECIES = wellKnownSymbol('species');\nvar nativeSlice = [].slice;\nvar max = Math.max;\n\n// `Array.prototype.slice` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.slice\n// fallback for not array-like ES3 strings and DOM objects\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT || !USES_TO_LENGTH }, {\n  slice: function slice(start, end) {\n    var O = toIndexedObject(this);\n    var length = toLength(O.length);\n    var k = toAbsoluteIndex(start, length);\n    var fin = toAbsoluteIndex(end === undefined ? length : end, length);\n    // inline `ArraySpeciesCreate` for usage native `Array#slice` where it's possible\n    var Constructor, result, n;\n    if (isArray(O)) {\n      Constructor = O.constructor;\n      // cross-realm fallback\n      if (typeof Constructor == 'function' && (Constructor === Array || isArray(Constructor.prototype))) {\n        Constructor = undefined;\n      } else if (isObject(Constructor)) {\n        Constructor = Constructor[SPECIES];\n        if (Constructor === null) Constructor = undefined;\n      }\n      if (Constructor === Array || Constructor === undefined) {\n        return nativeSlice.call(O, k, fin);\n      }\n    }\n    result = new (Constructor === undefined ? Array : Constructor)(max(fin - k, 0));\n    for (n = 0; k < fin; k++, n++) if (k in O) createProperty(result, n, O[k]);\n    result.length = n;\n    return result;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar aFunction = require('../internals/a-function');\nvar toObject = require('../internals/to-object');\nvar fails = require('../internals/fails');\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\n\nvar test = [];\nvar nativeSort = test.sort;\n\n// IE8-\nvar FAILS_ON_UNDEFINED = fails(function () {\n  test.sort(undefined);\n});\n// V8 bug\nvar FAILS_ON_NULL = fails(function () {\n  test.sort(null);\n});\n// Old WebKit\nvar STRICT_METHOD = arrayMethodIsStrict('sort');\n\nvar FORCED = FAILS_ON_UNDEFINED || !FAILS_ON_NULL || !STRICT_METHOD;\n\n// `Array.prototype.sort` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.sort\n$({ target: 'Array', proto: true, forced: FORCED }, {\n  sort: function sort(comparefn) {\n    return comparefn === undefined\n      ? nativeSort.call(toObject(this))\n      : nativeSort.call(toObject(this), aFunction(comparefn));\n  }\n});\n","var DESCRIPTORS = require('../internals/descriptors');\nvar defineProperty = require('../internals/object-define-property').f;\n\nvar FunctionPrototype = Function.prototype;\nvar FunctionPrototypeToString = FunctionPrototype.toString;\nvar nameRE = /^\\s*function ([^ (]*)/;\nvar NAME = 'name';\n\n// Function instances `.name` property\n// https://tc39.github.io/ecma262/#sec-function-instances-name\nif (DESCRIPTORS && !(NAME in FunctionPrototype)) {\n  defineProperty(FunctionPrototype, NAME, {\n    configurable: true,\n    get: function () {\n      try {\n        return FunctionPrototypeToString.call(this).match(nameRE)[1];\n      } catch (error) {\n        return '';\n      }\n    }\n  });\n}\n","'use strict';\nvar DESCRIPTORS = require('../internals/descriptors');\nvar global = require('../internals/global');\nvar isForced = require('../internals/is-forced');\nvar redefine = require('../internals/redefine');\nvar has = require('../internals/has');\nvar classof = require('../internals/classof-raw');\nvar inheritIfRequired = require('../internals/inherit-if-required');\nvar toPrimitive = require('../internals/to-primitive');\nvar fails = require('../internals/fails');\nvar create = require('../internals/object-create');\nvar getOwnPropertyNames = require('../internals/object-get-own-property-names').f;\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar defineProperty = require('../internals/object-define-property').f;\nvar trim = require('../internals/string-trim').trim;\n\nvar NUMBER = 'Number';\nvar NativeNumber = global[NUMBER];\nvar NumberPrototype = NativeNumber.prototype;\n\n// Opera ~12 has broken Object#toString\nvar BROKEN_CLASSOF = classof(create(NumberPrototype)) == NUMBER;\n\n// `ToNumber` abstract operation\n// https://tc39.github.io/ecma262/#sec-tonumber\nvar toNumber = function (argument) {\n  var it = toPrimitive(argument, false);\n  var first, third, radix, maxCode, digits, length, index, code;\n  if (typeof it == 'string' && it.length > 2) {\n    it = trim(it);\n    first = it.charCodeAt(0);\n    if (first === 43 || first === 45) {\n      third = it.charCodeAt(2);\n      if (third === 88 || third === 120) return NaN; // Number('+0x1') should be NaN, old V8 fix\n    } else if (first === 48) {\n      switch (it.charCodeAt(1)) {\n        case 66: case 98: radix = 2; maxCode = 49; break; // fast equal of /^0b[01]+$/i\n        case 79: case 111: radix = 8; maxCode = 55; break; // fast equal of /^0o[0-7]+$/i\n        default: return +it;\n      }\n      digits = it.slice(2);\n      length = digits.length;\n      for (index = 0; index < length; index++) {\n        code = digits.charCodeAt(index);\n        // parseInt parses a string to a first unavailable symbol\n        // but ToNumber should return NaN if a string contains unavailable symbols\n        if (code < 48 || code > maxCode) return NaN;\n      } return parseInt(digits, radix);\n    }\n  } return +it;\n};\n\n// `Number` constructor\n// https://tc39.github.io/ecma262/#sec-number-constructor\nif (isForced(NUMBER, !NativeNumber(' 0o1') || !NativeNumber('0b1') || NativeNumber('+0x1'))) {\n  var NumberWrapper = function Number(value) {\n    var it = arguments.length < 1 ? 0 : value;\n    var dummy = this;\n    return dummy instanceof NumberWrapper\n      // check on 1..constructor(foo) case\n      && (BROKEN_CLASSOF ? fails(function () { NumberPrototype.valueOf.call(dummy); }) : classof(dummy) != NUMBER)\n        ? inheritIfRequired(new NativeNumber(toNumber(it)), dummy, NumberWrapper) : toNumber(it);\n  };\n  for (var keys = DESCRIPTORS ? getOwnPropertyNames(NativeNumber) : (\n    // ES3:\n    'MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,' +\n    // ES2015 (in case, if modules with ES2015 Number statics required before):\n    'EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,' +\n    'MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger'\n  ).split(','), j = 0, key; keys.length > j; j++) {\n    if (has(NativeNumber, key = keys[j]) && !has(NumberWrapper, key)) {\n      defineProperty(NumberWrapper, key, getOwnPropertyDescriptor(NativeNumber, key));\n    }\n  }\n  NumberWrapper.prototype = NumberPrototype;\n  NumberPrototype.constructor = NumberWrapper;\n  redefine(global, NUMBER, NumberWrapper);\n}\n","'use strict';\nvar $ = require('../internals/export');\nvar toInteger = require('../internals/to-integer');\nvar thisNumberValue = require('../internals/this-number-value');\nvar repeat = require('../internals/string-repeat');\nvar fails = require('../internals/fails');\n\nvar nativeToFixed = 1.0.toFixed;\nvar floor = Math.floor;\n\nvar pow = function (x, n, acc) {\n  return n === 0 ? acc : n % 2 === 1 ? pow(x, n - 1, acc * x) : pow(x * x, n / 2, acc);\n};\n\nvar log = function (x) {\n  var n = 0;\n  var x2 = x;\n  while (x2 >= 4096) {\n    n += 12;\n    x2 /= 4096;\n  }\n  while (x2 >= 2) {\n    n += 1;\n    x2 /= 2;\n  } return n;\n};\n\nvar FORCED = nativeToFixed && (\n  0.00008.toFixed(3) !== '0.000' ||\n  0.9.toFixed(0) !== '1' ||\n  1.255.toFixed(2) !== '1.25' ||\n  1000000000000000128.0.toFixed(0) !== '1000000000000000128'\n) || !fails(function () {\n  // V8 ~ Android 4.3-\n  nativeToFixed.call({});\n});\n\n// `Number.prototype.toFixed` method\n// https://tc39.github.io/ecma262/#sec-number.prototype.tofixed\n$({ target: 'Number', proto: true, forced: FORCED }, {\n  // eslint-disable-next-line max-statements\n  toFixed: function toFixed(fractionDigits) {\n    var number = thisNumberValue(this);\n    var fractDigits = toInteger(fractionDigits);\n    var data = [0, 0, 0, 0, 0, 0];\n    var sign = '';\n    var result = '0';\n    var e, z, j, k;\n\n    var multiply = function (n, c) {\n      var index = -1;\n      var c2 = c;\n      while (++index < 6) {\n        c2 += n * data[index];\n        data[index] = c2 % 1e7;\n        c2 = floor(c2 / 1e7);\n      }\n    };\n\n    var divide = function (n) {\n      var index = 6;\n      var c = 0;\n      while (--index >= 0) {\n        c += data[index];\n        data[index] = floor(c / n);\n        c = (c % n) * 1e7;\n      }\n    };\n\n    var dataToString = function () {\n      var index = 6;\n      var s = '';\n      while (--index >= 0) {\n        if (s !== '' || index === 0 || data[index] !== 0) {\n          var t = String(data[index]);\n          s = s === '' ? t : s + repeat.call('0', 7 - t.length) + t;\n        }\n      } return s;\n    };\n\n    if (fractDigits < 0 || fractDigits > 20) throw RangeError('Incorrect fraction digits');\n    // eslint-disable-next-line no-self-compare\n    if (number != number) return 'NaN';\n    if (number <= -1e21 || number >= 1e21) return String(number);\n    if (number < 0) {\n      sign = '-';\n      number = -number;\n    }\n    if (number > 1e-21) {\n      e = log(number * pow(2, 69, 1)) - 69;\n      z = e < 0 ? number * pow(2, -e, 1) : number / pow(2, e, 1);\n      z *= 0x10000000000000;\n      e = 52 - e;\n      if (e > 0) {\n        multiply(0, z);\n        j = fractDigits;\n        while (j >= 7) {\n          multiply(1e7, 0);\n          j -= 7;\n        }\n        multiply(pow(10, j, 1), 0);\n        j = e - 1;\n        while (j >= 23) {\n          divide(1 << 23);\n          j -= 23;\n        }\n        divide(1 << j);\n        multiply(1, 1);\n        divide(2);\n        result = dataToString();\n      } else {\n        multiply(0, z);\n        multiply(1 << -e, 0);\n        result = dataToString() + repeat.call('0', fractDigits);\n      }\n    }\n    if (fractDigits > 0) {\n      k = result.length;\n      result = sign + (k <= fractDigits\n        ? '0.' + repeat.call('0', fractDigits - k) + result\n        : result.slice(0, k - fractDigits) + '.' + result.slice(k - fractDigits));\n    } else {\n      result = sign + result;\n    } return result;\n  }\n});\n","var $ = require('../internals/export');\nvar toObject = require('../internals/to-object');\nvar nativeKeys = require('../internals/object-keys');\nvar fails = require('../internals/fails');\n\nvar FAILS_ON_PRIMITIVES = fails(function () { nativeKeys(1); });\n\n// `Object.keys` method\n// https://tc39.github.io/ecma262/#sec-object.keys\n$({ target: 'Object', stat: true, forced: FAILS_ON_PRIMITIVES }, {\n  keys: function keys(it) {\n    return nativeKeys(toObject(it));\n  }\n});\n","var TO_STRING_TAG_SUPPORT = require('../internals/to-string-tag-support');\nvar redefine = require('../internals/redefine');\nvar toString = require('../internals/object-to-string');\n\n// `Object.prototype.toString` method\n// https://tc39.github.io/ecma262/#sec-object.prototype.tostring\nif (!TO_STRING_TAG_SUPPORT) {\n  redefine(Object.prototype, 'toString', toString, { unsafe: true });\n}\n","'use strict';\nvar $ = require('../internals/export');\nvar exec = require('../internals/regexp-exec');\n\n$({ target: 'RegExp', proto: true, forced: /./.exec !== exec }, {\n  exec: exec\n});\n","'use strict';\nvar redefine = require('../internals/redefine');\nvar anObject = require('../internals/an-object');\nvar fails = require('../internals/fails');\nvar flags = require('../internals/regexp-flags');\n\nvar TO_STRING = 'toString';\nvar RegExpPrototype = RegExp.prototype;\nvar nativeToString = RegExpPrototype[TO_STRING];\n\nvar NOT_GENERIC = fails(function () { return nativeToString.call({ source: 'a', flags: 'b' }) != '/a/b'; });\n// FF44- RegExp#toString has a wrong name\nvar INCORRECT_NAME = nativeToString.name != TO_STRING;\n\n// `RegExp.prototype.toString` method\n// https://tc39.github.io/ecma262/#sec-regexp.prototype.tostring\nif (NOT_GENERIC || INCORRECT_NAME) {\n  redefine(RegExp.prototype, TO_STRING, function toString() {\n    var R = anObject(this);\n    var p = String(R.source);\n    var rf = R.flags;\n    var f = String(rf === undefined && R instanceof RegExp && !('flags' in RegExpPrototype) ? flags.call(R) : rf);\n    return '/' + p + '/' + f;\n  }, { unsafe: true });\n}\n","'use strict';\nvar $ = require('../internals/export');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar toLength = require('../internals/to-length');\nvar notARegExp = require('../internals/not-a-regexp');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar correctIsRegExpLogic = require('../internals/correct-is-regexp-logic');\nvar IS_PURE = require('../internals/is-pure');\n\nvar nativeEndsWith = ''.endsWith;\nvar min = Math.min;\n\nvar CORRECT_IS_REGEXP_LOGIC = correctIsRegExpLogic('endsWith');\n// https://github.com/zloirock/core-js/pull/702\nvar MDN_POLYFILL_BUG = !IS_PURE && !CORRECT_IS_REGEXP_LOGIC && !!function () {\n  var descriptor = getOwnPropertyDescriptor(String.prototype, 'endsWith');\n  return descriptor && !descriptor.writable;\n}();\n\n// `String.prototype.endsWith` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.endswith\n$({ target: 'String', proto: true, forced: !MDN_POLYFILL_BUG && !CORRECT_IS_REGEXP_LOGIC }, {\n  endsWith: function endsWith(searchString /* , endPosition = @length */) {\n    var that = String(requireObjectCoercible(this));\n    notARegExp(searchString);\n    var endPosition = arguments.length > 1 ? arguments[1] : undefined;\n    var len = toLength(that.length);\n    var end = endPosition === undefined ? len : min(toLength(endPosition), len);\n    var search = String(searchString);\n    return nativeEndsWith\n      ? nativeEndsWith.call(that, search, end)\n      : that.slice(end - search.length, end) === search;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar notARegExp = require('../internals/not-a-regexp');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar correctIsRegExpLogic = require('../internals/correct-is-regexp-logic');\n\n// `String.prototype.includes` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.includes\n$({ target: 'String', proto: true, forced: !correctIsRegExpLogic('includes') }, {\n  includes: function includes(searchString /* , position = 0 */) {\n    return !!~String(requireObjectCoercible(this))\n      .indexOf(notARegExp(searchString), arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar anObject = require('../internals/an-object');\nvar toLength = require('../internals/to-length');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar regExpExec = require('../internals/regexp-exec-abstract');\n\n// @@match logic\nfixRegExpWellKnownSymbolLogic('match', 1, function (MATCH, nativeMatch, maybeCallNative) {\n  return [\n    // `String.prototype.match` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.match\n    function match(regexp) {\n      var O = requireObjectCoercible(this);\n      var matcher = regexp == undefined ? undefined : regexp[MATCH];\n      return matcher !== undefined ? matcher.call(regexp, O) : new RegExp(regexp)[MATCH](String(O));\n    },\n    // `RegExp.prototype[@@match]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@match\n    function (regexp) {\n      var res = maybeCallNative(nativeMatch, regexp, this);\n      if (res.done) return res.value;\n\n      var rx = anObject(regexp);\n      var S = String(this);\n\n      if (!rx.global) return regExpExec(rx, S);\n\n      var fullUnicode = rx.unicode;\n      rx.lastIndex = 0;\n      var A = [];\n      var n = 0;\n      var result;\n      while ((result = regExpExec(rx, S)) !== null) {\n        var matchStr = String(result[0]);\n        A[n] = matchStr;\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n        n++;\n      }\n      return n === 0 ? null : A;\n    }\n  ];\n});\n","'use strict';\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar anObject = require('../internals/an-object');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar toInteger = require('../internals/to-integer');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar regExpExec = require('../internals/regexp-exec-abstract');\n\nvar max = Math.max;\nvar min = Math.min;\nvar floor = Math.floor;\nvar SUBSTITUTION_SYMBOLS = /\\$([$&'`]|\\d\\d?|<[^>]*>)/g;\nvar SUBSTITUTION_SYMBOLS_NO_NAMED = /\\$([$&'`]|\\d\\d?)/g;\n\nvar maybeToString = function (it) {\n  return it === undefined ? it : String(it);\n};\n\n// @@replace logic\nfixRegExpWellKnownSymbolLogic('replace', 2, function (REPLACE, nativeReplace, maybeCallNative, reason) {\n  var REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE = reason.REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE;\n  var REPLACE_KEEPS_$0 = reason.REPLACE_KEEPS_$0;\n  var UNSAFE_SUBSTITUTE = REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE ? '$' : '$0';\n\n  return [\n    // `String.prototype.replace` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.replace\n    function replace(searchValue, replaceValue) {\n      var O = requireObjectCoercible(this);\n      var replacer = searchValue == undefined ? undefined : searchValue[REPLACE];\n      return replacer !== undefined\n        ? replacer.call(searchValue, O, replaceValue)\n        : nativeReplace.call(String(O), searchValue, replaceValue);\n    },\n    // `RegExp.prototype[@@replace]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@replace\n    function (regexp, replaceValue) {\n      if (\n        (!REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE && REPLACE_KEEPS_$0) ||\n        (typeof replaceValue === 'string' && replaceValue.indexOf(UNSAFE_SUBSTITUTE) === -1)\n      ) {\n        var res = maybeCallNative(nativeReplace, regexp, this, replaceValue);\n        if (res.done) return res.value;\n      }\n\n      var rx = anObject(regexp);\n      var S = String(this);\n\n      var functionalReplace = typeof replaceValue === 'function';\n      if (!functionalReplace) replaceValue = String(replaceValue);\n\n      var global = rx.global;\n      if (global) {\n        var fullUnicode = rx.unicode;\n        rx.lastIndex = 0;\n      }\n      var results = [];\n      while (true) {\n        var result = regExpExec(rx, S);\n        if (result === null) break;\n\n        results.push(result);\n        if (!global) break;\n\n        var matchStr = String(result[0]);\n        if (matchStr === '') rx.lastIndex = advanceStringIndex(S, toLength(rx.lastIndex), fullUnicode);\n      }\n\n      var accumulatedResult = '';\n      var nextSourcePosition = 0;\n      for (var i = 0; i < results.length; i++) {\n        result = results[i];\n\n        var matched = String(result[0]);\n        var position = max(min(toInteger(result.index), S.length), 0);\n        var captures = [];\n        // NOTE: This is equivalent to\n        //   captures = result.slice(1).map(maybeToString)\n        // but for some reason `nativeSlice.call(result, 1, result.length)` (called in\n        // the slice polyfill when slicing native arrays) \"doesn't work\" in safari 9 and\n        // causes a crash (https://pastebin.com/N21QzeQA) when trying to debug it.\n        for (var j = 1; j < result.length; j++) captures.push(maybeToString(result[j]));\n        var namedCaptures = result.groups;\n        if (functionalReplace) {\n          var replacerArgs = [matched].concat(captures, position, S);\n          if (namedCaptures !== undefined) replacerArgs.push(namedCaptures);\n          var replacement = String(replaceValue.apply(undefined, replacerArgs));\n        } else {\n          replacement = getSubstitution(matched, S, position, captures, namedCaptures, replaceValue);\n        }\n        if (position >= nextSourcePosition) {\n          accumulatedResult += S.slice(nextSourcePosition, position) + replacement;\n          nextSourcePosition = position + matched.length;\n        }\n      }\n      return accumulatedResult + S.slice(nextSourcePosition);\n    }\n  ];\n\n  // https://tc39.github.io/ecma262/#sec-getsubstitution\n  function getSubstitution(matched, str, position, captures, namedCaptures, replacement) {\n    var tailPos = position + matched.length;\n    var m = captures.length;\n    var symbols = SUBSTITUTION_SYMBOLS_NO_NAMED;\n    if (namedCaptures !== undefined) {\n      namedCaptures = toObject(namedCaptures);\n      symbols = SUBSTITUTION_SYMBOLS;\n    }\n    return nativeReplace.call(replacement, symbols, function (match, ch) {\n      var capture;\n      switch (ch.charAt(0)) {\n        case '$': return '$';\n        case '&': return matched;\n        case '`': return str.slice(0, position);\n        case \"'\": return str.slice(tailPos);\n        case '<':\n          capture = namedCaptures[ch.slice(1, -1)];\n          break;\n        default: // \\d\\d?\n          var n = +ch;\n          if (n === 0) return match;\n          if (n > m) {\n            var f = floor(n / 10);\n            if (f === 0) return match;\n            if (f <= m) return captures[f - 1] === undefined ? ch.charAt(1) : captures[f - 1] + ch.charAt(1);\n            return match;\n          }\n          capture = captures[n - 1];\n      }\n      return capture === undefined ? '' : capture;\n    });\n  }\n});\n","'use strict';\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar anObject = require('../internals/an-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar sameValue = require('../internals/same-value');\nvar regExpExec = require('../internals/regexp-exec-abstract');\n\n// @@search logic\nfixRegExpWellKnownSymbolLogic('search', 1, function (SEARCH, nativeSearch, maybeCallNative) {\n  return [\n    // `String.prototype.search` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.search\n    function search(regexp) {\n      var O = requireObjectCoercible(this);\n      var searcher = regexp == undefined ? undefined : regexp[SEARCH];\n      return searcher !== undefined ? searcher.call(regexp, O) : new RegExp(regexp)[SEARCH](String(O));\n    },\n    // `RegExp.prototype[@@search]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@search\n    function (regexp) {\n      var res = maybeCallNative(nativeSearch, regexp, this);\n      if (res.done) return res.value;\n\n      var rx = anObject(regexp);\n      var S = String(this);\n\n      var previousLastIndex = rx.lastIndex;\n      if (!sameValue(previousLastIndex, 0)) rx.lastIndex = 0;\n      var result = regExpExec(rx, S);\n      if (!sameValue(rx.lastIndex, previousLastIndex)) rx.lastIndex = previousLastIndex;\n      return result === null ? -1 : result.index;\n    }\n  ];\n});\n","'use strict';\nvar fixRegExpWellKnownSymbolLogic = require('../internals/fix-regexp-well-known-symbol-logic');\nvar isRegExp = require('../internals/is-regexp');\nvar anObject = require('../internals/an-object');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar speciesConstructor = require('../internals/species-constructor');\nvar advanceStringIndex = require('../internals/advance-string-index');\nvar toLength = require('../internals/to-length');\nvar callRegExpExec = require('../internals/regexp-exec-abstract');\nvar regexpExec = require('../internals/regexp-exec');\nvar fails = require('../internals/fails');\n\nvar arrayPush = [].push;\nvar min = Math.min;\nvar MAX_UINT32 = 0xFFFFFFFF;\n\n// babel-minify transpiles RegExp('x', 'y') -> /x/y and it causes SyntaxError\nvar SUPPORTS_Y = !fails(function () { return !RegExp(MAX_UINT32, 'y'); });\n\n// @@split logic\nfixRegExpWellKnownSymbolLogic('split', 2, function (SPLIT, nativeSplit, maybeCallNative) {\n  var internalSplit;\n  if (\n    'abbc'.split(/(b)*/)[1] == 'c' ||\n    'test'.split(/(?:)/, -1).length != 4 ||\n    'ab'.split(/(?:ab)*/).length != 2 ||\n    '.'.split(/(.?)(.?)/).length != 4 ||\n    '.'.split(/()()/).length > 1 ||\n    ''.split(/.?/).length\n  ) {\n    // based on es5-shim implementation, need to rework it\n    internalSplit = function (separator, limit) {\n      var string = String(requireObjectCoercible(this));\n      var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;\n      if (lim === 0) return [];\n      if (separator === undefined) return [string];\n      // If `separator` is not a regex, use native split\n      if (!isRegExp(separator)) {\n        return nativeSplit.call(string, separator, lim);\n      }\n      var output = [];\n      var flags = (separator.ignoreCase ? 'i' : '') +\n                  (separator.multiline ? 'm' : '') +\n                  (separator.unicode ? 'u' : '') +\n                  (separator.sticky ? 'y' : '');\n      var lastLastIndex = 0;\n      // Make `global` and avoid `lastIndex` issues by working with a copy\n      var separatorCopy = new RegExp(separator.source, flags + 'g');\n      var match, lastIndex, lastLength;\n      while (match = regexpExec.call(separatorCopy, string)) {\n        lastIndex = separatorCopy.lastIndex;\n        if (lastIndex > lastLastIndex) {\n          output.push(string.slice(lastLastIndex, match.index));\n          if (match.length > 1 && match.index < string.length) arrayPush.apply(output, match.slice(1));\n          lastLength = match[0].length;\n          lastLastIndex = lastIndex;\n          if (output.length >= lim) break;\n        }\n        if (separatorCopy.lastIndex === match.index) separatorCopy.lastIndex++; // Avoid an infinite loop\n      }\n      if (lastLastIndex === string.length) {\n        if (lastLength || !separatorCopy.test('')) output.push('');\n      } else output.push(string.slice(lastLastIndex));\n      return output.length > lim ? output.slice(0, lim) : output;\n    };\n  // Chakra, V8\n  } else if ('0'.split(undefined, 0).length) {\n    internalSplit = function (separator, limit) {\n      return separator === undefined && limit === 0 ? [] : nativeSplit.call(this, separator, limit);\n    };\n  } else internalSplit = nativeSplit;\n\n  return [\n    // `String.prototype.split` method\n    // https://tc39.github.io/ecma262/#sec-string.prototype.split\n    function split(separator, limit) {\n      var O = requireObjectCoercible(this);\n      var splitter = separator == undefined ? undefined : separator[SPLIT];\n      return splitter !== undefined\n        ? splitter.call(separator, O, limit)\n        : internalSplit.call(String(O), separator, limit);\n    },\n    // `RegExp.prototype[@@split]` method\n    // https://tc39.github.io/ecma262/#sec-regexp.prototype-@@split\n    //\n    // NOTE: This cannot be properly polyfilled in engines that don't support\n    // the 'y' flag.\n    function (regexp, limit) {\n      var res = maybeCallNative(internalSplit, regexp, this, limit, internalSplit !== nativeSplit);\n      if (res.done) return res.value;\n\n      var rx = anObject(regexp);\n      var S = String(this);\n      var C = speciesConstructor(rx, RegExp);\n\n      var unicodeMatching = rx.unicode;\n      var flags = (rx.ignoreCase ? 'i' : '') +\n                  (rx.multiline ? 'm' : '') +\n                  (rx.unicode ? 'u' : '') +\n                  (SUPPORTS_Y ? 'y' : 'g');\n\n      // ^(? + rx + ) is needed, in combination with some S slicing, to\n      // simulate the 'y' flag.\n      var splitter = new C(SUPPORTS_Y ? rx : '^(?:' + rx.source + ')', flags);\n      var lim = limit === undefined ? MAX_UINT32 : limit >>> 0;\n      if (lim === 0) return [];\n      if (S.length === 0) return callRegExpExec(splitter, S) === null ? [S] : [];\n      var p = 0;\n      var q = 0;\n      var A = [];\n      while (q < S.length) {\n        splitter.lastIndex = SUPPORTS_Y ? q : 0;\n        var z = callRegExpExec(splitter, SUPPORTS_Y ? S : S.slice(q));\n        var e;\n        if (\n          z === null ||\n          (e = min(toLength(splitter.lastIndex + (SUPPORTS_Y ? 0 : q)), S.length)) === p\n        ) {\n          q = advanceStringIndex(S, q, unicodeMatching);\n        } else {\n          A.push(S.slice(p, q));\n          if (A.length === lim) return A;\n          for (var i = 1; i <= z.length - 1; i++) {\n            A.push(z[i]);\n            if (A.length === lim) return A;\n          }\n          q = p = e;\n        }\n      }\n      A.push(S.slice(p));\n      return A;\n    }\n  ];\n}, !SUPPORTS_Y);\n","'use strict';\nvar $ = require('../internals/export');\nvar getOwnPropertyDescriptor = require('../internals/object-get-own-property-descriptor').f;\nvar toLength = require('../internals/to-length');\nvar notARegExp = require('../internals/not-a-regexp');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\nvar correctIsRegExpLogic = require('../internals/correct-is-regexp-logic');\nvar IS_PURE = require('../internals/is-pure');\n\nvar nativeStartsWith = ''.startsWith;\nvar min = Math.min;\n\nvar CORRECT_IS_REGEXP_LOGIC = correctIsRegExpLogic('startsWith');\n// https://github.com/zloirock/core-js/pull/702\nvar MDN_POLYFILL_BUG = !IS_PURE && !CORRECT_IS_REGEXP_LOGIC && !!function () {\n  var descriptor = getOwnPropertyDescriptor(String.prototype, 'startsWith');\n  return descriptor && !descriptor.writable;\n}();\n\n// `String.prototype.startsWith` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.startswith\n$({ target: 'String', proto: true, forced: !MDN_POLYFILL_BUG && !CORRECT_IS_REGEXP_LOGIC }, {\n  startsWith: function startsWith(searchString /* , position = 0 */) {\n    var that = String(requireObjectCoercible(this));\n    notARegExp(searchString);\n    var index = toLength(min(arguments.length > 1 ? arguments[1] : undefined, that.length));\n    var search = String(searchString);\n    return nativeStartsWith\n      ? nativeStartsWith.call(that, search, index)\n      : that.slice(index, index + search.length) === search;\n  }\n});\n","'use strict';\nvar $ = require('../internals/export');\nvar $trim = require('../internals/string-trim').trim;\nvar forcedStringTrimMethod = require('../internals/string-trim-forced');\n\n// `String.prototype.trim` method\n// https://tc39.github.io/ecma262/#sec-string.prototype.trim\n$({ target: 'String', proto: true, forced: forcedStringTrimMethod('trim') }, {\n  trim: function trim() {\n    return $trim(this);\n  }\n});\n","var global = require('../internals/global');\nvar DOMIterables = require('../internals/dom-iterables');\nvar forEach = require('../internals/array-for-each');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  var Collection = global[COLLECTION_NAME];\n  var CollectionPrototype = Collection && Collection.prototype;\n  // some Chrome versions have non-configurable methods on DOMTokenList\n  if (CollectionPrototype && CollectionPrototype.forEach !== forEach) try {\n    createNonEnumerableProperty(CollectionPrototype, 'forEach', forEach);\n  } catch (error) {\n    CollectionPrototype.forEach = forEach;\n  }\n}\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","(function (window) {\r\n  var Service = function (opts) {\r\n    var options = {\r\n      //资源类型\r\n      resourceKeys: [\r\n        'portwharf', //港口码头\r\n        'bas_school', //学校\r\n        'hospital', //医院\r\n        'culturalrelicunit', //文物保护单位\r\n        'Hotel※00',\r\n        'hotel', //宾馆\r\n        'airport', //机场\r\n        'railwaystation', //火车站\r\n        'coachstation', //汽车站\r\n        'government※00',\r\n        'government', //政府机关\r\n        'archives', //档案馆\r\n        'Newscast※00',\r\n        'tvcast', //电视台\r\n        'newscast', //广播电台\r\n        'Resins※00',\r\n        'researchinstitution', //国防科研\r\n        'Resins※02', //科研单位\r\n        'financialins', //银行金融机构\r\n        'market', //大型商贸\r\n        'bazaar', //集贸市场\r\n        'Gymnasium', //大型文化体育场所\r\n        'tourist', //旅游景区\r\n        'culturalvenues', //文化场馆\r\n        'gasfacil', //大型能源动力设施\r\n        'powerfacil', //燃气供应设施\r\n        'supwatfacil', //供水设施\r\n        'Powerfacilities※00',\r\n        'powerfacilities', //供电设施\r\n        'Communication※01',//通讯社\r\n        'sluice',//水闸\r\n        'ocepasture',//海阳牧场\r\n        'farm',\r\n        'gasstation',\r\n        'monitorstation',//地震监测站台\r\n      ]\r\n    }\r\n    this.opts = jQuery.extend(true, options, opts);\r\n    // this.commonService = window.EMapServerV2.CommonService.getInstance(opts);\r\n    this.commonService = new window.EMapServerV2.CommonService(opts);\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param opts.resourceKeys\r\n   * @param callback\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getStatistics = function (opts, callback, ctx) {\r\n    //去掉最后一类地质隐患点\r\n    var resourceKeys = opts.resourceKeys || this.opts.resourceKeys.slice(0);\r\n    this.commonService.getStatistics(resourceKeys, {}, function (err, data) {\r\n      callback.call(ctx, null, data);\r\n    }, this);\r\n  }\r\n\r\n  /**\r\n   * 按条件统计\r\n   * @param opts\r\n   * @param opts.districtCode\r\n   * @param callback\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getStatisticsByFilter = function (opts, callback, ctx) {\r\n    var filter = {};\r\n    opts = opts || {};\r\n    filter.districtCode = opts.districtCode;\r\n    this.commonService.getStatistics(this.opts.resourceKeys, filter, function (err, data) {\r\n      callback.call(ctx, null, data);\r\n    }, this);\r\n  }\r\n\r\n  /**\r\n   * 查询列表数据\r\n   * @param opts\r\n   * @param opts.resourceKey，多个逗号分隔\r\n   * @param opts.pageSize\r\n   * @param opts.pageIndex\r\n   * @param opts.districtCode\r\n   * @param callback\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getDataList = function (opts, callback, ctx) {\r\n    opts = opts || {};\r\n    opts.flatTag = true;\r\n    this.commonService.getDataList(opts, function (err, data) {\r\n      callback.call(ctx, null, data);\r\n    }, this);\r\n  }\r\n\r\n  Service.prototype.getNearbyList = function (opts, callback, ctx) {\r\n    opts = opts || {};\r\n    opts.flatTag = true;\r\n    opts.resourceKeys = this.opts.resourceKeys;\r\n    var radius = opts.config[\"ANJIAN_DAGCHEMENT※DangerousChemical\"].radius;\r\n    this.commonService.getEventData(opts.eventType, function (err, data) {\r\n      var config = opts.config || {};\r\n      //读取默认距离配置、传参的距离\r\n      var configRadius = data.tag.SEARCH_DIST;\r\n      if (configRadius != null && configRadius != '' && !isNaN(configRadius)) {\r\n        configRadius = parseFloat(configRadius) * 1000;\r\n      } else {\r\n        configRadius = 1000 * 1000;\r\n      }\r\n      for (var i = 0; i < this.opts.resourceKeys.length; i++) {\r\n        var resourceKey = this.opts.resourceKeys[i];\r\n        if (config.hasOwnProperty(resourceKey)) {\r\n          if (!config[resourceKey].radius) {\r\n            config[resourceKey].radius = configRadius;\r\n          }\r\n        } else {\r\n          config[resourceKey] = {\r\n            radius: configRadius\r\n          }\r\n        }\r\n      }\r\n      this.commonService.getNearbyList(opts, function (err, resultSet) {\r\n        var list = resultSet.list;\r\n        resultSet.radius = list[0] ? list[0].radius : radius;\r\n        //危化企业根据产量分类\r\n        for (var i = 0; i < list.length; i++) {\r\n          var item = list[i];\r\n          if (item && item.codeKey === this.opts.resourceKeys[0]) {\r\n            var itemList = item.data;\r\n            var rangeMap = {\r\n              '1000': {\r\n                range: [1000, Number.MAX_VALUE],\r\n                list: []\r\n              },\r\n              '100': {\r\n                range: [100, 1000],\r\n                list: []\r\n              },\r\n              '0': {\r\n                range: [0, 100],\r\n                list: []\r\n              }\r\n            }\r\n            var itemCount = itemList.length;\r\n            for (var j = 0; j < itemCount; j++) {\r\n              var rowObj = itemList[j],\r\n                sumCount = rowObj.SUMOUTPUT;\r\n              for (var rangeKey in rangeMap) {\r\n                var rangeObj = rangeMap[rangeKey],\r\n                  rangeArr = rangeObj.range;\r\n                if (sumCount >= rangeArr[0] && sumCount < rangeArr[1]) {\r\n                  rangeObj.list.push(rowObj);\r\n                  break;\r\n                }\r\n              }\r\n            }\r\n            var newData = {};\r\n            for (var k in rangeMap) {\r\n              newData[k] = rangeMap[k].list;\r\n            }\r\n            item.data = newData;\r\n          }\r\n        }\r\n        callback.call(ctx, null, resultSet);\r\n      }, this);\r\n    }, this);\r\n  }\r\n  window.EMapServerV2 = window.EMapServerV2 || {};\r\n  // 参考\r\n  window.EMapServerV2.BaseDataService = Service;\r\n\r\n})(window);","(function(window) {\r\n\r\n    /**\r\n     *\r\n     * @param opts\r\n     * @constructor\r\n     */\r\n    var Service = function(opts) {\r\n            this.opts = {\r\n                configUrl: './json/oldserver/nearby.json',\r\n                serverUrl: EMAP_CONFIG.common.mongoService,\r\n            };\r\n            //\r\n            this._resourceTemp = null;\r\n            //\r\n            this._configTemp = null;\r\n            //\r\n            this.seperator = '※';\r\n            //事件类型\r\n            this.eventTypeList = null;\r\n        }\r\n        /**\r\n         * 获取资源类型\r\n         * @param callback\r\n         * @param ctx\r\n         */\r\n    Service.prototype.getResources = function(callback, ctx) {\r\n        if (this._resourceTemp == null) {\r\n            var self = this;\r\n            var aggregate = [{\r\n                    \"$lookup\": {\r\n                        //字典表需要加上user_safety_前缀；\r\n                        \"from\": \"user_safety_REL_RESOURCE_EMTYPE\",\r\n                        //主表里的关联字段\r\n                        \"localField\": \"tag.NODEID\",\r\n                        //字典表的关联字段\r\n                        \"foreignField\": \"tag.NODEID\",\r\n                        //结果信息存放属性\r\n                        \"as\": \"REL\"\r\n                    }\r\n                },\r\n                {\r\n                    //展开数组\r\n                    \"$unwind\": {\r\n                        path: \"$REL\",\r\n                        preserveNullAndEmptyArrays: true\r\n                    }\r\n                },\r\n                {\r\n                    \"$lookup\": {\r\n                        //字典表需要加上user_safety_前缀；\r\n                        \"from\": \"user_safety_JC_RESTEAMCFG\",\r\n                        //主表里的关联字段\r\n                        \"localField\": \"tag.NODEID\",\r\n                        //字典表的关联字段\r\n                        \"foreignField\": \"tag.FIRETEAMTYPECODE\",\r\n                        //结果信息存放属性\r\n                        \"as\": \"CFG\"\r\n                    }\r\n                },\r\n                {\r\n                    //展开数组\r\n                    \"$unwind\": {\r\n                        path: \"$CFG\",\r\n                        preserveNullAndEmptyArrays: true\r\n                    }\r\n                },\r\n                {\r\n                    $project: {\r\n                        \"tag\": \"$tag\",\r\n                        \"type\": \"$REL.tag.TYPECODE\",\r\n                        \"orderNum\": \"$REL.tag.ORDERNUM\",\r\n                        \"config\": \"$CFG.tag\"\r\n                    }\r\n                },\r\n                {\r\n                    $sort: {\r\n                        \"tag.ORDERNUM\": 1\r\n                    }\r\n                }\r\n            ]\r\n            var query = {};\r\n            var data = {};\r\n            data.dataSetId = 'RESOURCE_CATALOG';\r\n            data.query = JSON.stringify(query);\r\n            data.aggregate = JSON.stringify(aggregate);\r\n            data.eId = 'safety';\r\n            var opts = {};\r\n            opts.url = this.opts.serverUrl + '/dataStatics/aggregate';\r\n            opts.data = data;\r\n            opts.type = 'get';\r\n            opts.dataType = 'json';\r\n            opts.success = function(data) {\r\n                self._resourceTemp = data.data;\r\n                callback && callback.call(ctx, null, jQuery.extend(true, [], self._resourceTemp));\r\n            }\r\n            opts.error = function(err) {\r\n                callback && callback.call(ctx, new Error('服务器问题'));\r\n            }\r\n            return jQuery.ajax(opts);\r\n        } else {\r\n            callback && callback.call(ctx, null, jQuery.extend(true, [], this._resourceTemp));\r\n            return null;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 获取资源配置\r\n     * @param callback\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getResourceConfig = function(callback, ctx) {\r\n        if (this._configTemp == null) {\r\n            var self = this;\r\n            var opts = {};\r\n            opts.url = this.opts.configUrl;\r\n            opts.dataType = 'json';\r\n            opts.success = function(data) {\r\n                self._configTemp = plainConfig.call(self, data.resources);\r\n                callback && callback.call(ctx, null, jQuery.extend(true, {}, self._configTemp));\r\n            }\r\n            opts.error = function(err) {\r\n                callback && callback.call(ctx, new Error('服务器问题'));\r\n            }\r\n            jQuery.ajax(opts);\r\n        } else {\r\n            callback && callback.call(ctx, null, jQuery.extend(true, {}, this._configTemp));\r\n        }\r\n        //\r\n        function plainConfig(resources) {\r\n            var resourceSet = {};\r\n            var seperator = this.seperator;\r\n            for (var resourceKey in resources) {\r\n                var resource = resources[resourceKey];\r\n                var serviceObj = resource.service || {};\r\n                if (resource.children && Object.keys(resource.children).length > 0) {\r\n                    for (var childKey in resource.children) {\r\n                        var resourceId = resourceKey + seperator + childKey,\r\n                            childResource = resource.children[childKey];\r\n                        var serviceObjClone = jQuery.extend(true, {}, serviceObj);\r\n                        childResource.service = jQuery.extend(true, serviceObjClone, childResource.service || {});\r\n                        childResource.id = resourceId;\r\n                        childResource.tableFields = childResource.tableFields || resource.tableFields;\r\n                        childResource.tableName = childResource.tableName || resource.tableName;\r\n                        childResource.districtField = childResource.districtField || resource.districtField;\r\n                        childResource.keyWordFields = childResource.keyWordFields || resource.keyWordFields;\r\n                        childResource.keyField = childResource.keyField || resource.keyField;\r\n                        childResource.idKey = childResource.idKey || resource.idKey;\r\n                        childResource.fieldMap = childResource.fieldMap || resource.fieldMap;\r\n                        childResource.sort = childResource.sort || resource.sort;\r\n                        childResource.sumField = childResource.sumField || resource.sumField;\r\n                        resourceSet[resourceId] = childResource;\r\n                    }\r\n                } else {\r\n                    var resourceId = resourceKey;\r\n                    resource.id = resourceId;\r\n                    resourceSet[resourceId] = resource;\r\n                }\r\n            }\r\n            return resourceSet;\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 根据事件类型，获取相关联的资源类型树\r\n     * @param eventType\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getResourceTreeByEventType = function(eventType, cb, ctx) {\r\n        this.getResources(function(err, data) {\r\n            var allList = [];\r\n            var rootId = 'c_root';\r\n            var nodeMap = {},\r\n                matchNodeMap = {},\r\n                filterType = !(eventType == null || eventType == '');\r\n            //\r\n            var index = 0;\r\n            for (var i = 0; i < data.length; i++) {\r\n                var item = data[i],\r\n                    tag = item.tag,\r\n                    itemId = tag.NODEID,\r\n                    tempObj = {};\r\n                nodeMap[itemId] = tempObj;\r\n                tempObj.id = itemId;\r\n                tempObj.name = tag.NAME;\r\n                tempObj.parentId = tag.PARENTID;\r\n                tempObj.resourceTag = tag.NODEKEY || null;\r\n                tempObj.e_orderNum = item.orderNum;\r\n                tempObj.orderNum = tag.ORDERNUM;\r\n                if (item.config) {\r\n                    tempObj.allCount = item.config.ALLTEAMNUM;\r\n                    tempObj.limit = [item.config.NEARBYTEAMNUM, item.config.READYTEANUM];\r\n                    // console.log(JSON.stringify(item),'  ',tempObj.limit)\r\n                }\r\n                if (!filterType || item.type == eventType) {\r\n                    matchNodeMap[itemId] = tempObj;\r\n                }\r\n                allList.push(tempObj);\r\n            }\r\n            //\r\n            var resultMap = {};\r\n            resultMap[rootId] = nodeMap[rootId];\r\n            for (var nodeId in matchNodeMap) {\r\n                var matchNode = matchNodeMap[nodeId];\r\n                handleEachNode(matchNode, resultMap, matchNodeMap, nodeMap);\r\n            }\r\n            var newList = [];\r\n            for (var nId in resultMap) {\r\n                newList.push(resultMap[nId]);\r\n            }\r\n            //排序\r\n            if (eventType == null) {\r\n                //深度优先遍历排序\r\n                var treeData = this.formatTree(newList, {\r\n                    pIdField: 'parentId',\r\n                    idField: 'id'\r\n                });\r\n                visitAndSortByDepth(treeData[0], {\r\n                    idx: 1\r\n                }, nodeMap);\r\n                newList.sort(function(a, b) {\r\n                    return a._order_num - b._order_num;\r\n                });\r\n            } else {\r\n                newList.sort(function(a, b) {\r\n                    var aN = a.e_orderNum || 10000,\r\n                        bN = b.e_orderNum || 10000;\r\n                    return aN - bN;\r\n                });\r\n            }\r\n            // console.log('>>', newList.length);\r\n            cb && cb.call(ctx, null, newList);\r\n        }, this);\r\n\r\n        function handleEachNode(node, resultMap, matchMap, fullMap) {\r\n            resultMap[node.id] = node;\r\n            visitParent(node, fullMap, resultMap);\r\n            visitChildren(node, fullMap, resultMap);\r\n        }\r\n\r\n        function visitParent(node, fullMap, resultMap) {\r\n            var parent = fullMap[node.parentId];\r\n            if (parent) {\r\n                if (!node.limit && parent.limit) {\r\n                    node.limit = parent.limit;\r\n                }\r\n                ensureOrderNum(node, parent);\r\n                resultMap[parent.id] = parent;\r\n                visitParent(parent, fullMap, resultMap);\r\n            }\r\n        }\r\n\r\n        function visitChildren(node, fullMap, resultMap) {\r\n            var nodeId = node.id;\r\n            for (var kk in fullMap) {\r\n                var tempNode = fullMap[kk];\r\n                if (tempNode.parentId == nodeId) {\r\n                    ensureOrderNum(tempNode, node);\r\n                    if (!tempNode.limit && node.limit) {\r\n                        tempNode.limit = node.limit;\r\n                    }\r\n                    resultMap[tempNode.id] = tempNode;\r\n                    visitChildren(tempNode.id, fullMap, resultMap);\r\n                }\r\n            }\r\n        }\r\n\r\n        function ensureOrderNum(node, parent) {\r\n            if (isNaN(node.e_orderNum) && !isNaN(parent.e_orderNum)) {\r\n                node.e_orderNum = parent.e_orderNum;\r\n            }\r\n            if (isNaN(node.orderNum) && !isNaN(parent.orderNum)) {\r\n                node.orderNum = parent.orderNum;\r\n            }\r\n        }\r\n\r\n        //\r\n        function visitAndSortByDepth(node, obj, fullNodeSet) {\r\n            var nodeTemp = fullNodeSet[node.id] || {};\r\n            nodeTemp._order_num = obj.idx++;\r\n            var children = node.children || [];\r\n            if (children.length > 0) {\r\n                for (var j = 0; j < children.length; j++) {\r\n                    visitAndSortByDepth(children[j], obj, fullNodeSet);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 根据类型获取资源\r\n     * @param eventType\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getResourcesByEventType = function(eventType, cb, ctx) {\r\n        this.getResourceConfig(function(err, resources) {\r\n            //this.getResourceTreeByEventType(eventType, function (err, data) {\r\n            if (err == null) {\r\n                var resourceNodeMap = {};\r\n                var regex = /^(.*)\\_([^\\_]*)$/;\r\n                for (var i = 0; i < data.length; i++) {\r\n                    var item = data[i],\r\n                        resourceTag = item.resourceTag;\r\n                    if (resourceTag) {\r\n                        if (regex.test(resourceTag)) {\r\n                            var groups = regex.exec(resourceTag);\r\n                            resourceTag = groups[1] + this.seperator + groups[2];\r\n                        }\r\n                        var resource = resources[resourceTag];\r\n                        if (resource && item.limit) {\r\n                            resource.limit = item.limit;\r\n                        }\r\n                        if (resource) {\r\n                            resource._order_num = item._order_num;\r\n                        }\r\n                        resourceNodeMap[resourceTag] = resource;\r\n                    }\r\n                }\r\n                cb.call(ctx, null, resourceNodeMap);\r\n            } else {\r\n                cb.call(ctx, err);\r\n            }\r\n            //}, this);\r\n        }, this);\r\n    }\r\n\r\n    /**\r\n     * 获取事件类型\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getEventType = function(cb, ctx) {\r\n        if (this.eventTypeList == null) {\r\n            var self = this;\r\n            jQuery.ajax({\r\n                url: this.opts.serverUrl + '/dataOperate/queryMulti',\r\n                dataType: 'json',\r\n                data: {\r\n                    eId: 'safety',\r\n                    data: JSON.stringify({\r\n                        'CODE_EMERGENCY_CLASS': {\r\n                            'query': {},\r\n                            'sort': '_id'\r\n                        }\r\n                    })\r\n                },\r\n                success: function(data) {\r\n                    var data = data.data;\r\n                    var list = data[Object.keys(data)[0]];\r\n                    self.eventTypeList = list;\r\n                    cb && cb.call(ctx, null, list);\r\n                },\r\n                error: function(err) {\r\n                    cb && cb.call(ctx, err);\r\n                }\r\n            });\r\n        } else {\r\n            cb && cb.call(ctx, null, jQuery.extend(true, [], this.eventTypeList));\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 获取事件类型信息\r\n     * @param eventType\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getEventData = function(eventType, cb, ctx) {\r\n        this.getEventType(function(err, data) {\r\n            var obj = null;\r\n            for (var i = 0; i < data.length; i++) {\r\n                var item = data[i];\r\n                if (item && item.tag.TYPECODE === eventType) {\r\n                    obj = item;\r\n                    break;\r\n                }\r\n            }\r\n            cb && cb.call(ctx, null, obj);\r\n        }, this)\r\n    }\r\n\r\n    /**\r\n     * 格式化为树形式\r\n     * @param nodes {Array} 节点数组\r\n     * @param opts {Object}\r\n     * @param opts.idField {String} id字段名\r\n     * @param opts.pIdField {String} pId字段名\r\n     */\r\n    Service.prototype.formatTree = function(nodes, opts) {\r\n        if (!(nodes && opts && opts.idField &&\r\n                opts.pIdField)) {\r\n            return null;\r\n        }\r\n        var nodeList = jQuery.extend(true, [], nodes || []),\r\n            idField = opts.idField,\r\n            pIdField = opts.pIdField;\r\n        //\r\n        var nodeMap = {};\r\n        for (var i = 0; i < nodeList.length; i++) {\r\n            var node = nodeList[i];\r\n            var temp = {};\r\n            temp.id = node[idField];\r\n            temp.pId = node[pIdField];\r\n            temp.orig = node;\r\n            nodeMap[temp.id] = temp;\r\n        }\r\n        //\r\n        var treeData = [];\r\n        var visitMap = {};\r\n        for (var k in nodeMap) {\r\n            var node = nodeMap[k];\r\n            if (visitMap.hasOwnProperty(k)) {\r\n                continue;\r\n            }\r\n            visitNode(node, nodeMap, visitMap, treeData);\r\n        }\r\n        return treeData;\r\n\r\n        function visitNode(node, nodeMap, visitMap, treeData) {\r\n            if (nodeMap.hasOwnProperty(node.pId)) {\r\n                var parentNode = nodeMap[node.pId];\r\n                if (!visitMap.hasOwnProperty(parentNode.id)) {\r\n                    arguments.callee(parentNode, nodeMap, visitMap, treeData);\r\n                }\r\n                var treeNode = visitMap[parentNode.id];\r\n                var children = treeNode.children || [];\r\n                children.push(node.orig);\r\n                treeNode.children = children;\r\n                visitMap[node.id] = node.orig;\r\n            } else { //is root\r\n                treeData.push(node.orig);\r\n                visitMap[node.id] = node.orig;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 统计资源\r\n     * @param resourceKeys 资源\r\n     * @param filter 过滤条件\r\n     * @param filter.districtCode\r\n     * @param filter.keyword\r\n     * @param callback\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getStatistics = function(resourceKeys, filter, callback, ctx) {\r\n        this.getFilterResources(null, resourceKeys, function(err, resources) {\r\n            var aggregateList = [];\r\n            for (var resourceKey in resources) {\r\n                var resource = resources[resourceKey];\r\n                if (resource) {\r\n                    var aggregateObj = this.getStatisticsAggregate(resources[resourceKey], filter);\r\n                    aggregateList.push(aggregateObj);\r\n                }\r\n            }\r\n            this.statisticsMulti(aggregateList, function(err, data) {\r\n                var resultList = [];\r\n                var total = 0;\r\n                var resourceList = [];\r\n                for (var k in resources) {\r\n                    var r = resources[k];\r\n                    resourceList.push(r);\r\n                }\r\n                //排序\r\n                resourceList.sort(function(a, b) {\r\n                    return a._order_num - b._order_num;\r\n                });\r\n                for (var i = 0; i < resourceList.length; i++) {\r\n                    var resource = resourceList[i] || {},\r\n                        rk = resource.id;\r\n                    var count = (isNaN(data[rk]) || isNaN(parseInt(data[rk]))) ? 0 : parseInt(data[rk]);\r\n                    total += count;\r\n                    var title = resource.title;\r\n                    resultList.push({\r\n                        codeKey: rk,\r\n                        tabTitle: title,\r\n                        tabNumber: count\r\n                    });\r\n                }\r\n                // for (var k in resources) {\r\n                //   var count = (isNaN(data[k]) || isNaN(parseInt(data[k]))) ? 0 : parseInt(data[k]);\r\n                //   total += count;\r\n                //   if (k) {\r\n                //     var title = resources[k].title;\r\n                //     resultList.push({\r\n                //       codeKey: k,\r\n                //       tabTitle: title,\r\n                //       tabNumber: count\r\n                //     });\r\n                //   }\r\n                // }\r\n                callback && callback.call(ctx, null, {\r\n                    total: total,\r\n                    list: resultList\r\n                });\r\n            }, this);\r\n        }, this);\r\n    }\r\n\r\n    /**\r\n     *  拼接统计管道\r\n     * @param resource\r\n     * @param opts\r\n     */\r\n    Service.prototype.getStatisticsAggregate = function(resource, opts) {\r\n            var aggregateObj = {},\r\n                resourceId = resource.id,\r\n                tableName = resource.tableName,\r\n                serviceObj = resource.service;\r\n            opts = opts || {};\r\n            var aggregate = [];\r\n            //行政区划过滤\r\n            var districtMatch = this.getDistrictMatch(opts.districtCode, resource);\r\n            if (districtMatch) {\r\n                aggregate.push(districtMatch);\r\n            }\r\n            if (serviceObj.queryParams) {\r\n                var query = serviceObj.queryParams[tableName].query || {};\r\n                aggregate.push({\r\n                    $match: query\r\n                });\r\n            }\r\n            // 支撑配置计数字段\r\n            if (resource.sumField) {\r\n                var or=[];\r\n                var gte = {};\r\n                gte[\"tag.\" + resource.sumField] = {\r\n                    \"$gte\":0,\r\n                }\r\n                or.push(gte);\r\n                var lte = {};\r\n                lte[\"tag.\" + resource.sumField] = {\r\n                    \"$lte\":0,\r\n                }\r\n                or.push(lte);\r\n                aggregate.push({\r\n                    $match:{\r\n                        \"$or\": or \r\n                    }\r\n                },);\r\n                aggregate.push({\r\n                    $project:{\r\n                        \"type\":\"$_id\",\r\n                        \"num\":\"$tag.\" + resource.sumField,\r\n                    }\r\n                });\r\n                aggregate.push({\r\n                    \"$group\":{\r\n                        \"_id\":null,\r\n                        \"_count\":{\r\n                            \"$sum\":\"$num\"\r\n                        }\r\n                    }\r\n                });\r\n            } else {\r\n                aggregate.push({\r\n                    $count: '_count'\r\n                });\r\n            }\r\n            aggregateObj.aggregate = aggregate;\r\n            aggregateObj.query = {};\r\n            aggregateObj.searchId = resourceId;\r\n            aggregateObj.dataSetId = tableName;\r\n            aggregateObj.queryIndex = 1;\r\n            return aggregateObj;\r\n        }\r\n        /**\r\n         * 查询列表数据\r\n         * @param opts\r\n         * @param opts.resourceKey\r\n         * @param opts.flatTag 是否平铺tag属性\r\n         * @param opts.fields 字段列表（筛选字段）\r\n         * @param [opts.geometry] 几何对象（geojson）\r\n         * @param [opts.keyWord] 关键字\r\n         * @param [opts.districtCode] 行政区划编码,以逗号隔开\r\n         * @param callback\r\n         * @param ctx\r\n         */\r\n    Service.prototype.getMapDataList = function(opts, callback, ctx) {\r\n        var self = this;\r\n        this.getResourceConfig(function(err, resources) {\r\n            if (err == null) {\r\n                var resource = resources[opts.resourceKey];\r\n                var param = {};\r\n                if (resource) {\r\n                    var serviceObj = resource.service;\r\n                    var tableName = resource.tableName;\r\n                    var config = this.getSelectColumn(resource, opts.fields);\r\n                    var fieldProject = config.fieldProject;\r\n                    var query = {};\r\n                    query.$and = [];\r\n                    if (opts.geometry) {\r\n                        var geom = {\r\n                            $geoIntersects: {\r\n                                $geometry: opts.geometry,\r\n                            },\r\n                        };\r\n                        query.$and.push({ geom: geom });\r\n                    }\r\n                    if (serviceObj.queryParams) {\r\n                        var con = serviceObj.queryParams[tableName].query || {};\r\n                        query.$and.push(con);\r\n                    }\r\n                    if (opts.districtCode) {\r\n                        var districtMatch = this.getDistrictMatch(opts.districtCode, resource);\r\n                        var $or = districtMatch.$match;\r\n                        query.$and.push($or);\r\n                    }\r\n                    if (opts.keyWord) {\r\n                        var keywordMatch = this.getSearchMatch(opts.keyWord, resource);\r\n                        query.$and.push(keywordMatch.$match);\r\n                    }\r\n                    if (query.$and.length === 0) {\r\n                        delete query.$and;\r\n                    }\r\n                    param[tableName] = {\r\n                            query: query,\r\n                            select: config.select\r\n                        }\r\n                        // query = {\r\n                        //   $and:[\r\n                        //     {\r\n                        //       name:'1',\r\n                        //     },\r\n                        //     {\r\n                        //       $or:[]\r\n                        //     },\r\n                        //     {\r\n\r\n                    //     }\r\n                    //   ]\r\n                    // }\r\n\r\n                    $.ajax({\r\n                        url: this.opts.serverUrl + '/dataOperate/queryMulti',\r\n                        dataType: 'json',\r\n                        type: 'post',\r\n                        data: {\r\n                            eId: 'safety',\r\n                            data: JSON.stringify(param),\r\n                        },\r\n                        success: function(data) {\r\n                            var res = self.formatResultColumns(data.data[tableName], fieldProject)\r\n                            callback && callback.call(ctx, null, res);\r\n                        },\r\n                        error: function(err) {\r\n                            callback && callback.call(ctx, err);\r\n                        }\r\n                    });\r\n                }\r\n            } else {\r\n                callback.call(ctx, err);\r\n            }\r\n        }, this);\r\n    }\r\n\r\n    Service.prototype.formatResultColumns = function(data, fieldProject) {\r\n        var self = this;\r\n        data.forEach(function(element) {\r\n            element = self.flatObject(element);\r\n            for (var key in element) {\r\n                if (element.hasOwnProperty(key)) {\r\n                    if (fieldProject[key]) {\r\n                        element[fieldProject[key]] = element[key];\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        return data;\r\n    }\r\n    Service.prototype.flatObject = function(element) {\r\n        var tag = element.tag;\r\n        if (tag) {\r\n            for (var key in tag) {\r\n                if (tag.hasOwnProperty(key)) {\r\n                    var value = tag[key];\r\n                    element[key] = value;\r\n                }\r\n            }\r\n            delete element.tag;\r\n        }\r\n        return element;\r\n    }\r\n    Service.prototype.getSelectColumn = function(resource, fields) {\r\n            var fieldMap = resource.fieldMap;\r\n            var fieldProject = {};\r\n            var selectArr = [];\r\n            selectArr.push(\"_id\");\r\n            selectArr.push(\"geom\");\r\n            for (var key in fieldMap) {\r\n                if (fieldMap.hasOwnProperty(key)) {\r\n                    var originField = key;\r\n                    var projectedField = fieldMap[key]\r\n                    if (fields.includes(projectedField)) {\r\n                        fieldProject[originField] = projectedField;\r\n                        selectArr.push(\"tag.\" + originField);\r\n                    }\r\n                }\r\n            }\r\n            var result = {};\r\n            result.select = selectArr.join(\" \");\r\n            result.fieldProject = fieldProject;\r\n            return result;\r\n        }\r\n        /**\r\n         * 查询列表数据\r\n         * @param opts\r\n         * @param opts.resourceKey，多个逗号分隔\r\n         * @param opts.pageSize\r\n         * @param opts.pageIndex\r\n         * @param opts.districtCode 政区过滤编码\r\n         * @param opts.keyword 关键字-预留参数\r\n         * @param opts.flatTag 是否平铺tag属性\r\n         * @param opts.fields 字段列表（筛选字段）\r\n         * @param opts.id 主键筛选\r\n         * @param opts.filter\r\n         * @param callback\r\n         * @param ctx\r\n         */\r\n    Service.prototype.getDataList = function(opts, callback, ctx) {\r\n        if (opts.keyword) {\r\n            var fbsArr = [\"\\\\\", \"$\", \"(\", \")\", \"*\", \"+\", \".\", \"[\", \"]\", \"?\", \"^\", \"{\", \"}\", \"|\"];\r\n            for (var key in fbsArr) {\r\n                if (opts.keyword.indexOf(fbsArr[key]) != -1) {\r\n                    opts.keyword = opts.keyword.replace(fbsArr[key], \"\\\\\" + fbsArr[key]);\r\n                }\r\n            }\r\n        }\r\n        opts.filter = opts.filter || {};\r\n        this.getResourceConfig(function(err, resources) {\r\n            if (err == null) {\r\n                var resourceList = [],\r\n                    resourceKey = opts.resourceKey,\r\n                    resourceKeyList = resourceKey.split(',');\r\n                var aggregateList = [];\r\n                for (var i = 0; i < resourceKeyList.length; i++) {\r\n                    var resource = resources[resourceKeyList[i]];\r\n                    if (resource) {\r\n                        var aggregateObj = this.getAllListAggregate(resource, {\r\n                            pageSize: opts.pageSize,\r\n                            pageIndex: opts.pageIndex,\r\n                            flatTag: opts.flatTag,\r\n                            districtCode: opts.districtCode,\r\n                            keyword: opts.keyword,\r\n                            fields: opts.fields,\r\n                            id: opts.id,\r\n                        });\r\n                        var resourceFilter = opts.filter[resourceKeyList[i]];\r\n                        if (resourceFilter) {\r\n                            if (aggregateObj.query && Object.keys(aggregateObj.query).length >0){\r\n                                aggregateObj.query = {\r\n                                    $and: [\r\n                                        aggregateObj.query,\r\n                                        resourceFilter\r\n                                    ]\r\n                                };\r\n                            } else {\r\n                                aggregateObj.query = resourceFilter;\r\n                            }\r\n                        }\r\n                        aggregateList.push(aggregateObj);\r\n                    }\r\n                }\r\n                this.aggregateMulti(aggregateList, null, function(err, data) {\r\n                    if (err == null) {\r\n                        var resultSet = {};\r\n                        for (var k in data) {\r\n                            try {\r\n                                var itemData = data[k];\r\n                                resultSet[k] = itemData[Object.keys(itemData)[0]];\r\n                            } catch (e) {}\r\n                        }\r\n                        callback.call(ctx, null, resultSet);\r\n                    } else {\r\n                        callback.call(ctx, err);\r\n                    }\r\n                }, this);\r\n\r\n            } else {\r\n                callback.call(ctx, err);\r\n            }\r\n        }, this);\r\n    }\r\n\r\n    /**\r\n     * 拼接查询管道\r\n     * @param resource\r\n     * @param opts\r\n     */\r\n    Service.prototype.getAllListAggregate = function(resource, opts) {\r\n        var aggregateObj = {},\r\n            resourceId = resource.id,\r\n            tableName = resource.tableName,\r\n            serviceObj = resource.service,\r\n            pageSize = opts.pageSize,\r\n            pageIndex = opts.pageIndex,\r\n            flatTag = !!opts.flatTag,\r\n            skipVal = null,\r\n            limitVal = null;\r\n        if (pageSize !== null && pageSize !== '' && pageIndex !== null && pageIndex !== '') {\r\n            pageSize = parseInt(pageSize);\r\n            pageIndex = parseInt(pageIndex);\r\n            skipVal = (pageIndex - 1) * pageSize;\r\n            // limitVal = pageSize * (1 + pageIndex);\r\n            limitVal = pageSize;\r\n        } else {\r\n            //todo 暂时最多查询\r\n            limitVal = 50 * 1000;\r\n        }\r\n        var aggregate = [];\r\n        //灾情信息员\r\n        if (resource.id === 'JC_DISINFOPER※01' ||\r\n            resource.id === 'BAS_bas_school' || resource.id === 'BAS_shelter') {\r\n            aggregate.push({\r\n                $limit: 10000\r\n            });\r\n        }\r\n        //行政区划过滤\r\n        var districtMatch = this.getDistrictMatch(opts.districtCode, resource);\r\n        if (districtMatch) {\r\n            aggregate.push(districtMatch);\r\n        }\r\n        //关键字过滤\r\n        var kwMatch = this.getSearchMatch(opts.keyword, resource);\r\n        if (kwMatch) {\r\n            aggregate.push(kwMatch);\r\n        }\r\n        if (serviceObj.queryParams) {\r\n            var query = serviceObj.queryParams[tableName].query || {};\r\n            aggregate.push({\r\n                $match: query\r\n            });\r\n        }\r\n        if (opts.id) {\r\n            aggregate.push(this.getIdMatch(opts.id, resource.idKey));\r\n        }\r\n        if (resource.sort) {\r\n            aggregate.push({\r\n                $sort: resource.sort\r\n            });\r\n        }\r\n        if (!isNaN(skipVal) && skipVal != null) {\r\n            aggregate.push({\r\n                $skip: skipVal\r\n            });\r\n        }\r\n        if (!isNaN(limitVal) && limitVal != null) {\r\n            aggregate.push({\r\n                $limit: limitVal\r\n            });\r\n        }\r\n        var fieldMap = resource.fieldMap,\r\n            project = {},\r\n            projectSuffix = flatTag ? '' : 'tag.';\r\n        for (var field in fieldMap) {\r\n            if (Object.prototype.toString.call(fieldMap[field]) == '[object Object]') {\r\n                var lookUpObj = fieldMap[field],\r\n                    lookupAlias = field + '_rel';\r\n                var as = lookUpObj.as;\r\n                if (opts.fields) {\r\n                    if (opts.fields.includes(as)) {\r\n                        lookUpObj.as = lookupAlias;\r\n                        aggregate.push({\r\n                            $lookup: lookUpObj\r\n                        });\r\n                        aggregate.push({\r\n                            $unwind: {\r\n                                \"path\": \"$\" + lookupAlias,\r\n                                \"preserveNullAndEmptyArrays\": true\r\n                            }\r\n                        });\r\n                        var _key = as ? as : field\r\n                        project[projectSuffix + _key] = '$' + lookupAlias + '.tag.' + field;\r\n                    }\r\n                } else {\r\n                    lookUpObj.as = lookupAlias;\r\n                    aggregate.push({\r\n                        $lookup: lookUpObj\r\n                    });\r\n                    aggregate.push({\r\n                        $unwind: {\r\n                            \"path\": \"$\" + lookupAlias,\r\n                            \"preserveNullAndEmptyArrays\": true\r\n                        }\r\n                    });\r\n                    var _key = as ? as : field\r\n                    project[projectSuffix + _key] = '$' + lookupAlias + '.tag.' + field;\r\n                }\r\n            } else {\r\n                project[projectSuffix + fieldMap[field]] = '$tag.' + field;\r\n            }\r\n        }\r\n        //对字段进行自定义筛选\r\n        if (opts.fields) {\r\n            for (var key in project) {\r\n                if (project.hasOwnProperty(key)) {\r\n                    if (!opts.fields.includes(key)) {\r\n                        delete project[key];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        project['geom'] = '$geom';\r\n        aggregate.push({\r\n            $project: project\r\n        });\r\n\r\n        aggregateObj.aggregate = aggregate;\r\n        aggregateObj.query = {};\r\n        aggregateObj.searchId = resourceId;\r\n        aggregateObj.dataSetId = tableName;\r\n        aggregateObj.queryIndex = 1;\r\n        return aggregateObj;\r\n    }\r\n\r\n    /**\r\n     * 拼接行政区划条件\r\n     * @param districtCode\r\n     * @param resource\r\n     * @param resource.districtField 行政区划字段名\r\n     * @param resource.districtKey 可选，默认为空\r\n     */\r\n    Service.prototype.getDistrictMatch = function(districtCode, resource) {\r\n        var match = null;\r\n        if (districtCode && districtCode !== '000000' && resource.districtField) {\r\n            var districtCodes = districtCode.split(','),\r\n                districtField = resource.districtField;\r\n            var or = [],\r\n                districtKey = null;\r\n            if (resource.districtKey) {\r\n                districtKey = resource.districtKey;\r\n            } else {\r\n                districtKey = 'tag.' + districtField;\r\n            }\r\n            for (var i = 0; i < districtCodes.length; i++) {\r\n                var districtCode = districtCodes[i];\r\n                if (districtCode) {\r\n                    var eachFilter = {};\r\n                    eachFilter[districtKey] = {\r\n                        $regex: getDistrictRegex(districtCode)\r\n                    };\r\n                    or.push(eachFilter);\r\n                }\r\n            }\r\n            match = {\r\n                $match: {\r\n                    $or: or\r\n                }\r\n            }\r\n        } else {}\r\n        return match;\r\n\r\n        function getDistrictRegex(code) {\r\n            var c = code.substr(0, 6);\r\n            if ('000000' == c) { //全国不过滤\r\n                c = '.*';\r\n            } else if (/^\\d{2}0000$/.test(c)) {\r\n                c = c.substr(0, 2) + '.*';\r\n            } else if (/^\\d{4}00$/.test(c)) {\r\n                c = c.substr(0, 4) + '.*';\r\n            } else if (/^\\d{6}$/.test(c)) {\r\n                c = c.substr(0, 6) + '.*';\r\n            }\r\n            return '^' + c + '$';\r\n        }\r\n    }\r\n\r\n\r\n    /**\r\n     * 根据政区等获取数据id--暂时用于物资/储备库、战勤基地/装备的过滤\r\n     * @param opts\r\n     * @param opts.districtCode\r\n     * @param opts.tables\r\n     * @param opts.tables[n].tableName\r\n     * @param opts.tables[n].districtField 行政区划字段名\r\n     * @param callback\r\n     * @param ctx\r\n     * @private\r\n     */\r\n    Service.prototype.getRecordIdListByFilter = function(opts, callback, ctx) {\r\n        opts = opts || {};\r\n        var tables = opts.tables || [],\r\n            tableCount = tables.length,\r\n            districtCode = opts.districtCode;\r\n        var aggregateList = [];\r\n        for (var i = 0; i < tableCount; i++) {\r\n            var tableObj = tables[i];\r\n            var aggregateObj = {},\r\n                aggregate = [];\r\n            var districtMatch = this.getDistrictMatch(districtCode, tableObj);\r\n            if (districtMatch) {\r\n                aggregate.push(districtMatch);\r\n            }\r\n            aggregate.push({\r\n                $project: {\r\n                    \"_id\": \"$_id\"\r\n                }\r\n            });\r\n            aggregateObj.aggregate = aggregate;\r\n            aggregateObj.query = {};\r\n            aggregateObj.searchId = i;\r\n            aggregateObj.dataSetId = tableObj.tableName;\r\n            aggregateList.push(aggregateObj);\r\n        }\r\n        if (aggregateList.length == 0) {\r\n            callback.call(ctx, null, []);\r\n        } else {\r\n            this.aggregateMulti(aggregateList, null, function(err, data) {\r\n                var resultList = [];\r\n                for (var i = 0; i < tableCount; i++) {\r\n                    var itemResult = data[i] || {},\r\n                        itemList = itemResult[Object.keys(itemResult)[0]];\r\n                    var idList = [];\r\n                    for (var j = 0; j < itemList.length; j++) {\r\n                        idList.push(itemList[j]._id);\r\n                    }\r\n                    resultList.push({\r\n                        tableName: tables[i].tableName,\r\n                        idList: idList\r\n                    });\r\n                }\r\n                callback.call(ctx, null, resultList);\r\n            }, this);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 拼接关键字条件--预留方法\r\n     * @param kw\r\n     * @param resource\r\n     */\r\n    Service.prototype.getSearchMatch = function(kw, resource) {\r\n            if (kw) {\r\n                var query = {};\r\n                var filter = {};\r\n                filter['$regex'] = \"^.*\" + kw + \".*$\";\r\n                query[resource.keyWordFields] = filter;\r\n                var kwquery = {\r\n                    $match: query\r\n                };\r\n                return kwquery;\r\n            } else {\r\n                return null;\r\n            }\r\n        }\r\n        /**\r\n         * 主键（id）筛选\r\n         * @param id\r\n         * @param [idField]\r\n         */\r\n    Service.prototype.getIdMatch = function(id, idField) {\r\n            if (!idField) {\r\n                idField = '_id';\r\n            }\r\n            if (id) {\r\n                var query = {};\r\n                var filter = {};\r\n                filter['$regex'] = \"^\" + id + \"$\";\r\n                query[idField] = filter;\r\n                var idquery = {\r\n                    $match: query\r\n                };\r\n                return idquery;\r\n            } else {\r\n                return null;\r\n            }\r\n        }\r\n        /**\r\n         * 多个管道执行方法-公共\r\n         * @param aggregateList 管道列表\r\n         * @param cb\r\n         * @param ctx\r\n         * @returns {*}\r\n         */\r\n    Service.prototype.aggregateMulti = function(aggregateList, options, cb, ctx) {\r\n            var opts = {},\r\n                data = {};\r\n            var searchid = null;\r\n            var datasetid = null;\r\n            if (aggregateList.length === 1) {\r\n                var agregate = aggregateList[0];\r\n                searchid = agregate.searchId;\r\n                datasetid = agregate.dataSetId;\r\n            }\r\n            if (options) {\r\n                aggregateList.forEach(function(element) {\r\n                    Object.assign(element, options);\r\n                });\r\n                // Object.assign(data, options);\r\n            }\r\n            if (options && options.near) {\r\n                opts.url = this.opts.serverUrl + '/dataStatics/aggregatePageNear';\r\n            } else {\r\n                opts.url = this.opts.serverUrl + '/dataStatics/aggregateMulti';\r\n            }\r\n\r\n            opts.dataType = 'json';\r\n            opts.type = 'POST';\r\n            data.data = JSON.stringify(aggregateList);\r\n            data.eId = 'safety';\r\n            opts.data = data;\r\n            opts.success = function(d) {\r\n                var data = d.data;\r\n                let result = {};\r\n                if (Array.isArray(data) && searchid && datasetid) {\r\n                    result[searchid] = {};\r\n                    result[searchid][datasetid] = data;\r\n                } else {\r\n                    result = data;\r\n                }\r\n                cb && cb.call(ctx, null, result);\r\n            }\r\n            opts.error = function(err) {\r\n                cb && cb.call(ctx, new Error(err));\r\n            }\r\n            return jQuery.ajax(opts);\r\n        }\r\n        /**\r\n         * 多个管道统计\r\n         * @param aggregateList\r\n         * @param cb\r\n         * @param ctx\r\n         */\r\n    Service.prototype.statisticsMulti = function(aggregateList, cb, ctx) {\r\n        this.aggregateMulti(aggregateList, null, function(err, data) {\r\n            for (var k in data) {\r\n                var item = data[k],\r\n                    itemData = item[Object.keys(item)[0]];\r\n                if (itemData.length == 0) {\r\n                    data[k] = 0;\r\n                } else {\r\n                    data[k] = itemData[0]._count;\r\n                }\r\n            }\r\n            cb && cb.call(ctx, null, data);\r\n        }, this);\r\n    }\r\n\r\n\r\n    /**\r\n     * 周边列表查询\r\n     * @param opts\r\n     * @param opts.eventType 事件类型\r\n     * @param opts.resourceKeys 资源key值\r\n     * @param opts.pageSize\r\n     * @param opts.pageIndex\r\n     * @param opts.districtCode\r\n     * @param opts.point\r\n     * @param opts.buffer\r\n     * @param opts.config\r\n     * @param opts.config.limit {Array/Number} 可选 返回记录的限制数 数组或者数字，数组形式对应救援力量的[就近数，增援数]\r\n     * @param opts.config.radius {Number} 可选 查询半径\r\n     * @param opts.config.idList {Array} 可选 id数组，用于过滤\r\n     * @param opts.flatTag\r\n     * @param callback\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getNearbyList = function(opts, callback, ctx) {\r\n        var eventType = opts.eventType,\r\n            config = opts.config || {};\r\n        this.getFilterResources(eventType, opts.resourceKeys, function(err, resources) {\r\n            if (err == null) {\r\n                var aggregateList = [];\r\n                for (var resourceKey in resources) {\r\n                    var resourceObj = resources[resourceKey],\r\n                        thisConfig = config[resourceKey] || {};\r\n                    if (resourceObj.id.indexOf('v_equipment') != -1 || !opts.point) {\r\n                        var aggregateObj = this.getAllListAggregate(resourceObj, {\r\n                            pageSize: opts.pageSize,\r\n                            pageIndex: opts.pageIndex,\r\n                            flatTag: opts.flatTag,\r\n                            districtCode: opts.districtCode,\r\n                            keyword: opts.Keyword\r\n                        });\r\n                    } else {\r\n                        var aggregateObj = this.getNearbyAggregate(resourceObj, {\r\n                            pageSize: opts.pageSize,\r\n                            pageIndex: opts.pageIndex,\r\n                            limit: thisConfig.limit || resourceObj.limit,\r\n                            buffer: opts.buffer,\r\n                            radius: thisConfig.radius,\r\n                            point: opts.point,\r\n                            flatTag: !!opts.flatTag,\r\n                            Keyword: opts.Keyword,\r\n                            districtCode: opts.districtCode\r\n                        });\r\n                    }\r\n                    aggregateList.push(aggregateObj);\r\n                }\r\n                var options = {};\r\n                if (opts.pageSize && opts.pageIndex) {\r\n                    options.pageIndex = opts.pageIndex;\r\n                    options.pageSize = opts.pageSize;\r\n                    options.paging = true;\r\n                }\r\n                if (opts.point) {\r\n                    options.near = JSON.stringify(opts.point);\r\n                    options.distanceField = 'dis';\r\n                }\r\n                this.aggregateMulti(aggregateList, options, function(err, data) {\r\n                    if (err == null) {\r\n                        var resultSet = {},\r\n                            resultArr = [],\r\n                            total = 0;\r\n                        for (var rk in data) {\r\n                            var itemObj = data[rk],\r\n                                itemList = itemObj[Object.keys(itemObj)[0]] || [],\r\n                                itemConfig = config[rk] || {},\r\n                                limit = itemConfig.limit || resourceObj.limit;\r\n                            total += itemList.length;\r\n                            // var listArr = [];\r\n                            // listArr.push(itemList.slice(0, limit[0]));\r\n                            // listArr.push(itemList.slice(limit[0]));\r\n                            var resultObj = {};\r\n                            resultObj.data = itemList;\r\n                            resultObj.codeKey = rk;\r\n                            resultObj.tabTitle = resources[rk].title;\r\n                            resultObj.limit = limit;\r\n                            resultObj.radius = itemConfig.radius;\r\n                            resultObj.tabNumber = itemList.length;\r\n                            resultArr.push(resultObj);\r\n                        }\r\n                        resultSet.list = resultArr;\r\n                        resultSet.total = total;\r\n                        callback.call(ctx, null, resultSet);\r\n                    } else {\r\n                        callback.call(ctx, err);\r\n                    }\r\n\r\n                }, this);\r\n            } else {\r\n                callback.call(ctx, err);\r\n            }\r\n        }, this);\r\n    }\r\n\r\n\r\n    /**\r\n     * 拼接周边查询管道\r\n     * @param resource\r\n     * @param opts\r\n     * @param opts.buffer 缓冲区\r\n     * @param opts.point 中心点\r\n     * @param opts.radius 缓冲半径\r\n     * @param opts.limit {Array[2]}\r\n     * @param opts.idList Id过滤数组\r\n     * @param opts.flatTag\r\n     */\r\n    Service.prototype.getNearbyAggregate = function(resource, opts) {\r\n        var aggregateObj = {},\r\n            resourceId = resource.id,\r\n            tableName = resource.tableName,\r\n            flatTag = !!opts.flatTag,\r\n            serviceObj = resource.service;\r\n        pageSize = opts.pageSize,\r\n            pageIndex = opts.pageIndex,\r\n            skipVal = null,\r\n            limitVal = null;\r\n\r\n        if (pageSize !== null && pageSize !== '' && pageIndex !== null && pageIndex !== '') {\r\n            pageSize = parseInt(pageSize);\r\n            pageIndex = parseInt(pageIndex);\r\n            skipVal = (pageIndex - 1) * pageSize;\r\n            // limitVal = pageSize * (1 + pageIndex);\r\n            limitVal = pageSize;\r\n        } else {\r\n            //todo 暂时最多查询\r\n            limitVal = 50 * 1000;\r\n        }\r\n        var aggregate = [];\r\n        //geonear\r\n        var geoNear = {};\r\n        geoNear.limit = 1000 * 1000;\r\n        geoNear.maxDistance = opts.radius ? parseFloat(opts.radius) : 5000 * 1000;\r\n        geoNear.spherical = true;\r\n        geoNear.near = {\r\n            type: 'Point',\r\n            coordinates: opts.point\r\n        };\r\n        geoNear.includeLocs = \"geom\";\r\n        geoNear.distanceField = \"dis\";\r\n        // if(opts.point){\r\n        //   aggregate.push({\r\n        //     $geoNear: geoNear\r\n        //   });\r\n        // }\r\n        //geometry 过滤\r\n        if (opts.buffer) {\r\n            aggregate.push({\r\n                $match: {\r\n                    \"geom\": {\r\n                        \"$geoIntersects\": {\r\n                            \"$geometry\": opts.buffer\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        if (opts.Keyword) { //关键字过滤\r\n            var query = {};\r\n            var filter = {};\r\n            filter['$regex'] = \"^.*\" + opts.Keyword + \".*$\";\r\n            query[resource.keyWordFields] = filter;\r\n            aggregate.push({\r\n                $match: query\r\n            });\r\n        }\r\n        //行政区划过滤\r\n        var districtMatch = this.getDistrictMatch(opts.districtCode, resource);\r\n        if (districtMatch) {\r\n            aggregate.push(districtMatch);\r\n        }\r\n        if (serviceObj.queryParams) {\r\n            var query = serviceObj.queryParams[tableName].query || {};\r\n            aggregate.push({\r\n                $match: query\r\n            });\r\n        }\r\n        // if (!isNaN(skipVal) && skipVal != null) {\r\n        //   aggregate.push({\r\n        //     $skip: skipVal\r\n        //   });\r\n        // }\r\n        // if (!isNaN(limitVal) && limitVal != null) {\r\n        //   aggregate.push({\r\n        //     $limit: limitVal\r\n        //   });\r\n        // }     \r\n        var project = this.parseProject(aggregate, resource.fieldMap, flatTag);\r\n        project['geom'] = '$geom';\r\n        project['dis'] = '$dis';\r\n        aggregate.push({\r\n            $project: project\r\n        });\r\n        // if (Object.prototype.toString.call(opts.limit) == '[object Array]' && opts.limit.length == 2) {\r\n        //   aggregate.push({\r\n        //     $limit: opts.limit[0] + opts.limit[1]\r\n        //   });\r\n        // } else if (!isNaN(opts.limit)) {\r\n        //   aggregate.push({\r\n        //     $limit: parseInt(opts.limit)\r\n        //   });\r\n        // }    \r\n\r\n        aggregateObj.aggregate = aggregate;\r\n        aggregateObj.query = {};\r\n        aggregateObj.searchId = resourceId;\r\n        aggregateObj.dataSetId = tableName;\r\n        aggregateObj.queryIndex = 1;\r\n        return aggregateObj;\r\n    }\r\n\r\n    /**\r\n     * 过滤获取列表\r\n     * @param queryResources\r\n     * @param queryResources[key].idList {Array}\r\n     * @param queryResources[key].districtCode 行政区划编码，多个逗号分隔\r\n     * @param callback\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getListByFilter = function(queryResources, callback, ctx) {\r\n        var resourceKeys = Object.keys(queryResources || {});\r\n        this.getFilterResources(null, resourceKeys, function(err, resources) {\r\n            var aggregateList = [];\r\n            for (var rk in queryResources) {\r\n                var resource = resources[rk],\r\n                    qResource = queryResources[rk];\r\n                var aggregateObj = this.getListByFilterAggregate(resource, {\r\n                    idList: qResource.idList,\r\n                    flatTag: false,\r\n                    districtCode: qResource.districtCode\r\n                });\r\n                aggregateList.push(aggregateObj);\r\n            }\r\n            this.aggregateMulti(aggregateList, null, function(err, resultSet) {\r\n                var resultList = [];\r\n                for (var resultKey in resultSet) {\r\n                    var resultObj = resultSet[resultKey] || {},\r\n                        tempObj = {};\r\n                    tempObj.codeKey = resultKey;\r\n                    tempObj.data = resultObj[Object.keys(resultObj)[0]];\r\n                    tempObj.tabTitle = resources[resultKey].title;\r\n                    tempObj.tabNumber = tempObj.data.length;\r\n                    resultList.push(tempObj);\r\n                }\r\n                callback.call(ctx, null, resultList);\r\n            }, this);\r\n        }, this);\r\n    }\r\n\r\n    /**\r\n     *\r\n     * @param resource\r\n     * @param opts\r\n     * @param opts.idList\r\n     * @param opts.flatTag\r\n     * @returns {{}}\r\n     */\r\n    Service.prototype.getListByFilterAggregate = function(resource, opts) {\r\n        var aggregateObj = {},\r\n            resourceId = resource.id,\r\n            tableName = resource.tableName,\r\n            flatTag = !!opts.flatTag,\r\n            serviceObj = resource.service;\r\n        var aggregate = [];\r\n        //传递的id\r\n        if (opts.idList && opts.idList.length > 0) {\r\n            aggregate.push({\r\n                $match: {\r\n                    _id: {\r\n                        $in: opts.idList\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        //行政区划过滤\r\n        var districtMatch = this.getDistrictMatch(opts.districtCode, resource);\r\n        if (districtMatch) {\r\n            aggregate.push(districtMatch);\r\n        }\r\n        if (serviceObj.queryParams) {\r\n            var query = serviceObj.queryParams[tableName].query || {};\r\n            aggregate.push({\r\n                $match: query\r\n            });\r\n        }\r\n        var project = this.parseProject(aggregate, resource.fieldMap, flatTag);\r\n        project['geom'] = '$geom';\r\n        project['dis'] = '$dis';\r\n        aggregate.push({\r\n            $project: project\r\n        });\r\n        aggregateObj.aggregate = aggregate;\r\n        aggregateObj.query = {};\r\n        aggregateObj.searchId = resourceId;\r\n        aggregateObj.dataSetId = tableName;\r\n        return aggregateObj;\r\n    }\r\n\r\n    /**\r\n     *  获取指定事件类型关联的资源\r\n     * @param eventType 事件类型\r\n     * @param resourceKeys {Array} 匹配的资源key\r\n     * @param callback\r\n     * @param ctx\r\n     * @private\r\n     */\r\n    Service.prototype.getFilterResources = function(eventType, resourceKeys, callback, ctx) {\r\n        // this.getResourcesByEventType(eventType, function (err, resources) {\r\n        //   var resourceKeyMatches = resourceKeys,\r\n        //     matchLength = resourceKeyMatches.length,\r\n        //     resourceMap = {};\r\n        //   for (var resourceKey in resources) {\r\n        //     var flag = false;\r\n        //     for (var j = 0; j < matchLength; j++) {\r\n        //       if (resourceKey.indexOf(resourceKeyMatches[j]) == 0) {\r\n        //         flag = true;\r\n        //         break;\r\n        //       }\r\n        //     }\r\n        //     if (flag) {\r\n        //       resourceMap[resourceKey] = resources[resourceKey];\r\n        //     }\r\n        //   }\r\n        //   callback.call(ctx, null, resourceMap);\r\n        // }, this);\r\n        this.getResourceConfig(function(err, resources) {\r\n            if (err == null) {\r\n                var resourceNodeMap = {};\r\n                for (var i = 0; i < resourceKeys.length; i++) {\r\n                    var resourceTag = resourceKeys[i];\r\n                    if (resourceTag) {\r\n                        var resource = resources[resourceTag];\r\n\r\n                        resourceNodeMap[resourceTag] = resource;\r\n                    }\r\n                }\r\n                callback.call(ctx, null, resourceNodeMap);\r\n            } else {\r\n                callback.call(ctx, err);\r\n            }\r\n        }, this);\r\n    }\r\n\r\n    /**\r\n     * 拼接project\r\n     * @param aggregate\r\n     * @param fieldMap\r\n     * @param flatTag\r\n     * @returns {{}}\r\n     */\r\n    Service.prototype.parseProject = function(aggregate, fieldMap, flatTag) {\r\n        var project = {},\r\n            projectSuffix = flatTag ? '' : 'tag.';\r\n        for (var field in fieldMap) {\r\n            if (Object.prototype.toString.call(fieldMap[field]) == '[object Object]') {\r\n\r\n                var lookUpObj = fieldMap[field],\r\n                    lookupAlias = field + '_rel';\r\n\r\n                var as = lookUpObj.as;\r\n                lookUpObj.as = lookupAlias;\r\n                aggregate.push({\r\n                    $lookup: lookUpObj\r\n                });\r\n                aggregate.push({\r\n                    $unwind: {\r\n                        \"path\": \"$\" + lookupAlias,\r\n                        \"preserveNullAndEmptyArrays\": true\r\n                    }\r\n                });\r\n                var _key = as ? as : field\r\n                project[projectSuffix + _key] = '$' + lookupAlias + '.tag.' + field;\r\n            } else {\r\n                project[projectSuffix + fieldMap[field]] = '$tag.' + field;\r\n            }\r\n        }\r\n        return project;\r\n    }\r\n\r\n    window.EMapServerV2 = window.EMapServerV2 || {};\r\n    window.EMapServerV2.CommonService = Service;\r\n})(window);","(function (window) {\r\n    var G = window['G'] || {};\r\n    window['G'] = G;\r\n    G.import = G.import || {};\r\n    //\r\n    var util = {};\r\n    util.x_PI = 3.14159265358979324 * 3000.0 / 180.0;\r\n    util.PI = 3.1415926535897932384626;\r\n    util.a = 6378245.0;\r\n    util.ee = 0.00669342162296594323;\r\n\r\n    /**\r\n     * 百度坐标系 (BD-09) 与 火星坐标系 (GCJ-02)的转换\r\n     * 即 百度 转 谷歌、高德\r\n     * @param bd_lon\r\n     * @param bd_lat\r\n     */\r\n    util.bd09togcj02 = function (bd_lonlat) {\r\n        var bd_lon = +bd_lonlat.split(\",\")[0];\r\n        var bd_lat = +bd_lonlat.split(\",\")[1];\r\n        var x = bd_lon - 0.0065;\r\n        var y = bd_lat - 0.006;\r\n        var z = Math.sqrt(x * x + y * y) - 0.00002 * Math.sin(y * util.x_PI);\r\n        var theta = Math.atan2(y, x) - 0.000003 * Math.cos(x * util.x_PI);\r\n        var gg_lng = z * Math.cos(theta);\r\n        var gg_lat = z * Math.sin(theta);\r\n        var gcj02_lonlat = gg_lng + ',' + gg_lat;\r\n        return gcj02_lonlat;\r\n    };\r\n\r\n    /**\r\n     * 火星坐标系 (GCJ-02) 与百度坐标系 (BD-09) 的转换\r\n     * 即谷歌、高德 转 百度\r\n     * @param lng\r\n     * @param lat\r\n     */\r\n    util.gcj02tobd09 = function (gcj_lnglat) {\r\n        var lat = +gcj_lnglat.split(\",\")[0];\r\n        var lng = +gcj_lnglat.split(\",\")[1];\r\n        var z = Math.sqrt(lng * lng + lat * lat) + 0.00002 * Math.sin(lat * util.x_PI);\r\n        var theta = Math.atan2(lat, lng) + 0.000003 * Math.cos(lng * util.x_PI);\r\n        var bd_lng = z * Math.cos(theta) + 0.0065;\r\n        var bd_lat = z * Math.sin(theta) + 0.006;\r\n        return bd_lng + ',' + bd_lat;\r\n    };\r\n\r\n    /**\r\n     * WGS84转GCj02\r\n     * @param lng\r\n     * @param lat\r\n     */\r\n    util.wgs84togcj02 = function (wgs_lnglat) {\r\n        var lat = +wgs_lnglat.split(\",\")[0];\r\n        var lng = +wgs_lnglat.split(\",\")[1];\r\n        if (util.out_of_china(lng, lat)) {\r\n            //return [lng, lat];\r\n            console.log(\"超出国界范围!\");\r\n            return lng + ',' + lat;\r\n        } else {\r\n            var dlat = util.transformlat(lng - 105.0, lat - 35.0);\r\n            var dlng = util.transformlng(lng - 105.0, lat - 35.0);\r\n            var radlat = lat / 180.0 * util.PI;\r\n            var magic = Math.sin(radlat);\r\n            magic = 1 - util.ee * magic * magic;\r\n            var sqrtmagic = Math.sqrt(magic);\r\n            dlat = (dlat * 180.0) / ((util.a * (1 - util.ee)) / (magic * sqrtmagic) * util.PI);\r\n            dlng = (dlng * 180.0) / (util.a / sqrtmagic * Math.cos(radlat) * util.PI);\r\n            var mglat = lat + dlat;\r\n            var mglng = lng + dlng;\r\n            return mglng + ',' + mglat;\r\n        }\r\n    };\r\n\r\n    /**\r\n     * GCJ02 转换为 WGS84\r\n     * @param lng\r\n     * @param lat\r\n     */\r\n    util.gcj02towgs84 = function (gcj_lonlat) {\r\n        var lng = +gcj_lonlat.split(\",\")[0];\r\n        var lat = +gcj_lonlat.split(\",\")[1];\r\n        if (util.out_of_china(lng, lat)) {\r\n            //return [lng, lat];\r\n            console.log(\"超出国界范围!\");\r\n            return lng + ',' + lat;\r\n        } else {\r\n            var dlat = util.transformlat(lng - 105.0, lat - 35.0);\r\n            var dlng = util.transformlng(lng - 105.0, lat - 35.0);\r\n            var radlat = lat / 180.0 * util.PI;\r\n            var magic = Math.sin(radlat);\r\n            magic = 1 - util.ee * magic * magic;\r\n            var sqrtmagic = Math.sqrt(magic);\r\n            dlat = (dlat * 180.0) / ((util.a * (1 - util.ee)) / (magic * sqrtmagic) * util.PI);\r\n            dlng = (dlng * 180.0) / (util.a / sqrtmagic * Math.cos(radlat) * util.PI);\r\n            var mglat = lat + dlat;\r\n            var mglng = lng + dlng;\r\n            var wgslng = lng * 2 - mglng;\r\n            var wgslat = lat * 2 - mglat;\r\n            return wgslng + ',' + wgslat;\r\n        }\r\n    };\r\n\r\n    util.transformlat = function (lng, lat) {\r\n        var lat = +lat;\r\n        var lng = +lng;\r\n        var ret = -100.0 + 2.0 * lng + 3.0 * lat + 0.2 * lat * lat + 0.1 * lng * lat + 0.2 * Math.sqrt(Math.abs(lng));\r\n        ret += (20.0 * Math.sin(6.0 * lng * util.PI) + 20.0 * Math.sin(2.0 * lng * util.PI)) * 2.0 / 3.0;\r\n        ret += (20.0 * Math.sin(lat * util.PI) + 40.0 * Math.sin(lat / 3.0 * util.PI)) * 2.0 / 3.0;\r\n        ret += (160.0 * Math.sin(lat / 12.0 * util.PI) + 320 * Math.sin(lat * util.PI / 30.0)) * 2.0 / 3.0;\r\n        return ret\r\n    };\r\n\r\n    util.transformlng = function (lng, lat) {\r\n        var lat = +lat;\r\n        var lng = +lng;\r\n        var ret = 300.0 + lng + 2.0 * lat + 0.1 * lng * lng + 0.1 * lng * lat + 0.1 * Math.sqrt(Math.abs(lng));\r\n        ret += (20.0 * Math.sin(6.0 * lng * util.PI) + 20.0 * Math.sin(2.0 * lng * util.PI)) * 2.0 / 3.0;\r\n        ret += (20.0 * Math.sin(lng * util.PI) + 40.0 * Math.sin(lng / 3.0 * util.PI)) * 2.0 / 3.0;\r\n        ret += (150.0 * Math.sin(lng / 12.0 * util.PI) + 300.0 * Math.sin(lng / 30.0 * util.PI)) * 2.0 / 3.0;\r\n        return ret\r\n    };\r\n\r\n    /**\r\n     * 判断是否在国内，不在国内则不做偏移\r\n     * @param lng\r\n     * @param lat\r\n     * @returns {boolean}\r\n     */\r\n    util.out_of_china = function (lng, lat) {\r\n        var lat = +lat;\r\n        var lng = +lng;\r\n        // 纬度3.86~53.55,经度73.66~135.05\r\n        return !(lng > 73.66 && lng < 135.05 && lat > 3.86 && lat < 53.55);\r\n    };\r\n\r\n    window.EMapServerV2 = window.EMapServerV2 || {};\r\n    // 参考\r\n    window.EMapServerV2.CoordTransformUtil = util;\r\n})(window);  ","(function (window) {\r\n    var Service = function (options) {\r\n        this.opts = options;\r\n    };\r\n    /**\r\n     * 查询队站详情-消防\r\n     * @param id\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getFireTeamDetail = function (id, cb, ctx) {\r\n        var aggregate = [\r\n            {\r\n                $match: {\r\n                    _id: id\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    //字典表需要加上user_safety_前缀；\r\n                    \"from\": \"user_safety_CODE_BAS_DISTRICT\",\r\n                    //主表里的关联字段\r\n                    \"localField\": \"tag.RESCOUNTY\",\r\n                    //字典表的关联字段\r\n                    \"foreignField\": \"tag.DISTRICTCODE\",\r\n                    //结果信息存放属性\r\n                    \"as\": \"district\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    //字典表需要加上user_safety_前缀；\r\n                    \"from\": \"user_safety_RESOURCE_CATALOG\",\r\n                    //主表里的关联字段\r\n                    \"localField\": \"tag.TEAMSTATYPECODE\",\r\n                    //字典表的关联字段\r\n                    \"foreignField\": \"tag.NODEID\",\r\n                    //结果信息存放属性\r\n                    \"as\": \"teamstatype\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    //字典表需要加上user_safety_前缀；\r\n                    \"from\": \"user_safety_JC_FIRETEAMPERSON\",\r\n                    //主表里的关联字段\r\n                    \"localField\": \"_id\",\r\n                    //字典表的关联字段\r\n                    \"foreignField\": \"tag.TEAMSTAID\",\r\n                    //结果信息存放属性\r\n                    \"as\": \"person\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    //字典表需要加上user_safety_前缀；\r\n                    \"from\": \"user_safety_JC_EQUIPMENT\",\r\n                    //主表里的关联字段\r\n                    \"localField\": \"_id\",\r\n                    //字典表的关联字段\r\n                    \"foreignField\": \"tag.TEAMSTAID\",\r\n                    //结果信息存放属性\r\n                    \"as\": \"equipments\"\r\n                }\r\n            },\r\n            {\r\n                //展开数组\r\n                \"$unwind\": {\r\n                    path: \"$district\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                //展开数组\r\n                \"$unwind\": {\r\n                    path: \"$teamstatype\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                $project: {\r\n                    \"district\": \"$district\",\r\n                    \"teamstatype\": \"$teamstatype\",\r\n                    \"persons\": \"$person\",\r\n                    \"equipments\": \"$equipments\",\r\n                    \"tag\": \"$tag\"\r\n                }\r\n            }\r\n        ];\r\n        var aggregateObj = {};\r\n        aggregateObj.aggregate = aggregate;\r\n        aggregateObj.query = {};\r\n        aggregateObj.searchId = \"query\";\r\n        aggregateObj.dataSetId = \"JYXX_TEA_RESCUE\";\r\n        aggregateObj.queryIndex = 1;\r\n        this.aggregateMulti([aggregateObj], function (err, data) {\r\n            var obj = data.query[Object.keys(data.query)[0]][0];\r\n            var resultSet = {};\r\n            resultSet[\"result\"] = obj;\r\n            cb.call(ctx, resultSet);\r\n        }, this);\r\n    };\r\n    /**\r\n     * 查询救援队详情\r\n     * @param id\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getRescueTeamDetail = function (id, cb, ctx) {\r\n        var aggregate = [\r\n            {\r\n                $match: {\r\n                    _id: id\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    //字典表需要加上user_safety_前缀；\r\n                    \"from\": \"user_safety_CODE_BAS_DISTRICT\",\r\n                    //主表里的关联字段\r\n                    \"localField\": \"tag.RESCOUNTY\",\r\n                    //字典表的关联字段\r\n                    \"foreignField\": \"tag.DISTRICTCODE\",\r\n                    //结果信息存放属性\r\n                    \"as\": \"district\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    //字典表需要加上user_safety_前缀；\r\n                    \"from\": \"user_safety_EQUIP_RESCUETYPE\",\r\n                    //主表里的关联字段\r\n                    \"localField\": \"tag.RESCUETYPECODE\",\r\n                    //字典表的关联字段\r\n                    \"foreignField\": \"tag.RESCUETYPECODE\",\r\n                    //结果信息存放属性\r\n                    \"as\": \"teamstatype\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    //字典表需要加上user_safety_前缀；\r\n                    \"from\": \"user_safety_V_EQUIPMENT\",\r\n                    //主表里的关联字段\r\n                    \"localField\": \"_id\",\r\n                    //字典表的关联字段\r\n                    \"foreignField\": \"tag.RESCUEID\",\r\n                    //结果信息存放属性\r\n                    \"as\": \"equipments\"\r\n                }\r\n            },\r\n            {\r\n                //展开数组\r\n                \"$unwind\": {\r\n                    path: \"$district\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                //展开数组\r\n                \"$unwind\": {\r\n                    path: \"$teamstatype\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                $project: {\r\n                    \"district\": \"$district\",\r\n                    \"teamstatype\": \"$teamstatype\",\r\n                    \"equipments\": \"$equipments\",\r\n                    \"tag\": \"$tag\"\r\n                }\r\n            }\r\n        ];\r\n        var aggregateObj = {};\r\n        aggregateObj.aggregate = aggregate;\r\n        aggregateObj.query = {};\r\n        aggregateObj.searchId = \"query\";\r\n        aggregateObj.dataSetId = \"JYXX_TEA_RESCUE\";\r\n        aggregateObj.queryIndex = 1;\r\n        this.aggregateMulti([aggregateObj], function (err, data) {\r\n            var obj = data.query[Object.keys(data.query)[0]][0];\r\n            var resultSet = {};\r\n            resultSet[\"result\"] = obj;\r\n            cb.call(ctx, resultSet);\r\n        }, this);\r\n    };\r\n    /**\r\n     * 查询物资储备库\r\n     * @param id\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getReposityDetail = function (id, cb, ctx) {\r\n        var aggregate = [\r\n            {\r\n                $match: {\r\n                    _id: id\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    //字典表需要加上user_safety_前缀；\r\n                    \"from\": \"user_safety_JC_MATERIAL_INFO\",\r\n                    //主表里的关联字段\r\n                    \"localField\": \"_id\",\r\n                    //字典表的关联字段\r\n                    \"foreignField\": \"tag.REPERTORYID\",\r\n                    //结果信息存放属性\r\n                    \"as\": \"materials\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    //字典表需要加上user_safety_前缀；\r\n                    \"from\": \"user_safety_CODE_BAS_DISTRICT\",\r\n                    //主表里的关联字段\r\n                    \"localField\": \"tag.DISTRICTCODE\",\r\n                    //字典表的关联字段\r\n                    \"foreignField\": \"tag.DISTRICTCODE\",\r\n                    //结果信息存放属性\r\n                    \"as\": \"district\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    //字典表需要加上user_safety_前缀；\r\n                    \"from\": \"user_safety_CODE_REP_LEVEL\",\r\n                    //主表里的关联字段\r\n                    \"localField\": \"tag.LEVELCODE\",\r\n                    //字典表的关联字段\r\n                    \"foreignField\": \"tag.LEVELCODE\",\r\n                    //结果信息存放属性\r\n                    \"as\": \"level\"\r\n                }\r\n            },\r\n            {\r\n                //展开数组\r\n                \"$unwind\": {\r\n                    path: \"$district\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                $project: {\r\n                    \"tag\": \"$tag\",\r\n                    \"materials\": \"$materials\",\r\n                    \"district\": \"$district\",\r\n                    \"level\":\"$level\"\r\n                }\r\n            }\r\n        ];\r\n        var aggregateObj = {};\r\n        aggregateObj.aggregate = aggregate;\r\n        aggregateObj.query = {};\r\n        aggregateObj.searchId = \"query\";\r\n        aggregateObj.dataSetId = \"JC_REPERTORY\";\r\n        aggregateObj.queryIndex = 1;\r\n        this.aggregateMulti([aggregateObj], function (err, data) {\r\n            var obj = data.query[Object.keys(data.query)[0]][0];\r\n            var resultSet = {};\r\n            resultSet[\"result\"] = obj;\r\n            cb.call(ctx, resultSet);\r\n        }, this);\r\n    };\r\n    /**\r\n     * 获取战勤保障详情\r\n     * @param id\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getWarBaseDetail = function (id, cb, ctx) {\r\n        var aggregate = [\r\n            {\r\n                $match: {\r\n                    _id: id\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    //字典表需要加上user_safety_前缀；\r\n                    \"from\": \"user_safety_JC_FIRETEAMPERSON\",\r\n                    //主表里的关联字段\r\n                    \"localField\": \"_id\",\r\n                    //字典表的关联字段\r\n                    \"foreignField\": \"tag.TEAMSTAID\",\r\n                    //结果信息存放属性\r\n                    \"as\": \"persons\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    //字典表需要加上user_safety_前缀；\r\n                    \"from\": \"user_safety_JC_EQUIPMENT\",\r\n                    //主表里的关联字段\r\n                    \"localField\": \"_id\",\r\n                    //字典表的关联字段\r\n                    \"foreignField\": \"tag.TEAMSTAID\",\r\n                    //结果信息存放属性\r\n                    \"as\": \"equipments\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    //字典表需要加上user_safety_前缀；\r\n                    \"from\": \"user_safety_CODE_BAS_DISTRICT\",\r\n                    //主表里的关联字段\r\n                    \"localField\": \"tag.DISTRICTCODE\",\r\n                    //字典表的关联字段\r\n                    \"foreignField\": \"tag.DISTRICTCODE\",\r\n                    //结果信息存放属性\r\n                    \"as\": \"district\"\r\n                }\r\n            },\r\n            {\r\n                //展开数组\r\n                \"$unwind\": {\r\n                    path: \"$district\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                $project: {\r\n                    \"name\": \"$tag.WARBASENAME\",\r\n                    \"address\": \"$tag.ADDRESS\",\r\n                    \"pernum\": \"$tag.PERNUM\",\r\n                    \"carnum\" : \"$tag.CARNUM\",\r\n                    \"infoMan\":\"$tag.CONCATE\",\r\n                    \"infoTel\":\"$tag.CONCATETEL\",\r\n                    \"position\":\"$tag.POSITION\",\r\n                    \"latitude\": \"$tag.LATITUDE\",\r\n                    \"longitude\": \"$tag.LONGITUDE\",\r\n                    \"persons\": \"$persons\",\r\n                    \"equipments\": \"$equipments\",\r\n                    \"district\": \"$district\"\r\n                }\r\n            }\r\n        ];\r\n        var aggregateObj = {};\r\n        aggregateObj.aggregate = aggregate;\r\n        aggregateObj.query = {};\r\n        aggregateObj.searchId = \"query\";\r\n        aggregateObj.dataSetId = \"JC_WARBASE\";\r\n        aggregateObj.queryIndex = 1;\r\n        this.aggregateMulti([aggregateObj], function (err, data) {\r\n            var obj = data.query[Object.keys(data.query)[0]][0];\r\n            var resultSet = {};\r\n            resultSet[\"result\"] = obj;\r\n            cb.call(ctx, resultSet);\r\n        }, this);\r\n    };\r\n    /**\r\n     * 查询专家详情\r\n     * @param id\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getExpertDataDetail = function (id, cb, ctx) {\r\n        var aggregate = [\r\n            {\r\n                $match: {\r\n                    _id: id\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_JC_EXPERT_EVENTREL\",\r\n                    \"localField\": \"tag.EXPERTID\",\r\n                    \"foreignField\": \"tag.EXPERTID\",\r\n                    \"as\": \"EXPERT\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_BAS_DISTRICT\",\r\n                    \"localField\": \"tag.DISTRICT\",\r\n                    \"foreignField\": \"tag.DISTRICTCODE\",\r\n                    \"as\": \"DIST\"\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": \"$EXPERT\"\r\n            },\r\n            {\r\n                \"$unwind\": \"$DIST\"\r\n            }\r\n        ];\r\n        var aggregateObj = {};\r\n        aggregateObj.aggregate = aggregate;\r\n        aggregateObj.query = {};\r\n        aggregateObj.searchId = \"query\";\r\n        aggregateObj.dataSetId = \"JC_EXPERT\";\r\n        aggregateObj.queryIndex = 1;\r\n        this.aggregateMulti([aggregateObj], function (err, data) {\r\n            var obj = data.query[Object.keys(data.query)[0]][0];\r\n            var resultSet = {};\r\n            resultSet[\"result\"] = obj;\r\n            cb.call(ctx, resultSet);\r\n        }, this);\r\n    };\r\n    /**\r\n     * 查询避难场所详情\r\n     * @param id\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getShelterDataDetail = function (id, cb, ctx) {\r\n        var aggregate = [\r\n            {\r\n                $match: {\r\n                    _id: id\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_BAS_DISTRICT\",\r\n                    \"localField\": \"tag.DISTRICTCODE\",\r\n                    \"foreignField\": \"tag.DISTRICTCODE\",\r\n                    \"as\": \"DIST\"\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": \"$DIST\"\r\n            }\r\n        ];\r\n        var aggregateObj = {};\r\n        aggregateObj.aggregate = aggregate;\r\n        aggregateObj.query = {};\r\n        aggregateObj.searchId = \"query\";\r\n        aggregateObj.dataSetId = \"BAS_SHELTER\";\r\n        aggregateObj.queryIndex = 1;\r\n        this.aggregateMulti([aggregateObj], function (err, data) {\r\n            var obj = data.query[Object.keys(data.query)[0]][0];\r\n            var resultSet = {};\r\n            resultSet[\"result\"] = obj;\r\n            cb.call(ctx, resultSet);\r\n        }, this);\r\n    };\r\n    /**\r\n     * 多个管道执行方法-公共\r\n     * @param aggregateList 管道列表\r\n     * @param cb\r\n     * @param ctx\r\n     * @returns {*}\r\n     */\r\n    Service.prototype.aggregateMulti = function (aggregateList, cb, ctx) {\r\n        var opts = {},\r\n            data = {};\r\n        opts.url = EMAP_CONFIG.common.mongoService + '/dataStatics/aggregateMulti';\r\n        opts.dataType = 'json';\r\n        opts.type = 'post';\r\n        data.data = JSON.stringify(aggregateList);\r\n        data.eId = 'safety';\r\n        opts.data = data;\r\n        opts.success = function (d) {\r\n            cb && cb.call(ctx, null, d.data);\r\n        }\r\n        opts.error = function (err) {\r\n            cb && cb.call(ctx, new Error(err));\r\n        }\r\n        return jQuery.ajax(opts);\r\n    };\r\n    /**\r\n     * 获取危化企业详情\r\n     * @param id\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getDangerQYDetail = function (id, cb, ctx) {\r\n\r\n        var aggregate = [\r\n            {\r\n                $match: {\r\n                    _id: id\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    //字典表需要加上user_safety_前缀；\r\n                    \"from\": \"user_safety_CODE_BAS_DISTRICT\",\r\n                    //主表里的关联字段\r\n                    \"localField\": \"tag.COUNTY\",\r\n                    //字典表的关联字段\r\n                    \"foreignField\": \"tag.DISTRICTCODE\",\r\n                    //结果信息存放属性\r\n                    \"as\": \"district\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    //字典表需要加上user_safety_前缀；\r\n                    \"from\": \"user_safety_CODE_DAGCHEM_PROPERTY\",\r\n                    //主表里的关联字段\r\n                    \"localField\": \"tag.PROPERTYCODE\",\r\n                    //字典表的关联字段\r\n                    \"foreignField\": \"tag.PROPERTYCODE\",\r\n                    //结果信息存放属性\r\n                    \"as\": \"property\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    //字典表需要加上user_safety_前缀；\r\n                    \"from\": \"user_safety_CODE_DAGCHEM_ECONOMYTYPE\",\r\n                    //主表里的关联字段\r\n                    \"localField\": \"tag.ECONOMYTYPECODE\",\r\n                    //字典表的关联字段\r\n                    \"foreignField\": \"tag.ECONOMYTYPECODE\",\r\n                    //结果信息存放属性\r\n                    \"as\": \"economy\"\r\n                }\r\n            },\r\n\r\n            {\r\n                \"$lookup\": {\r\n                    //字典表需要加上user_safety_前缀；\r\n                    \"from\": \"user_safety_ANJIAN_DAGCHEM_TECH\",\r\n                    //主表里的关联字段\r\n                    \"localField\": \"tag.DAGCHEMENTID\",\r\n                    //字典表的关联字段\r\n                    \"foreignField\": \"tag.DAGCHEMENTID\",\r\n                    //结果信息存放属性\r\n                    \"as\": \"tech\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    //字典表需要加上user_safety_前缀；\r\n                    \"from\": \"user_safety_ANJIAN_DAGCHEM_CHEM\",\r\n                    //主表里的关联字段\r\n                    \"localField\": \"tag.DAGCHEMENTID\",\r\n                    //字典表的关联字段\r\n                    \"foreignField\": \"tag.DAGCHEMENTID\",\r\n                    //结果信息存放属性\r\n                    \"as\": \"chem\"\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$district\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$property\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$economy\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$tech\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$chem\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                $project: {\r\n                    \"tag\": \"$tag\",\r\n\r\n                    \"district\": \"$district\",\r\n                    \"property\": \"$property\",\r\n                    \"economy\": \"$economy\",\r\n                    \"tech\": \"$tech\",\r\n                    \"chem\": \"$chem\",\r\n                    \"geom\":\"$geom\"\r\n                }\r\n            }\r\n        ];\r\n        var opts = {};\r\n        opts.url = EMAP_CONFIG.common.mongoService + '/' + EMAP_CONFIG.common.dataServerStatistics;\r\n        var data = {};\r\n        data.dataSetId = 'ANJIAN_DAGCHEMENT';\r\n        data.eId = 'safety';\r\n        data.query = JSON.stringify({});\r\n        data.aggregate = JSON.stringify(aggregate);\r\n        opts.data = data;\r\n        opts.type = 'post';\r\n        opts.success = function (data) {\r\n            cb && cb.call(ctx, null, data.data);\r\n        }\r\n        opts.error = function (err) {\r\n            cb && cb.call(ctx, new Error(err));\r\n        }\r\n        jQuery.ajax(opts);\r\n    }\r\n\r\n    /**\r\n     * 获取工贸企业详情\r\n     * @param id\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getGMQYDetail = function (id, cb, ctx) {\r\n\r\n        var aggregate = [\r\n            {\r\n                $match: {\r\n                    _id: id\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_BAS_DISTRICT\",\r\n                    \"localField\": \"tag.COUNTY\",\r\n                    \"foreignField\": \"tag.DISTRICTCODE\",\r\n                    \"as\": \"district\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_ENTERPRISE_INDUSTRY\",\r\n                    \"localField\": \"tag.INDUSTRYCODE\",\r\n                    \"foreignField\": \"tag.INDUSTRYCODE\",\r\n                    \"as\": \"industry\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_ENTERPRISE_NATURE\",\r\n                    \"localField\": \"tag.ENTNATURECODE\",\r\n                    \"foreignField\": \"tag.ENTNATURECODE\",\r\n                    \"as\": \"nature\"\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$district\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$industry\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$nature\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                $project: {\r\n                    \"tag\": \"$tag\",\r\n                    \"district\": \"$district\",\r\n                    \"industry\": \"$industry\",\r\n                    \"nature\": \"$nature\",\r\n                    \"geom\":\"$geom\"\r\n                }\r\n            }\r\n        ];\r\n        var opts = {};\r\n        opts.url = EMAP_CONFIG.common.mongoService + '/' + EMAP_CONFIG.common.dataServerStatistics;\r\n        var data = {};\r\n        data.dataSetId = 'ANJIAN_ENT_WHSMYHBZ';\r\n        data.eId = 'safety';\r\n        data.query = JSON.stringify({});\r\n        data.aggregate = JSON.stringify(aggregate);\r\n        opts.data = data;\r\n        opts.type = 'post';\r\n        opts.success = function (data) {\r\n            cb && cb.call(ctx, null, data.data);\r\n        }\r\n        opts.error = function (err) {\r\n            cb && cb.call(ctx, new Error(err));\r\n        }\r\n        jQuery.ajax(opts);\r\n    }\r\n\r\n    /**\r\n     * 获取煤矿企业详情\r\n     * @param id\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getMKQYDetail = function (id, cb, ctx) {\r\n\r\n        var aggregate = [\r\n            {\r\n                $match: {\r\n                    _id: id\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_BAS_DISTRICT\",\r\n                    \"localField\": \"tag.COUNTY\",\r\n                    \"foreignField\": \"tag.DISTRICTCODE\",\r\n                    \"as\": \"district\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_COAL_STATE\",\r\n                    \"localField\": \"tag.COALSTATECODE\",\r\n                    \"foreignField\": \"tag.COALSTATECODE\",\r\n                    \"as\": \"state\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_COAL_TYPE\",\r\n                    \"localField\": \"tag.COALTYPECODE\",\r\n                    \"foreignField\": \"tag.COALTYPECODE\",\r\n                    \"as\": \"type\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_COAL_DEPTCLASS\",\r\n                    \"localField\": \"tag.DEPTCLASS\",\r\n                    \"foreignField\": \"tag.DEPTCLASS\",\r\n                    \"as\": \"dept\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_COAL_WSGRADE\",\r\n                    \"localField\": \"tag.WS_GRADE\",\r\n                    \"foreignField\": \"tag.WS_GRADE\",\r\n                    \"as\": \"ws\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_COAL_MINESTYLE\",\r\n                    \"localField\": \"tag.MINESTYLE\",\r\n                    \"foreignField\": \"tag.MINESTYLE\",\r\n                    \"as\": \"mine\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_COAL_TRANSMITSTYLE\",\r\n                    \"localField\": \"tag.TRANSMITSTYLE\",\r\n                    \"foreignField\": \"tag.TRANSMITSTYLE\",\r\n                    \"as\": \"transmit\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_COAL_POWERSTYLE\",\r\n                    \"localField\": \"tag.OWERSTYLE\",\r\n                    \"foreignField\": \"tag.OWERSTYLE\",\r\n                    \"as\": \"power\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_COAL_HYDROGEOLOGICAL\",\r\n                    \"localField\": \"tag.HYDROGEOLOGICAL\",\r\n                    \"foreignField\": \"tag.HYDROGEOLOGICAL\",\r\n                    \"as\": \"hydro\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_COAL_VENTILATESTYLE\",\r\n                    \"localField\": \"tag.VENTILATESTYLE\",\r\n                    \"foreignField\": \"tag.VENTILATESTYLE\",\r\n                    \"as\": \"vent\"\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$district\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$state\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$type\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$dept\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$ws\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$mine\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$transmit\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$power\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$hydro\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$vent\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                $project: {\r\n                    \"tag\": \"$tag\",\r\n                    \"district\": \"$district\",\r\n                    \"state\": \"$state\",\r\n                    \"type\": \"$type\",\r\n                    \"dept\": \"$dept\",\r\n                    \"ws\": \"$ws\",\r\n                    \"mine\": \"$mine\",\r\n                    \"transmit\": \"$transmit\",\r\n                    \"power\": \"$power\",\r\n                    \"hydro\": \"$hydro\",\r\n                    \"vent\": \"$vent\",\r\n                    \"geom\":\"$geom\"\r\n                }\r\n            }\r\n        ];\r\n        var opts = {};\r\n        opts.url = EMAP_CONFIG.common.mongoService + '/' + EMAP_CONFIG.common.dataServerStatistics;\r\n        var data = {};\r\n        data.dataSetId = 'ANJIAN_COAL';\r\n        data.eId = 'safety';\r\n        data.query = JSON.stringify({});\r\n        data.aggregate = JSON.stringify(aggregate);\r\n        opts.data = data;\r\n        opts.type = 'post';\r\n        opts.success = function (data) {\r\n            cb && cb.call(ctx, null, data.data);\r\n        }\r\n        opts.error = function (err) {\r\n            cb && cb.call(ctx, new Error(err));\r\n        }\r\n        jQuery.ajax(opts);\r\n    }\r\n    /**\r\n     * 获取非煤矿企业详情\r\n     * @param id\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getFMKQYDetail = function (id, cb, ctx) {\r\n\r\n        var aggregate = [\r\n            {\r\n                $match: {\r\n                    _id: id\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_BAS_DISTRICT\",\r\n                    \"localField\": \"tag.COUNTY\",\r\n                    \"foreignField\": \"tag.DISTRICTCODE\",\r\n                    \"as\": \"district\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_TAILINGPOND_RUNSTATUS\",\r\n                    \"localField\": \"tag.RUNSTATUSCODE\",\r\n                    \"foreignField\": \"tag.RUNSTATUSCODE\",\r\n                    \"as\": \"state\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_TAILINGPOND_TYPE\",\r\n                    \"localField\": \"tag.TAILINGPONDTYPE\",\r\n                    \"foreignField\": \"tag.TAILINGPONDTYPE\",\r\n                    \"as\": \"type\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_TAILINGPOND_GRADE\",\r\n                    \"localField\": \"tag.WKKDBCODE\",\r\n                    \"foreignField\": \"tag.WKKDBCODE\",\r\n                    \"as\": \"dept\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_TAILINGPOND_GRADE\",\r\n                    \"localField\": \"tag.WKKDBCODE\",\r\n                    \"foreignField\": \"tag.WKKDBCODE\",\r\n                    \"as\": \"ws\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_TAILINGPOND_SAFETY\",\r\n                    \"localField\": \"tag.WKKAQDCODE\",\r\n                    \"foreignField\": \"tag.WKKAQDCODE\",\r\n                    \"as\": \"mine\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_TAILINGPOND_INDUSTRY\",\r\n                    \"localField\": \"tag.WKKSSHYCODE\",\r\n                    \"foreignField\": \"tag.WKKSSHYCODE\",\r\n                    \"as\": \"transmit\"\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$district\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$state\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$type\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$dept\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$ws\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$mine\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$transmit\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                $project: {\r\n                    \"tag\": \"$tag\",\r\n                    \"district\": \"$district\",\r\n                    \"state\": \"$state\",\r\n                    \"type\": \"$type\",\r\n                    \"dept\": \"$dept\",\r\n                    \"ws\": \"$ws\",\r\n                    \"mine\": \"$mine\",\r\n                    \"transmit\": \"$transmit\",\r\n                    \"geom\":\"$geom\"\r\n                }\r\n            }\r\n        ];\r\n        var opts = {};\r\n        opts.url = EMAP_CONFIG.common.mongoService + '/' + EMAP_CONFIG.common.dataServerStatistics;\r\n        var data = {};\r\n        data.dataSetId = 'ANJIAN_TAILINGPOND';\r\n        data.eId = 'safety';\r\n        data.query = JSON.stringify({});\r\n        data.aggregate = JSON.stringify(aggregate);\r\n        opts.data = data;\r\n        opts.type = 'post';\r\n        opts.success = function (data) {\r\n            cb && cb.call(ctx, null, data.data);\r\n        }\r\n        opts.error = function (err) {\r\n            cb && cb.call(ctx, new Error(err));\r\n        }\r\n        jQuery.ajax(opts);\r\n    }\r\n\r\n    /**\r\n     * 获取地质灾害详情\r\n     * @param id\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getGEODISASTERDetail = function (id, cb, ctx) {\r\n\r\n        var aggregate = [\r\n            {\r\n                $match: {\r\n                    _id: id\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_BAS_DISTRICT\",\r\n                    \"localField\": \"tag.DISTRICTCODE\",\r\n                    \"foreignField\": \"tag.DISTRICTCODE\",\r\n                    \"as\": \"district\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_GEOLOGICHAZARD_TYPE\",\r\n                    \"localField\": \"tag.GEOHAZARDTYPECODE\",\r\n                    \"foreignField\": \"tag.GEOHAZARDTYPECODE\",\r\n                    \"as\": \"geohazardtype\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_BAS_HAZARDLEVEL\",\r\n                    \"localField\": \"tag.HAZARDLEVELCODE\",\r\n                    \"foreignField\": \"tag.HAZARDLEVELCODE\",\r\n                    \"as\": \"hazardlevel\"\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$district\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$geohazardtype\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$hazardlevel\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                $project: {\r\n                    \"tag\": \"$tag\",\r\n                    \"district\": \"$district\",\r\n                    \"geohazardtype\": \"$geohazardtype\",\r\n                    \"hazardlevel\": \"$hazardlevel\",\r\n                    \"geom\":\"$geom\"\r\n                }\r\n            }\r\n        ];\r\n        var opts = {};\r\n        opts.url = EMAP_CONFIG.common.mongoService + '/' + EMAP_CONFIG.common.dataServerStatistics;\r\n        var data = {};\r\n        data.dataSetId = 'BAS_GEOLOGICHAZARD';\r\n        data.eId = 'safety';\r\n        data.query = JSON.stringify({});\r\n        data.aggregate = JSON.stringify(aggregate);\r\n        opts.data = data;\r\n        opts.type = 'post';\r\n        opts.success = function (data) {\r\n            cb && cb.call(ctx, null, data.data);\r\n        }\r\n        opts.error = function (err) {\r\n            cb && cb.call(ctx, new Error(err));\r\n        }\r\n        jQuery.ajax(opts);\r\n    }\r\n    /**\r\n     * 获取烟花爆竹企业详情\r\n     * @param id\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getYHBZQYDetail = function (id, cb, ctx) {\r\n\r\n        var aggregate = [\r\n            {\r\n                $match: {\r\n                    _id: id\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_BAS_DISTRICT\",\r\n                    \"localField\": \"tag.COUNTY\",\r\n                    \"foreignField\": \"tag.DISTRICTCODE\",\r\n                    \"as\": \"district\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_FIRENT_DEPTTYPE\",\r\n                    \"localField\": \"tag.DEPTTYPECODE\",\r\n                    \"foreignField\": \"tag.DEPTTYPECODE\",\r\n                    \"as\": \"dept\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_ANJIAN_FIRENT_CREDTYPE\",\r\n                    \"localField\": \"tag.CREDTYPECODE\",\r\n                    \"foreignField\": \"tag.CREDTYPECODE\",\r\n                    \"as\": \"cred\"\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$district\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$dept\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$cred\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                $project: {\r\n                    \"tag\": \"$tag\",\r\n                    \"dept\": \"$dept\",\r\n                    \"cred\": \"$cred\",\r\n                    \"district\": \"$district\",\r\n                    \"geom\":\"$geom\"\r\n                }\r\n            }\r\n        ];\r\n        var opts = {};\r\n        opts.url = EMAP_CONFIG.common.mongoService + '/' + EMAP_CONFIG.common.dataServerStatistics;\r\n        var data = {};\r\n        data.dataSetId = 'ANJIAN_FIREWORKENT';\r\n        data.eId = 'safety';\r\n        data.query = JSON.stringify({});\r\n        data.aggregate = JSON.stringify(aggregate);\r\n        opts.data = data;\r\n        opts.type = 'post';\r\n        opts.success = function (data) {\r\n            cb && cb.call(ctx, null, data.data);\r\n        }\r\n        opts.error = function (err) {\r\n            cb && cb.call(ctx, new Error(err));\r\n        }\r\n        jQuery.ajax(opts);\r\n    }\r\n\r\n    /**\r\n     * 获取重大危险源详情\r\n     * @param id\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getDangerDetail = function (id, cb, ctx) {\r\n\r\n        var aggregate = [\r\n            {\r\n                $match: {\r\n                    _id: id\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_BAS_HAZARDLEVEL\",\r\n                    \"localField\": \"tag.HAZARDLEVELCODE\",\r\n                    \"foreignField\": \"tag.HAZARDLEVELCODE\",\r\n                    \"as\": \"hazardlevel\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_BAS_DANGERTYPE\",\r\n                    \"localField\": \"tag.DANGERTYPECODE\",\r\n                    \"foreignField\": \"tag.DANGERTYPECODE\",\r\n                    \"as\": \"dangertype\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_BAS_DISTRICT\",\r\n                    \"localField\": \"tag.COUNTY\",\r\n                    \"foreignField\": \"tag.DISTRICTCODE\",\r\n                    \"as\": \"district\"\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$district\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$hazardlevel\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$dangertype\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                $project: {\r\n                    \"tag\": \"$tag\",\r\n                    \"dangertype\": \"$dangertype\",\r\n                    \"hazardlevel\": \"$hazardlevel\",\r\n                    \"district\": \"$district\",\r\n                    \"geom\":\"$geom\"\r\n                }\r\n            }\r\n        ];\r\n        var opts = {};\r\n        opts.url = EMAP_CONFIG.common.mongoService + '/' + EMAP_CONFIG.common.dataServerStatistics;\r\n        var data = {};\r\n        data.dataSetId = 'ANJIAN_DANGER';\r\n        data.eId = 'safety';\r\n        data.query = JSON.stringify({});\r\n        data.aggregate = JSON.stringify(aggregate);\r\n        opts.data = data;\r\n        opts.type = 'post';\r\n        opts.success = function (data) {\r\n            cb && cb.call(ctx, null, data.data);\r\n        }\r\n        opts.error = function (err) {\r\n            cb && cb.call(ctx, new Error(err));\r\n        }\r\n        jQuery.ajax(opts);\r\n    }\r\n    /**\r\n     * 获取基础数据详情\r\n     * @param id\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getBaseDataDetail = function (id,tablename, cb, ctx) {\r\n\r\n        var aggregate = [\r\n            {\r\n                $match: {\r\n                    _id: id\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_BAS_DISTRICT\",\r\n                    \"localField\": \"tag.DISTRICTCODE\",\r\n                    \"foreignField\": \"tag.DISTRICTCODE\",\r\n                    \"as\": \"district\"\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$district\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                $project: {\r\n                    \"tag\": \"$tag\",\r\n                    \"district\": \"$district\",\r\n                    \"geom\":\"$geom\"\r\n                }\r\n            }\r\n        ];\r\n        var opts = {};\r\n        opts.url = EMAP_CONFIG.common.mongoService + '/' + EMAP_CONFIG.common.dataServerStatistics;\r\n        var data = {};\r\n        data.dataSetId = tablename;\r\n        data.eId = 'safety';\r\n        data.query = JSON.stringify({});\r\n        data.aggregate = JSON.stringify(aggregate);\r\n        opts.data = data;\r\n        opts.type = 'post';\r\n        opts.success = function (data) {\r\n            cb && cb.call(ctx, null, data.data);\r\n        }\r\n        opts.error = function (err) {\r\n            cb && cb.call(ctx, new Error(err));\r\n        }\r\n        jQuery.ajax(opts);\r\n    }\r\n    /**\r\n     * 获取装备数据详情\r\n     * @param id\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getEquipDataDetail = function (id, cb, ctx) {\r\n\r\n        var aggregate = [\r\n            {\r\n                $match: {\r\n                    _id: id\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_BAS_DISTRICT\",\r\n                    \"localField\": \"tag.RESCOUNTY\",\r\n                    \"foreignField\": \"tag.DISTRICTCODE\",\r\n                    \"as\": \"district\"\r\n                }\r\n            },\r\n            {\r\n                \"$unwind\": {\r\n                    path: \"$district\",\r\n                    preserveNullAndEmptyArrays: true\r\n                }\r\n            },\r\n            {\r\n                $project: {\r\n                    \"tag\": \"$tag\",\r\n                    \"district\": \"$district\",\r\n                    \"geom\":\"$geom\"\r\n                }\r\n            }\r\n        ];\r\n        var opts = {};\r\n        opts.url = EMAP_CONFIG.common.mongoService + '/' + EMAP_CONFIG.common.dataServerStatistics;\r\n        var data = {};\r\n        data.dataSetId = \"V_EQUIPMENT\";\r\n        data.eId = 'safety';\r\n        data.query = JSON.stringify({});\r\n        data.aggregate = JSON.stringify(aggregate);\r\n        opts.data = data;\r\n        opts.type = 'post';\r\n        opts.success = function (data) {\r\n            cb && cb.call(ctx, null, data.data);\r\n        }\r\n        opts.error = function (err) {\r\n            cb && cb.call(ctx, new Error(err));\r\n        }\r\n        jQuery.ajax(opts);\r\n    }\r\n  window.EMapServerV2 = window.EMapServerV2 || {};\r\n  // 参考\r\n  window.EMapServerV2.DetailInfoServices = Service;\r\n})(window);","(function (window) {\r\n    window.EMapServerV2 = window.EMapServerV2 || {};\r\n    // 参考\r\n    window.EMapServerV2.DistrictUtil = {};\r\n\r\n    window.EMapServerV2.DistrictUtil.getDistrict = function (districtCodes, callback, context) {\r\n        var requestHandler = function (data, status, xhr) {\r\n            if (data == null) {\r\n                console.error('请求后台出错！' + status);\r\n            } else {\r\n                if (data && data.success) {\r\n                    if (G.utils.CommonUtil.isFunction(callback)) {\r\n                        context = context || window;\r\n                        callback.call(context, data.data.result);\r\n                    }\r\n                } else {\r\n                    //alert(data.msg);\r\n                    console.info('DistrictUtil.getDistrict data.msg=' + data.msg);\r\n                }\r\n            }\r\n        }\r\n        var districtCodeArr = districtCodes.split(','), districtCode = districtCodeArr[0];\r\n        var query = {}, or = [];\r\n        for (var k = 0, len = districtCodeArr.length; k < len; k++) {\r\n            or.push({\r\n                \"tag.adcode\": districtCodeArr[k]\r\n            });\r\n        }\r\n        query['$or'] = or;\r\n        //\r\n        var table = '';\r\n        query = JSON.stringify(query);\r\n        if (districtCode == '000000') {\r\n            table = window.EMapServerV2.DistrictUtil._getDicTableName('country');\r\n            query = '';\r\n        }\r\n        else if (districtCode.endsWith('0000')) {\r\n            table = window.EMapServerV2.DistrictUtil._getDicTableName('province');\r\n        } else if (districtCode.endsWith('00')) {\r\n            table = window.EMapServerV2.DistrictUtil._getDicTableName('city');\r\n        } else {\r\n            table = window.EMapServerV2.DistrictUtil._getDicTableName('county');\r\n        }\r\n        var ajax = G.utils.CommonUtil.ajaxGetData({\r\n            url: this._getQueryUrl(),\r\n            data: {\r\n                query: query,\r\n                dataSetId: table,\r\n                limit: 100,\r\n                eId: 'siptea'\r\n            }\r\n        }, requestHandler);\r\n        return ajax;\r\n    }\r\n\r\n    /***\r\n     * 获取政区表配置\r\n     * @param key\r\n     * @param evacuationIndex\r\n     * @param fullName true要表名；false要查询名；\r\n     * @returns {*}\r\n     * @private\r\n     */\r\n    window.EMapServerV2.DistrictUtil._getDicTableName = function (key, evacuationIndex, fullName) {\r\n        var districtTables = G.static.districtTables,\r\n            tableCfg = districtTables[key], tableName;\r\n        if (tableCfg) {\r\n            tableName = fullName ? tableCfg.fullName : tableCfg.shortName;\r\n            if (tableCfg.evacuationParams && tableCfg.evacuationParams.length > 0) {\r\n                evacuationIndex = isNaN(evacuationIndex) ? 0 : evacuationIndex;\r\n                tableName += tableCfg.evacuationParams[evacuationIndex];\r\n            }\r\n        }\r\n        return tableName;\r\n    }\r\n\r\n    /***\r\n     * 获取政区统计\r\n     * @param options\r\n     * options.tableName 表名\r\n     * options.districtKey 政区字段名\r\n     * options.classifyKey 分类统计的字段名\r\n     * options.statisticsLevel : 政区统计的级别 'province':省;'city':市;'county':县\r\n     * options.query 过滤条件如\r\n     * options.aggregate 管道\r\n     * \"query\":{\"tag.EXPERTTYPECODE\":\"1\"}\r\n     * options.extra 需要在回调传回的参数\r\n     * @param callback\r\n     * @param context\r\n     */\r\n    window.EMapServerV2.DistrictUtil.getStatistics = function (options, callback, context) {\r\n        ;\r\n        var url = this._getStaticsQueryUrl(),\r\n            aggregate;\r\n        if (options.aggregate) {\r\n            aggregate = jQuery.extend(true, [], options.aggregate);\r\n        } else {\r\n            aggregate = [];\r\n        }\r\n        //添加管道；\r\n        getDistrictPipline(aggregate, options);\r\n        aggregate = JSON.stringify(aggregate);\r\n        aggregate = replaceStrs(aggregate, [/\\$\\{districtKey\\}/g], [options.districtKey]);\r\n        aggregate = replaceStrs(aggregate, [/\\$\\{classifyKey\\}/g], [options.classifyKey]);\r\n        var query = {\r\n            \"tag.${districtKey}\": {\r\n                \"$regex\": \".*\"\r\n            }\r\n        };\r\n        //接收过滤条件\r\n        if (typeof options.query == 'string') {\r\n            try {\r\n                options.query = JSON.parse(options.query);\r\n            } catch (e) {\r\n                options.query = {};\r\n            }\r\n        }\r\n        jQuery.extend(query, options.query || {});\r\n        query = replaceStrs(JSON.stringify(query), [/\\$\\{districtKey\\}/g], [options.districtKey]);\r\n        //\r\n        var data = {\r\n            eId: G.utils.CommonUtil.eId,\r\n            dataSetId: options.tableName,\r\n            query: query,\r\n            aggregate: aggregate\r\n        };\r\n        G.utils.CommonUtil.showLoading(true);\r\n        return G.utils.CommonUtil.ajaxGet({\r\n            url: url,\r\n            data: data,\r\n            dataType: 'jsonp'\r\n        }, function (d, s, f, opts) {\r\n            var results = window.EMapServerV2.DistrictUtil.refineStatisticsData(d.data, opts.classifyKey);\r\n            if ((Object.prototype.toString.call(callback) === '[object Function]')) {\r\n                callback.call(context || this, results, opts.extra);\r\n            }\r\n            G.utils.CommonUtil.showLoading(false);\r\n        }, null, options);\r\n        /**\r\n         *  获取查询管道\r\n         */\r\n        function getDistrictPipline(agg, opts) {\r\n            var statisticsLevel = opts.statisticsLevel || 'province';\r\n            var strOper,\r\n                tableCfgs = G.static.districtTables,\r\n                tableCfg, dicTable;\r\n            tableCfg = tableCfgs[statisticsLevel];\r\n            dicTable = window.EMapServerV2.DistrictUtil._getDicTableName(statisticsLevel, 0, true);\r\n            switch (statisticsLevel) {\r\n                case 'province': {\r\n                    strOper = {\r\n                        \"$concat\": [\r\n                            {\r\n                                \"$substr\": [\r\n                                    \"$tag.${districtKey}\", 0, 2\r\n                                ]\r\n                            },\r\n                            \"0000\"\r\n                        ]\r\n                    };\r\n                    break;\r\n                }\r\n                case 'city': {\r\n                    strOper = {\r\n                        \"$concat\": [\r\n                            {\r\n                                \"$substr\": [\r\n                                    \"$tag.${districtKey}\", 0, 4\r\n                                ]\r\n                            },\r\n                            \"00\"\r\n                        ]\r\n                    };\r\n                    break;\r\n                }\r\n                case 'county': {\r\n                    break;\r\n                }\r\n            }\r\n            if (options.classifyKey) {//是否有分类统计\r\n                if (strOper) {\r\n                    agg.push({\r\n                        \"$project\": {\r\n                            \"tag.${districtKey}\": strOper,\r\n                            \"tag.${classifyKey}\": \"$tag.${classifyKey}\"\r\n                        }\r\n                    });\r\n                }\r\n                agg.push({\r\n                    \"$group\": {\r\n                        \"_id\": {\r\n                            \"district\": \"$tag.${districtKey}\",\r\n                            \"${classifyKey}\": \"$tag.${classifyKey}\"\r\n                        },\r\n                        \"count\": {\r\n                            \"$sum\": 1\r\n                        }\r\n                    }\r\n                });\r\n            } else {\r\n                if (strOper) {\r\n                    agg.push({\r\n                        \"$project\": {\r\n                            \"tag.${districtKey}\": strOper\r\n                        }\r\n                    });\r\n                }\r\n                agg.push({\r\n                    \"$group\": {\r\n                        \"_id\": {\r\n                            \"district\": \"$tag.${districtKey}\"\r\n                        },\r\n                        \"count\": {\r\n                            \"$sum\": 1\r\n                        }\r\n                    }\r\n                });\r\n            }\r\n            //配置字典项\r\n            var lookup = {\r\n                \"$lookup\":\r\n                {\r\n                    \"from\": dicTable,\r\n                    \"localField\": \"_id.district\",\r\n                    \"foreignField\": \"tag.adcode\",\r\n                    \"as\": \"_id.district\"\r\n                }\r\n            }\r\n            agg.push(lookup);\r\n        }\r\n\r\n        /**\r\n         *\r\n         * @param src\r\n         * @param regexs arr\r\n         * @param replaces arr\r\n         */\r\n        function replaceStrs(src, regexs, replaces) {\r\n            var i = 0, len = regexs.length;\r\n            for (; i < len; i++) {\r\n                var regex = regexs[i], replace = replaces[i] || '';\r\n                while (regex.test(src)) {\r\n                    src = src.replace(regex, replace);\r\n                }\r\n            }\r\n            return src;\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 组装统计数据\r\n     * @param dataArr\r\n     * @param classifyKey 非空 =按行政区划&分类统计的字段名；空值表示只按行政区划统计;\r\n     *已知验证模块：可视化模块（危化品,大喇叭）\r\n     */\r\n    window.EMapServerV2.DistrictUtil.refineStatisticsData = function (dataArr, classifyKey) {\r\n        var i = 0, len = dataArr.length, results = {};\r\n        //两对象取一个有意义的值\r\n        function getTwoObjHas(oneObj, twoObj) {\r\n            return oneObj || twoObj;\r\n        }\r\n        //处理分类为空的方法\r\n        function doClassifyKeyUndefined() {\r\n            for (; i < len; i++) {\r\n                var d = dataArr[i];\r\n                if (d) {\r\n                    var obj = {}, dicts = getTwoObjHas(d._id.district, []),\r\n                        dict = getTwoObjHas(dicts[0], {});\r\n                    obj.value = d.count;\r\n                    jQuery.extend(obj, getTwoObjHas(dict.tag, {}));\r\n                    var gov = getTwoObjHas(obj.gov, ''), lnglats = gov.trim().split(',');\r\n                    if (gov) {\r\n                        obj.longitude = lnglats[0];\r\n                        obj.latitude = lnglats[1];\r\n                        delete obj.gov;\r\n                    }\r\n                    results[obj.adcode] = obj;\r\n                }\r\n            }\r\n            return results\r\n        };\r\n        //处理分类不为空的方法\r\n        function doClassifyKeyHas() {\r\n            var itemKeys = {}, resultObj = {}, keys = '';\r\n            for (; i < len; i++) {\r\n                var d = dataArr[i];\r\n                if (d) {\r\n                    var dicts = getTwoObjHas(d._id.district, []),\r\n                        dict = getTwoObjHas(dicts[0], {});\r\n                    if (!(dict && dict.tag)) {\r\n                        continue;\r\n                    }\r\n                    var obj = resultObj[dict.tag.adcode], classifyVal = d._id[classifyKey];\r\n                    //政区统计\r\n                    if (!obj) {\r\n                        obj = {\r\n                            items: {}\r\n                        };\r\n                        jQuery.extend(obj, getTwoObjHas(dict.tag, {}));\r\n                        var gov = getTwoObjHas(obj.gov, ''), lnglats = gov.trim().split(',');\r\n                        if (gov) {\r\n                            obj.longitude = lnglats[0];\r\n                            obj.latitude = lnglats[1];\r\n                            delete obj.gov;\r\n                        }\r\n                        resultObj[obj.adcode] = obj;\r\n                    }\r\n                    obj.items[classifyVal] = d.count;\r\n                    itemKeys[classifyVal] = true;\r\n                }\r\n            }\r\n            for (var key0 in itemKeys) {\r\n                if (key0 != null) {\r\n                    keys += key0 + ',';\r\n                }\r\n            }\r\n            if (keys && keys.endsWith(',')) {\r\n                keys = keys.substr(0, keys.length - 1);\r\n            }\r\n            results[keys] = resultObj;\r\n            return results;\r\n        };\r\n\r\n        if (classifyKey) {\r\n            results = doClassifyKeyHas();\r\n        } else {\r\n            results = doClassifyKeyUndefined();\r\n        }\r\n        return results;\r\n    }\r\n\r\n    /**\r\n     * 获取查询路径\r\n     * @returns {*}\r\n     * @private\r\n     */\r\n    window.EMapServerV2.DistrictUtil._getQueryUrl = function () {\r\n        var service = G.utils.CommonUtil.getServiceConfig() || {};\r\n        return service.dataServerIP + '/' + service.dataServerPageQuery;\r\n    }\r\n    /**\r\n     * 获取多表查询路径\r\n     * @returns {*}\r\n     * @private\r\n     */\r\n    window.EMapServerV2.DistrictUtil._getMultiQueryUrl = function () {\r\n        var service = G.utils.CommonUtil.getServiceConfig() || {};\r\n        return service.dataServerIP + '/' + service.dataServerQuery;\r\n    }\r\n    /**\r\n     * 获取统计查询路径\r\n     * @returns {*}\r\n     * @private\r\n     */\r\n    window.EMapServerV2.DistrictUtil._getStaticsQueryUrl = function () {\r\n        var service = G.utils.CommonUtil.getServiceConfig() || {};\r\n        return service.dataServerIP + '/' + service.dataServerStatistics;\r\n    }\r\n    window.EMapServerV2.DistrictUtil.search = function (options, callback) {\r\n        options.eId = 'siptea';\r\n        var ajax = window.EMapServerV2.DistrictUtil.ajaxPostData({\r\n            url: EMAP_CONFIG.common.mongoService + '/biz/district/search',\r\n            data: options,\r\n            showLoading: false,\r\n            async: true\r\n        }, window.EMapServerV2.DistrictUtil.search._callback, null, callback);\r\n        return ajax;\r\n    }\r\n    window.EMapServerV2.DistrictUtil.search._callback = function (data, status, xhr, callback) {\r\n        if (data == null) {\r\n            console.error('请求后台出错！' + status);\r\n        } else {\r\n            if (data && data.success) {\r\n                callback(data.data);\r\n            } else {\r\n                //alert(data.msg);\r\n                console.info('DistrictUtil.search._callback data.msg= ' + data.msg);\r\n            }\r\n        }\r\n    }\r\n    window.EMapServerV2.DistrictUtil.ajaxPostData = function (options, callback, context, param) {\r\n        var opts = jQuery.extend({}, options);\r\n\r\n        // console.log(options.data.data)\r\n        if (opts.url && !opts.url.startsWith('http')) {\r\n            if (!opts.url.startsWith('/')) {\r\n                opts.url = '/' + opts.url;\r\n            }\r\n            opts.url = EMAP_CONFIG.common.mongoService;\r\n        }\r\n        opts.type = 'post';\r\n        opts.dataType = 'json';\r\n        opts.async = options.async === false ? false : true;\r\n        //添加参数\r\n        opts.data = opts.data || {};\r\n        opts.data.eId = opts.data.eId || window.EMapServerV2.DistrictUtil.eId;\r\n        //\r\n        opts.success = function (data, status, xhr) {\r\n            window.EMapServerV2.DistrictUtil.isFunction(callback) && callback.call(context || window, data, status, xhr, param);\r\n            // if (options.showLoading) {\r\n            //     window.EMapServerV2.DistrictUtil.showLoading(false);\r\n            // }\r\n        }\r\n        opts.error = function (xhr, status, msg) {\r\n            console.error(options.url + \" request failed!\");\r\n            window.EMapServerV2.DistrictUtil.isFunction(callback) && callback.call(context || window, null, status, msg, param);\r\n            // if (options.showLoading) {\r\n            //     window.EMapServerV2.DistrictUtil.showLoading(false);\r\n            // }\r\n        }\r\n        // if (options.showLoading) {\r\n        //     window.EMapServerV2.DistrictUtil.showLoading(true);\r\n        // }\r\n        return jQuery.ajax(opts);\r\n    }\r\n    /**\r\n     * 是否是函数\r\n     * @param obj {Object} 必填，需要判断的参数\r\n     * @returns {boolean}\r\n     */\r\n    window.EMapServerV2.DistrictUtil.isFunction = function (obj) {\r\n        return (Object.prototype.toString.call(obj) === '[object Function]');\r\n    }\r\n    /**\r\n     * 聚合管道查询\r\n     * @param obj.dataSetId 数据集ID(表名)\r\n     * @param obj.query 查询条件对象\r\n     * @param obj.fieldMap key:表字段名 value:别名\r\n     * @param obj.pipeline 管道数组\r\n     * @parma callback 回调函数\r\n     * @example\r\n     * G.utils.DistrictUtil.aggregate({\r\n            eId:'siptea',\r\n            dataSetId:'province0.01',\r\n            fieldMap:{\r\n                adcode:'a',\r\n                name:'b'\r\n            }\r\n        },function(){\r\n            console.info(arguments);\r\n        });\r\n     */\r\n    /**\r\n     *叠加行政区划面数据\r\n     * @param districCodes 行政区划对象集合 包含level id\r\n     * @param drawLayer 标绘的图岑\r\n     * @param districEles 存储element的对象\r\n     * @param districGeoJsons 存储geojson的对象\r\n     * @param symbol 标绘的样式\r\n     * @private\r\n     */\r\n\r\n    window.EMapServerV2.DistrictUtil._addDistricPolygonToLayer_ProcessData = function (data, param, drawLayer) {\r\n        if (data == undefined) return;\r\n        if (data.length < 1) return;\r\n        for (var i = 0; i < data.length > 0; i++) {\r\n            if (!param.districEles[data[i].adcode]) {\r\n                var polygonGeometry = g2.sfs.GeometryFactory.createGeometryFromGeoJson(data[i].geom,\r\n                    param.map.spatialReference);\r\n                var ring = new g2.sfs.Ring({ spatialReference: param.map.spatialReference });\r\n                polygonGeometry.addGeometry(ring);\r\n                var polygonEle = new g2.sfs.Element({\r\n                    geometry: polygonGeometry,\r\n                    symbol: symbol, id: data[i].adcode\r\n                });\r\n                drawLayer.add(polygonEle);\r\n                param.districEles[data[i].adcode] = polygonEle;\r\n            }\r\n            param.districGeoJsons[data[i].adcode] = data[i].geom;\r\n        }\r\n\r\n    }\r\n})(window);\r\n","(function (window) {\r\n  var Service = function (opts) {\r\n    var options = {\r\n      //资源类型\r\n      resourceKeys: [\r\n        'RescueTeam※03', //救援队\r\n        'floodteam',\r\n        'fireteam',\r\n        'transportationteam',\r\n        'forestfireteam',\r\n        'hazardousteam',\r\n        'mineteam',\r\n        'nonmineteam',\r\n        'corecompetenceteam',\r\n        'transportationteam',\r\n        'powerteam',\r\n        'mobileteam',\r\n        'gasteam',\r\n        'environmentteam',\r\n        'salvageteam',\r\n        'searescueteam',\r\n        'shipspillteam',\r\n        'healthyteam',\r\n        'portrescueteam',\r\n        'portpassengerteam',\r\n        'portconstructionteam',\r\n        'buildingemergencyteam',\r\n        'passengeremergencyteam',\r\n        'emergencytransportteam',\r\n        'snowteam',\r\n        'equipmentteam',\r\n        'civilianteam',\r\n        'equipment', //救援装备\r\n        'v_equipment※02',\r\n        'v_equipment※03',\r\n        'v_equipment※04',\r\n        'v_equipment※05',\r\n        'v_equipment※06',\r\n        'v_equipment※07',\r\n        'v_equipment※08',\r\n        'v_equipment※09',\r\n        'v_equipment※10',\r\n        'v_equipment※11',\r\n        'v_equipment※12',\r\n        'v_equipment※13',\r\n        'v_equipment※14',\r\n        'v_equipment※15',\r\n        'v_equipment※16',\r\n        'v_equipment※17',\r\n        'v_equipment※18',\r\n        'v_equipment※19',\r\n        'v_equipment※20',\r\n        'v_equipment※21',\r\n        'v_equipment※22',\r\n        'v_equipment※23',\r\n        'v_equipment※24',\r\n        'v_equipment※25',\r\n        'v_equipment※26',\r\n        'v_equipment※27',\r\n        'v_equipment※28',\r\n        'v_equipment※29',\r\n        'v_equipment※30',\r\n        'v_equipment※31',\r\n        'v_equipment※32',\r\n        'v_equipment※33',\r\n        'v_equipment※34',\r\n        'v_equipment※35',\r\n        'v_equipment※36',\r\n        'v_equipment※37',\r\n        'v_equipment※38',\r\n        'v_equipment※39',\r\n        'v_equipment※40',\r\n        'v_equipment※41',\r\n        'v_equipment※42',\r\n        'v_equipment※43',\r\n        'v_equipment※44',\r\n        'v_equipment※45',\r\n        'v_equipment※46',\r\n        'v_equipment※47',\r\n        'v_equipment※48',\r\n        'v_equipment※49',\r\n        'v_equipment_list※01', //救援装备\r\n        'v_equipment_list※02',\r\n        'v_equipment_list※03',\r\n        'v_equipment_list※04',\r\n        'v_equipment_list※05',\r\n        'v_equipment_list※06',\r\n        'v_equipment_list※07',\r\n        'v_equipment_list※08',\r\n        'v_equipment_list※09',\r\n        'v_equipment_list※10',\r\n        'v_equipment_list※11',\r\n        'v_equipment_list※12',\r\n        'v_equipment_list※13',\r\n        'v_equipment_list※14',\r\n        'v_equipment_list※15',\r\n        'v_equipment_list※16',\r\n        'v_equipment_list※17',\r\n        'v_equipment_list※18',\r\n        'v_equipment_list※19',\r\n        'v_equipment_list※20',\r\n        'v_equipment_list※21',\r\n        'v_equipment_list※22',\r\n        'v_equipment_list※23',\r\n        'v_equipment_list※24',\r\n        'v_equipment_list※25',\r\n        'v_equipment_list※26',\r\n        'v_equipment_list※27',\r\n        'v_equipment_list※28',\r\n        'v_equipment_list※29',\r\n        'v_equipment_list※30',\r\n        'v_equipment_list※31',\r\n        'v_equipment_list※32',\r\n        'v_equipment_list※33',\r\n        'v_equipment_list※34',\r\n        'v_equipment_list※35',\r\n        'v_equipment_list※36',\r\n        'v_equipment_list※37',\r\n        'v_equipment_list※38',\r\n        'v_equipment_list※39',\r\n        'v_equipment_list※40',\r\n        'v_equipment_list※41',\r\n        'v_equipment_list※42',\r\n        'v_equipment_list※43',\r\n        'v_equipment_list※44',\r\n        'v_equipment_list※45',\r\n        'v_equipment_list※46',\r\n        'v_equipment_list※47',\r\n        'v_equipment_list※48',\r\n        'v_equipment_list※49',\r\n        'ANJIAN_REPERTORY※01', //物资储备库\r\n        'generalrepository',\r\n        'floodrepository',\r\n        'cityrepository',\r\n        'firerepository',\r\n        'firepreventionrepository',\r\n        'powerrepository',\r\n        'communicationrepository',\r\n        'biologyrepository',\r\n        'airrepository',\r\n        'oilrepository',\r\n        'earthrepository',\r\n        'pottrepository',\r\n        'Expert※01', //专家\r\n        'nonmineexpert',\r\n        'chemicalexpert',\r\n        'tradexpert',\r\n        'emergenceexpert',\r\n        'fireexpert',\r\n        'floodexpert',\r\n        'earthquakeexpert',\r\n        'fireworkexpert',\r\n        'lawexpert',\r\n        'infomationexpert',\r\n        'Expert※12',\r\n        'Expert※13',\r\n        'Expert※14',\r\n        'Expert※15',\r\n        'Expert※16',\r\n        'Expert※17',\r\n        'Expert※18',\r\n        'Expert※19',\r\n        'Expert※20',\r\n        'Expert※21',\r\n        'Expert※22',\r\n        'Expert※23',\r\n        'Expert※24',\r\n        'Expert※25',\r\n        'Expert※26',\r\n        'Expert※27',\r\n        'Expert※28',\r\n        'Expert※29',\r\n        'Expert※30',\r\n        'Expert※31',\r\n        'for_watersourceport',\r\n        'for_waterport',\r\n        'for_watersource',\r\n        'FOR_WATERSOURCE※04',\r\n        'forestfireteam',\r\n        'firepreventionrepository',\r\n        'airport', // 机场\r\n        'shelter', //避难场所\r\n        'JC_WARBASE※01',\r\n        'for_forestfarm',//全国国有林场\r\n        'for_naturalreserve'//自然保护区\r\n      ]\r\n    };\r\n    this.opts = jQuery.extend(true, options, opts);\r\n    // this.commonService = window.EMapServerV2.CommonService.getInstance(opts);\r\n    this.commonService = new window.EMapServerV2.CommonService(opts);\r\n  };\r\n\r\n  /**\r\n   *\r\n   * @param opts\r\n   * @param opts.resourceKeys\r\n   * @param callback\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getStatistics = function (opts, callback, ctx) {\r\n    opts = opts || {};\r\n    var resourceKeys = opts.resourceKeys || this.opts.resourceKeys.slice(0);\r\n    this.commonService.getStatistics(resourceKeys, {}, function (err, data) {\r\n      callback.call(ctx, null, data);\r\n    }, this);\r\n  };\r\n\r\n  /**\r\n   * 按条件统计\r\n   * @param opts\r\n   * @param opts.districtCode\r\n   * @param callback\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getStatisticsByFilter = function (opts, callback, ctx) {\r\n    var filter = {};\r\n    opts = opts || {};\r\n    filter.districtCode = opts.districtCode;\r\n    this.commonService.getStatistics(this.opts.resourceKeys, filter, function (err, data) {\r\n      callback.call(ctx, null, data);\r\n    }, this);\r\n  };\r\n\r\n  /**\r\n   * 查询列表数据\r\n   * @param opts\r\n   * @param opts.keyword 关键字\r\n   * @param opts.resourceKey，多个逗号分隔\r\n   * @param opts.pageSize\r\n   * @param opts.pageIndex\r\n   * @param opts.districtCode\r\n   * @param opts.fields 字段列表（筛选字段）\r\n   * @param opts.id 主键筛选\r\n   * @param opts.filter\r\n   * @param callback\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getDataList = function (opts, callback, ctx) {\r\n    opts = opts || {};\r\n    opts.flatTag = true;\r\n    this.commonService.getDataList(opts, function (err, data) {\r\n      callback.call(ctx, null, data);\r\n    }, this);\r\n  };\r\n\r\n  Service.prototype.getNearbyList = function (opts, callback, ctx) {\r\n    opts = opts || {};\r\n    opts.flatTag = true;\r\n    // opts.resourceKeys = this.opts.resourceKeys;\r\n    var radius = opts.radius;\r\n    this.commonService.getEventData(opts.eventType, function (err, data) {\r\n      var config = opts.config || {};\r\n      //读取默认距离配置、传参的距离\r\n      // var configRadius = data.tag.SEARCH_DIST;\r\n      // if (configRadius != null && configRadius != '' && !isNaN(configRadius)) {\r\n      //   configRadius = parseFloat(configRadius) * 1000;\r\n      // } else {\r\n      //   configRadius = 1000 * 1000;\r\n      // }\r\n      // for (var i = 0; i < this.opts.resourceKeys.length; i++) {\r\n      //   var resourceKey = this.opts.resourceKeys[i];\r\n      //   if (config.hasOwnProperty(resourceKey)) {\r\n      //     if (!config[resourceKey].radius) {\r\n      //       config[resourceKey].radius = opts.radius;\r\n      //     }\r\n      //   } else {\r\n      //     config[resourceKey] = {\r\n      //       radius: opts.radius\r\n      //     }\r\n      //   }\r\n      // }\r\n      this.commonService.getNearbyList(opts, function (err, resultSet) {\r\n        var list = resultSet.list;\r\n        resultSet.radius = list[0] ? list[0].radius : radius;\r\n        //危化企业根据产量分类\r\n        for (var i = 0; i < list.length; i++) {\r\n          var item = list[i];\r\n          if (item && item.codeKey === this.opts.resourceKeys[0]) {\r\n            var itemList = item.data;\r\n            var rangeMap = {\r\n              '1000': {\r\n                range: [1000, Number.MAX_VALUE],\r\n                list: []\r\n              },\r\n              '100': {\r\n                range: [100, 1000],\r\n                list: []\r\n              },\r\n              '0': {\r\n                range: [0, 100],\r\n                list: []\r\n              }\r\n            }\r\n            var itemCount = itemList.length;\r\n            for (var j = 0; j < itemCount; j++) {\r\n              var rowObj = itemList[j],\r\n                sumCount = rowObj.SUMOUTPUT;\r\n              for (var rangeKey in rangeMap) {\r\n                var rangeObj = rangeMap[rangeKey],\r\n                  rangeArr = rangeObj.range;\r\n                if (sumCount >= rangeArr[0] && sumCount < rangeArr[1]) {\r\n                  rangeObj.list.push(rowObj);\r\n                  break;\r\n                }\r\n              }\r\n            }\r\n            var newData = {};\r\n            for (var k in rangeMap) {\r\n              newData[k] = rangeMap[k].list;\r\n            }\r\n            item.data = newData;\r\n          }\r\n        }\r\n        callback.call(ctx, null, resultSet);\r\n      }, this);\r\n    }, this);\r\n  };\r\n  window.EMapServerV2 = window.EMapServerV2 || {};\r\n  // 参考\r\n  window.EMapServerV2.EmerSourceService = Service;\r\n\r\n})(window);\r\n","(function (window) {\r\n  var NewHazardQConfig = {\r\n    'dz': {\r\n      \"tables\": [\r\n        {\r\n          \"id\": \"huapo\",\r\n          \"table\": \"BAS_GEOLOGICHAZARD\",\r\n          \"query\": {\r\n            \"tag.GEOHAZARDTYPECODE\": {\r\n              \"$in\": [\"20104.0300\", \"20104.0200\", \"20104.0100\"]\r\n            }\r\n          },\r\n          \"fieldMap\": {\r\n            \"title\": \"HAZARDNAME\",\r\n            \"monitorType\": \"MONITMODE\",\r\n            \"monitorTel\": \"MONRESPPEROTEL\",\r\n            \"monitorMeasure\": \"TREATSTEP\",\r\n            \"dsBaseLevel\": \"HAZARDLEVELCODE\",\r\n            \"dsBaseType\": \"GEOHAZARDTYPECODE\",\r\n            \"dsBaseAdress\": \"ADDRESS\",\r\n            \"dsThreatenNum\": \"MAXPERSONNUM\",\r\n            \"dsThreatenObj\": \"THREATOBJ\",\r\n            \"dsThreatenProperty\": \"THREATWEALTH\"\r\n          }\r\n        }\r\n      ]\r\n    },\r\n    'qy': {\r\n      \"tables\": [\r\n        {\r\n          \"//\": \"危化品企业\",\r\n          \"id\": \"hazardous\",\r\n          \"table\": \"ANJIAN_DAGCHEMENT\",\r\n          \"fieldMap\": {\r\n            \"title\": \"DAGCHEMENTNAME\",\r\n            \"longitude\": \"LONGITUDE\",\r\n            \"latitude\": \"LATITUDE\",\r\n            \"enBaseAdress\": \"ADDRESS\",\r\n            \"enBaseLevel\": \"RISKLEVEL\",\r\n            \"enBaseEnTel\": \"EMERASKTEL\",\r\n            \"enBaseStaffNum\": \"EMPNUM\"\r\n          }\r\n        },\r\n        {\r\n          \"//\": \"煤矿企业\",\r\n          \"id\": \"coalMine\",\r\n          \"table\": \"ANJIAN_COAL\",\r\n          \"fieldMap\": {\r\n            \"title\": \"COALNAME\",\r\n            \"enBaseAdress\": \"ADDRESS\",\r\n            \"enBaseLevel\": \"RISKLEVEL\",\r\n            \"enBaseEnTel\": \"CONTROLCENTERTEL\",\r\n            \"enBaseStaffNum\": \"WORERNUM\"\r\n          }\r\n        },\r\n        {\r\n          \"//\": \"烟花爆竹企业\",\r\n          \"id\": \"explosive\",\r\n          \"table\": \"ANJIAN_FIREWORKENT\",\r\n          \"fieldMap\": {\r\n            \"title\": \"FIREWORKENTNAME\",\r\n            \"enBaseEnTel\": \"TEL\",\r\n            \"enBaseAdress\": \"ADDRESS\",\r\n            \"longitude\": \"LONGITUDE\",\r\n            \"latitude\": \"LATITUDE\",\r\n            \"enBaseStaffNum\": \"WORKERNUM\"\r\n          }\r\n        },\r\n        {\r\n          \"//\": \"非煤矿山企业\",\r\n          \"id\": \"mine\",\r\n          \"table\": \"ANJIAN_TAILINGPOND\",\r\n          \"fieldMap\": {\r\n            \"title\": \"WKKMC\",\r\n            \"enBaseEnTel\": \"WKKFZRYDDH\",\r\n            \"enBaseAdress\": \"WKKDZMC\",\r\n            \"longitude\": \"LONGITUDE\",\r\n            \"latitude\": \"LATITUDE\",\r\n            \"respper\": \"WKKFZR\",\r\n            \"enBaseStaffNum\": \"TZZYRYSL\"\r\n          }\r\n        }\r\n      ]\r\n    },\r\n    'ss': {\r\n      \"tables\": [\r\n        {\r\n          \"//\": \"水库\",\r\n          \"id\": \"reservoir\",\r\n          \"table\": \"BAS_RESERVOIR\",\r\n          \"fieldMap\": {\r\n            \"title\": \"NAME\",\r\n            \"CODE\": \"CODE\"\r\n          }\r\n        },\r\n        {\r\n          \"//\": \"桥梁\",\r\n          \"id\": \"tunnel\",\r\n          \"table\": \"BAS_BRIDGE\",\r\n          \"fieldMap\": {\r\n            \"title\": \"BRIDGENAME\",\r\n            \"inBaseEnTel\": \"RESPOTEL\",\r\n            \"inBaseAdress\": \"ADDRESS\",\r\n            \"respper\": \"RESPPER\",\r\n            \"BRIDGECATEGORYCODE\": \"BRIDGECATEGORYCODE\",\r\n            \"DISTRICTCODE\": \"DISTRICTNAME\"\r\n          }\r\n        }\r\n      ]\r\n    }\r\n  }\r\n  var util = {\r\n    /**\r\n     * @param opts\r\n     * @param opts.server\r\n     * @param opts.data\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    aggregateMulti: function (opts, cb, ctx) {\r\n      let urlNew = window.EMAP_CONFIG.common.mongoService + '/dataOperate/queryMulti';\r\n      jQuery.ajax({\r\n        // url: opts.server + '/dataStatics/aggregateMulti',\r\n        url: urlNew,\r\n        type: 'post',\r\n        data: {\r\n          eId: 'safety',\r\n          data: JSON.stringify(opts.data)\r\n        },\r\n        dataType: 'json',\r\n        success: function (data) {\r\n          if (data.success) {\r\n            cb && cb.call(ctx, null, data.data);\r\n          } else {\r\n            cb && cb.call(ctx, new Error(data.msg))\r\n          }\r\n        },\r\n        error: function (xhr, msg, err) {\r\n          cb && cb.call(ctx, new Error(err))\r\n        }\r\n      })\r\n    },\r\n    /**\r\n     * @param opts\r\n     * @param opts.server\r\n     * @param opts.eId\r\n     * @param opts.data\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    queryMulti: function (opts, cb, ctx) {\r\n      let urlNew = window.EMAP_CONFIG.common.mongoService + '/dataOperate/queryMulti';\r\n      jQuery.ajax({\r\n        // url: opts.server + '/dataOperate/queryMulti',\r\n        url: urlNew,\r\n        type: 'post',\r\n        data: {\r\n          eId: opts.eId || 'safety',\r\n          data: JSON.stringify(opts.data)\r\n        },\r\n        dataType: 'json',\r\n        success: function (data) {\r\n          if (data.success) {\r\n            cb && cb.call(ctx, null, data.data);\r\n          } else {\r\n            cb && cb.call(ctx, new Error(data.msg))\r\n          }\r\n        },\r\n        error: function (xhr, msg, err) {\r\n          cb && cb.call(ctx, new Error(err))\r\n        }\r\n      })\r\n    },\r\n    //是否为空\r\n    isEmptyValue: function (value) {\r\n      return value == null\r\n        || value == undefined\r\n        || value == \"\"\r\n        || value == \" \";\r\n    },\r\n    R: 6378137,\r\n    fullRange: {\r\n      type: 'Polygon',\r\n      coordinates: [\r\n        [\r\n          [0, 0],\r\n          [180, 0],\r\n          [180, 90],\r\n          [0, 90],\r\n          [0, 0]\r\n        ]\r\n      ]\r\n    },\r\n    //计算经纬度距离\r\n    caculateDistancePoints: function (pt1, pt2) {\r\n      var R = util.R,\r\n        rad = Math.PI / 180,\r\n        lat1 = pt1[1] * rad,\r\n        lat2 = pt2[1] * rad,\r\n        a = Math.sin(lat1) * Math.sin(lat2) +\r\n          Math.cos(lat1) * Math.cos(lat2) * Math.cos((pt2[0] - pt1[0]) * rad);\r\n      return R * Math.acos(Math.min(a, 1));\r\n    },\r\n  };\r\n  /**\r\n *\r\n * @param opts\r\n * @param opts.server\r\n * @constructor\r\n */\r\n  var Service = function (opts) {\r\n    this.opts = opts;\r\n    //\r\n    this.store = {};\r\n  }\r\n  /**\r\n   * 地震烈度范围的地质隐患统计\r\n   * @param opts\r\n   * @param opts.point {Array} [x,y] 事故点\r\n   * @param opts.geometry {GeoJSON} 烈度范围\r\n   * @param opts.resources {Object}\r\n   * @param opts.resources[k] {Object}\r\n   * @param opts.resources[k].tables {Array}\r\n   * @param opts.resources[k].tables[i].table\r\n   * @param opts.resources[k].tables[i].query\r\n   * @param opts.resources[k].tables[i].fieldMap\r\n   * @param opts.levels {Object} 级别映射表\r\n   * @param opts.levelFn {Function} 计算等级的方法\r\n   * @param cb\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getEqStatistics = function (opts, cb, ctx) {\r\n    var seperator = '_ss_',\r\n      geoJsonReader = G.utils.GeometryUtil.getGeoJSONReader();\r\n    var jtsGeometry = geoJsonReader.read(util.fullRange).difference(\r\n      geoJsonReader.read(opts.geometry)),\r\n      pointJson = {\r\n        \"type\": \"Point\",\r\n        \"coordinates\": opts.point\r\n      },\r\n      jtsPoint = geoJsonReader.read(pointJson);\r\n    var distanceLimit = jtsGeometry.distance(jtsPoint) * Math.PI * util.R / 180;\r\n    var geoNear = {\r\n      \"$geoNear\": {\r\n        \"spherical\": true,\r\n        \"near\": pointJson,\r\n        \"limit\": 1000 * 10000,\r\n        \"maxDistance\": distanceLimit,\r\n        \"distanceField\": \"distance\",\r\n        \"includeLocs\": \"geom\"\r\n      }\r\n    }\r\n    var resourceCol = jQuery.extend(true, {}, opts.resources);\r\n    var aggregateList = [];\r\n    for (var resourceKey in resourceCol) {\r\n      var resourceTables = resourceCol[resourceKey].tables;\r\n      for (var i = 0; i < resourceTables.length; i++) {\r\n        var tableObj = resourceTables[i];\r\n        var aggregateObj = {},\r\n          aggregate = [];\r\n        aggregate.push(geoNear);\r\n        aggregate.push({\r\n          $match: {\r\n            \"geom\": {\r\n              \"$geoIntersects\": {\r\n                \"$geometry\": opts.geometry\r\n              }\r\n            }\r\n          }\r\n        })\r\n        if (tableObj.query && Object.keys(tableObj.query).length > 0) {\r\n          aggregate.push({\r\n            $match: tableObj.query\r\n          })\r\n        }\r\n        aggregate.push({\r\n          \"$project\": {\r\n            \"distance\": \"$distance\"\r\n          }\r\n        })\r\n        aggregateObj.aggregate = aggregate;\r\n        aggregateObj.queryIndex = 1;\r\n        aggregateObj.searchId = [resourceKey, tableObj.id].join(seperator);\r\n        aggregateObj.dataSetId = tableObj.table;\r\n        aggregateList.push(aggregateObj);\r\n      }\r\n    }\r\n    util.aggregateMulti({\r\n      server: this.opts.server,\r\n      data: aggregateList\r\n    }, function (err, data) {\r\n\r\n      var resultObj = {};\r\n      for (var resourceKey in resourceCol) {\r\n        var resourceObj = resourceCol[resourceKey];\r\n        var resourceResult = {\r\n          total: 0,\r\n          levels: new Array(4)\r\n        }\r\n        for (var kk = 0; kk < resourceResult.levels.length; kk++) {\r\n          resourceResult.levels[kk] = {\r\n            value: 0\r\n          }\r\n        }\r\n        resultObj[resourceKey] = resourceResult;\r\n        var resourceTables = resourceObj.tables;\r\n        for (var i = 0; i < resourceTables.length; i++) {\r\n          var dataList = data[[resourceKey, resourceTables[i].id].join(seperator)][resourceTables[i].table];\r\n          for (var j = 0, dataLen = dataList.length; j < dataLen; j++) {\r\n            var levelResult = opts.levelFn({\r\n              data: dataList[j],\r\n              maxDistance: distanceLimit,\r\n              levels: opts.levels\r\n            })\r\n            resourceResult.levels[levelResult.level].value++;\r\n          }\r\n          resourceResult.total += dataLen;\r\n        }\r\n      }\r\n      cb && cb.call(ctx, null, resultObj)\r\n    }, this)\r\n  }\r\n\r\n  /**\r\n   * 地震烈度范围的地质隐患查询\r\n   * @param opts\r\n   * @param opts.point {Array} [x,y] 事故点\r\n   * @param opts.geometry {GeoJSON} 烈度范围\r\n   * @param opts.resources {Object}\r\n   * @param opts.resources[k] {Object}\r\n   * @param opts.resources[k].tables {Array}\r\n   * @param opts.resources[k].tables[i].table\r\n   * @param opts.resources[k].tables[i].query\r\n   * @param opts.resources[k].tables[i].fieldMap\r\n   * @param opts.levels {Object} 级别映射表\r\n   * @param opts.levelFn {Function} 计算等级的方法\r\n   * @param cb\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getEqData = function (opts, cb, ctx) {\r\n    var geoJsonReader = G.utils.GeometryUtil.getGeoJSONReader();\r\n    //aggregate\r\n    var jtsGeometry = geoJsonReader.read(util.fullRange).difference(\r\n      geoJsonReader.read(opts.geometry)),\r\n      pointJson = {\r\n        \"type\": \"Point\",\r\n        \"coordinates\": opts.point\r\n      },\r\n      jtsPoint = geoJsonReader.read(pointJson);\r\n    var distanceLimit = jtsGeometry.distance(jtsPoint) * Math.PI * util.R / 180;\r\n    var resourceCol = jQuery.extend(true, {}, opts.resources);\r\n    var queryCol = {};\r\n    for (var resourceKey in resourceCol) {\r\n      var resourceTables = resourceCol[resourceKey].tables;\r\n      for (var i = 0; i < resourceTables.length; i++) {\r\n        var tableObj = resourceTables[i];\r\n        var queryItem = {},\r\n          query = {\r\n            $and: [\r\n              {\r\n                \"geom\": {\r\n                  \"$geoIntersects\": {\r\n                    \"$geometry\": opts.geometry\r\n                  }\r\n                }\r\n              }\r\n            ]\r\n          };\r\n        queryItem.query = query;\r\n        if (tableObj.query) {\r\n          query.$and.push(tableObj.query)\r\n        }\r\n        var selectList = ['geom', '_id'];\r\n        if (tableObj.fieldMap) {\r\n          for (var field in tableObj.fieldMap) {\r\n            selectList.push('tag.' + tableObj.fieldMap[field])\r\n          }\r\n        }\r\n        queryItem.select = selectList.join(' ');\r\n        queryCol[tableObj.table] = queryItem;\r\n      }\r\n    }\r\n    var resultHandler = function (resultdata) {\r\n      var resultCol = {};\r\n      for (var resourceKey in resourceCol) {\r\n        var resultObj = {};\r\n        resultCol[resourceKey] = resultObj;\r\n        for (var levelCode in opts.levels) {\r\n          resultObj[levelCode] = [];\r\n        }\r\n        var resourceTables = resourceCol[resourceKey].tables;\r\n        for (var i = 0; i < resourceTables.length; i++) {\r\n          var tableObj = resourceTables[i];\r\n          var dataList = resultdata[tableObj.table];\r\n          for (var j = 0, dataLen = dataList.length; j < dataLen; j++) {\r\n            var dataItem = dataList[j];\r\n            var dataTemp = {};\r\n            dataTemp.id = dataItem._id;\r\n            dataTemp.geom = dataItem.geom;\r\n            dataTemp._table = tableObj.table;\r\n            dataTemp._type = tableObj.id;\r\n            //attributes\r\n            if (tableObj.fieldMap) {\r\n              for (var field in tableObj.fieldMap) {\r\n                dataTemp[field] = dataItem.tag[tableObj.fieldMap[field]] || '';\r\n              }\r\n            }\r\n            //\r\n            dataTemp.distance = util.caculateDistancePoints(opts.point, dataItem.geom.coordinates);\r\n            var levelResult = opts.levelFn({\r\n              data: dataTemp,\r\n              maxDistance: distanceLimit,\r\n              levels: opts.levels\r\n            })\r\n            resultObj[levelResult.level].push(dataTemp);\r\n          }\r\n        }\r\n      }\r\n      return resultCol;\r\n    }\r\n    util.queryMulti({\r\n      server: this.opts.server,\r\n      data: queryCol\r\n    }, function (err, data) {\r\n      if (err == null) {\r\n        cb && cb.call(ctx, null, resultHandler(data, opts));\r\n      } else {\r\n        cb && cb.call(ctx, err);\r\n      }\r\n    }, this)\r\n  }\r\n\r\n  window.EMapServerV2 = window.EMapServerV2 || {};\r\n  // 参考\r\n  window.EMapServerV2.HazardQueryService = Service;\r\n})(window)","(function (window) {\r\n  /**\r\n   *\r\n   * @param opts\r\n   * @param opts.server\r\n   * @constructor\r\n   */\r\n  var Service = function (opts) {\r\n    this.opts = opts;\r\n    //\r\n    this.store = {\r\n      rescueWorker: null,//救援力量\r\n      resuceNeed: null,//救援需求\r\n      materialNeed: null,//物资需求\r\n      placement: null,//安置\r\n    };\r\n    //\r\n    this.materialSet = {\r\n      \"TP001\": {\r\n        \"label\": \"救灾帐篷\",\r\n        \"code\": \"TP001\",\r\n        \"unit\": \"顶\"\r\n      },\r\n      \"TP002\": {\r\n        \"label\": \"救灾被服\",\r\n        \"code\": \"TP002\",\r\n        \"unit\": \"件\"\r\n      },\r\n      \"TP003\": {\r\n        \"label\": \"救灾食品\",\r\n        \"code\": \"TP003\",\r\n        \"unit\": \"件\"\r\n      },\r\n      \"TP004\": {\r\n        \"label\": \"生活用品\",\r\n        \"code\": \"TP004\",\r\n        \"unit\": \"件\"\r\n      },\r\n      \"TP005\": {\r\n        \"label\": \"照明用具\",\r\n        \"code\": \"TP005\",\r\n        \"unit\": \"件\"\r\n      },\r\n      \"TP006\": {\r\n        \"label\": \"能源动力\",\r\n        \"code\": \"TP006\",\r\n        \"unit\": \"件\"\r\n      },\r\n      \"TP007\": {\r\n        \"label\": \"应急救生\",\r\n        \"code\": \"TP007\",\r\n        \"unit\": \"件\"\r\n      },\r\n      \"TP008\": {\r\n        \"label\": \"交通工具\",\r\n        \"code\": \"TP008\",\r\n        \"unit\": \"台\"\r\n      },\r\n      \"TP009\": {\r\n        \"label\": \"彩条苫布\",\r\n        \"code\": \"TP009\",\r\n        \"unit\": \"件\"\r\n      },\r\n      \"TP010\": {\r\n        \"label\": \"卫生设施\",\r\n        \"code\": \"TP010\",\r\n        \"unit\": \"件\"\r\n      },\r\n      \"TP011\": {\r\n        \"label\": \"生活家具\",\r\n        \"code\": \"TP011\",\r\n        \"unit\": \"件\"\r\n      },\r\n      \"TP012\": {\r\n        \"label\": \"装备工具\",\r\n        \"code\": \"TP012\",\r\n        \"unit\": \"件\"\r\n      },\r\n      \"TP013\": {\r\n        \"label\": \"个体防护\",\r\n        \"code\": \"TP013\",\r\n        \"unit\": \"件\"\r\n      },\r\n      \"TP014\": {\r\n        \"label\": \"侦测与搜寻\",\r\n        \"code\": \"TP014\",\r\n        \"unit\": \"件\"\r\n      }\r\n    };\r\n  }\r\n  /**\r\n   * 获取救援力量\r\n   * @param opts\r\n   * @param cb\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getRescueWorker = function (opts, cb, ctx) {\r\n    // let data = {\r\n    //   total: 1,//总队伍数目\r\n    //   totalNum: 12,//总人数\r\n    //   //救援队伍列表\r\n    //   list: [\r\n    //     {\r\n    //       \"id\": 1559460642167,\r\n    //       \"name\": \"XX救援队\",//名称\r\n    //       \"typeCode\": \"T005\",//类型\r\n    //       \"typeName\": \"地震救援队\",//类型名称\r\n    //       \"num\": 12,//人数\r\n    //       \"unit\": \"人\",//单位\r\n    //       \"x\": 116.92704975,//经度\r\n    //       \"y\": 40.28975715,//纬度\r\n    //     }\r\n    //   ]\r\n    // }\r\n    // cb && cb.call(ctx, null, data);\r\n    cb && cb.call(ctx, null, this.store.rescueWorker);\r\n  }\r\n  /**\r\n   * 基于消息更新救援力量\r\n   * @param data\r\n   */\r\n  Service.prototype.updateRescueWorker = function (data, cb, ctx) {\r\n    data = data || {};\r\n    if (Object.keys(data).length == 0) {//test data\r\n      {\r\n        return\r\n      }\r\n    }\r\n    //   data = {\r\n    //     total: 1,//总队伍数目\r\n    //     totalNum: 12,//总人数\r\n    //     //救援队伍列表\r\n    //     list: [\r\n    //       {\r\n    //         \"id\": 1559460642167,\r\n    //         \"name\": \"XX救援队\",//名称\r\n    //         \"typeCode\": \"T005\",//类型\r\n    //         \"typeName\": \"地震救援队\",//类型名称\r\n    //         \"num\": 12,//人数\r\n    //         \"unit\": \"人\",//单位\r\n    //         \"x\": 116.92704975,//经度\r\n    //         \"y\": 40.28975715,//纬度\r\n    //       }\r\n    //     ]\r\n    //   }\r\n    // }\r\n    this.store.rescueWorker = data;\r\n    cb && cb.call(ctx, null, data);\r\n  }\r\n\r\n  /**\r\n   * 查询灾损区的区县\r\n   * @param opts\r\n   * @param opts.geometry {GeoJSON} 可选，地震灾损区，geojson格式\r\n   * @param opts.codeList {Array} 可选，行政区划编码\r\n   * @param cb\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getCounties = function (opts, cb, ctx) {\r\n    var query = {};\r\n    if (opts.geometry) {\r\n      query['geom'] = {\r\n        '$geoIntersects': {\r\n          '$geometry': opts.geometry\r\n        }\r\n      }\r\n    }\r\n    if (opts.codeList) {\r\n      query['tag.adcode'] = {\r\n        $in: opts.codeList\r\n      }\r\n    }\r\n    jQuery.ajax({\r\n      url: EMAP_CONFIG.common.mongoService + '/dataOperate/queryMulti',\r\n      dataType: 'json',\r\n      type: 'POST',\r\n      data: {\r\n        eId: 'siptea',\r\n        data: JSON.stringify({\r\n          'county0.06': {\r\n            'query': query,\r\n            'select': '_id geom tag.name tag.adcode tag.gov'\r\n          }\r\n        })\r\n      },\r\n      success: function (data) {\r\n        var data = data.data;\r\n        var list = data[Object.keys(data)[0]];\r\n        var newList = [];\r\n        for (var i = 0; i < list.length; i++) {\r\n          var itemObj = list[i];\r\n          var tempObj = {};\r\n          tempObj.geom = itemObj.geom;\r\n          tempObj.name = itemObj.tag.name;\r\n          tempObj.code = itemObj.tag.adcode;\r\n          var xy = itemObj.tag.gov.split(\",\");\r\n          tempObj.x = parseFloat(xy[0]);\r\n          tempObj.y = parseFloat(xy[1]);\r\n          newList.push(tempObj);\r\n        }\r\n        cb && cb.call(ctx, null, newList);\r\n      },\r\n      error: function (err) {\r\n        cb && cb.call(ctx, err);\r\n      }\r\n    });\r\n  }\r\n\r\n  /**\r\n   * 获取救援力量需求\r\n   * @param opts\r\n   * @param cb\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getRescueNeed = function (opts, cb, ctx) {\r\n    cb && cb.call(ctx, null, this.store.resuceNeed);\r\n  }\r\n\r\n  /**\r\n   * 基于消息更新救援力量需求\r\n   * @param data\r\n   */\r\n  Service.prototype.updateRescueNeed = function (data, cb, ctx) {\r\n    data = data || {};\r\n    if (Object.keys(data).length == 0) {//test data\r\n      return\r\n    }\r\n    //   data = {\r\n    //     list: [\r\n    //       {\r\n    //         \"district\": \"xx县\",\r\n    //         \"x\": 116.92704975,//经度\r\n    //         \"y\": 40.28975715,//纬度\r\n    //         //救援队需求\r\n    //         workers: [\r\n    //           {\r\n    //             \"typeCode\": \"T005\",\r\n    //             \"typeName\": \"地震救援队\",\r\n    //             \"num\": 100\r\n    //           },\r\n    //\r\n    //           {\r\n    //             \"typeCode\": \"T002\",\r\n    //             \"typeName\": \"xx救援队\",\r\n    //             \"num\": 200\r\n    //           }\r\n    //         ]\r\n    //       }\r\n    //     ]\r\n    //   }\r\n    // }\r\n    data.total = data.total || 0;\r\n    for (var i = 0; i < data.list.length; i++) {\r\n      var tlist = data.list[i].workers;\r\n      for (var j = 0; j < tlist.length; j++) {\r\n        data.total += parseInt(tlist[j].num);\r\n      }\r\n    }\r\n    this.store.resuceNeed = data;\r\n    cb && cb.call(ctx, null, data);\r\n  }\r\n\r\n  /**\r\n   * 获取三个梯队的救援队\r\n   * @param opts\r\n   * @param opts.point {Array} 必填，事故点\r\n   * @param opts.typeList {Array} 可选，救援队类型过滤\r\n   * @param opts.limit {Num} 可选，数据量限制\r\n   * @param cb\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getRescueCol = function (opts, cb, ctx) {\r\n    var resultCol = {\r\n      total: 0,\r\n      list: [\r\n        {\r\n          total: 0,\r\n          title: '第一梯队',\r\n          list: []\r\n        },\r\n        {\r\n          total: 0,\r\n          title: '第二梯队',\r\n          list: []\r\n        },\r\n        {\r\n          total: 0,\r\n          title: '第三梯队',\r\n          list: [\r\n            {\r\n              name: '中部战区',\r\n              x: 116.3590,\r\n              y: 39.9110\r\n            }, {\r\n              name: '北部战区',\r\n              x: 123.4116,\r\n              y: 41.7966\r\n            }, {\r\n              name: '西部战区',\r\n              x: 104.0817,\r\n              y: 30.6610\r\n            }, {\r\n              name: '南部战区',\r\n              x: 113.2614,\r\n              y: 23.1189\r\n            }, {\r\n              name: '东部战区',\r\n              x: 118.7727,\r\n              y: 32.0476\r\n            }\r\n          ]\r\n        }\r\n      ]\r\n    };\r\n    var limit = opts.limit || 10000,\r\n      radius = 200000;\r\n    var queryCol = [];\r\n    opts.typeList = opts.typeList || [\r\n      'T001', 'T002', 'T003', 'T004', 'T005', 'T006', 'T008',\r\n      'T009', 'T010', 'T011', 'T014'\r\n    ]\r\n    //第一梯队\r\n    var bufferGeom1 = G.utils.SpatialOPUtil.getBuffer({\r\n      geometry: {\r\n        type: 'Point',\r\n        coordinates: opts.point\r\n      },\r\n      radius: radius,\r\n      spatialReference: 4326\r\n    });\r\n    resultCol.list[0].geometry = bufferGeom1;\r\n    resultCol.list[0].titlePoint = [opts.point[0], opts.point[1] + radius / (Math.PI * 6378137 / 180)];\r\n    queryCol.push({\r\n      point: opts.point,\r\n      typeList: opts.typeList,\r\n      limit: limit,\r\n      geometry: bufferGeom1\r\n    })\r\n    //第二梯队\r\n    var chinaRange = {\r\n      type: 'Polygon',\r\n      coordinates: [\r\n        [\r\n          [70, 3],\r\n          [70, 55],\r\n          [136, 55],\r\n          [136, 3],\r\n          [70, 3]\r\n        ]\r\n      ]\r\n    }\r\n    var bufferGeom2 = G.utils.SpatialOPUtil.differGeom(chinaRange, [bufferGeom1]);\r\n    queryCol.push({\r\n      point: opts.point,\r\n      typeList: opts.typeList,\r\n      limit: limit,\r\n      geometry: bufferGeom2\r\n    })\r\n    return this._getRescue({\r\n      querys: queryCol\r\n    }, function (err, data) {\r\n      if (err == null) {\r\n        for (var i = 0; i < data.length; i++) {\r\n          resultCol.list[i].list = data[i];\r\n          var total = 0;\r\n          for (var j = 0, len = data[i].length; j < len; j++) {\r\n            total += data[i][j].num;\r\n          }\r\n          resultCol.list[i].total = total;\r\n          resultCol.total += total;\r\n        }\r\n        //缺口人数\r\n        let resuceNeed = 0;\r\n        if(this.store.resuceNeed&&this.store.resuceNeed.total){\r\n          resuceNeed = his.store.resuceNeed.total;\r\n        }\r\n        resultCol.needNum = Math.max(resuceNeed - resultCol.total, 0);\r\n        cb && cb.call(ctx, null, resultCol);\r\n      } else {\r\n        cb && cb.call(ctx, err);\r\n      }\r\n    }, this);\r\n  }\r\n\r\n  /**\r\n   * 获取需求点周边的指定类型的救援队\r\n   * @param opts\r\n   * @param opts.point {Array} 必填，如[116,39]\r\n   * @param opts.typeList {Array} 必填，类型编码，如['T002']\r\n   * @param opts.num {Number} 必填，人数需求\r\n   * @param cb\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getRescueByTypeAndNeedLoc = function (opts, cb, ctx) {\r\n    var options = {};\r\n    options.point = opts.point;\r\n    options.typeList = opts.typeList;\r\n    options.limit = 5000;\r\n    options.byDistance = true;\r\n    return this._getRescue({\r\n      querys: [options]\r\n    }, function (err, data) {\r\n      if (err == null) {\r\n        var provideList = this._caculateDispatchResult(opts.num, data[0], {\r\n          numKey: 'num',\r\n          codeKey: 'typeCode'\r\n        })\r\n        cb && cb.call(ctx, null, provideList);\r\n      } else {\r\n        cb && cb.call(ctx, err);\r\n      }\r\n    }, this);\r\n  }\r\n\r\n\r\n  /**\r\n   * 提取调配，如救援队\r\n   * @param needCount\r\n   * @param list\r\n   * @param opts\r\n   * @param opts.numKey\r\n   * @private\r\n   */\r\n  Service.prototype._caculateDispatchResult = function (needCount, list, opts) {\r\n    var provideList = [],\r\n      fulfillCount = 0,\r\n      total = list.length,\r\n      numKey = opts.numKey;\r\n    for (var i = 0; i < total; i++) {\r\n      var item = list[i];\r\n      var thisItem = item;\r\n      var attachNum = item[numKey],\r\n        promiseCount = fulfillCount + attachNum;\r\n      if (!attachNum || isNaN(attachNum)) {\r\n        continue;\r\n      }\r\n      if (promiseCount < needCount) {\r\n        thisItem.num = attachNum;\r\n      } else {\r\n        thisItem.num = needCount - fulfillCount;\r\n      }\r\n      fulfillCount += thisItem.num;\r\n      provideList.push(thisItem);\r\n      if (fulfillCount >= needCount) {\r\n        break;\r\n      }\r\n    }\r\n    return provideList;\r\n  };\r\n\r\n  /**\r\n   * 提取调配，如关联形式，如储备库物资\r\n   * @param needSet {Object} 需求对象\r\n   * @param list\r\n   * @param opts\r\n   * @param opts.numKey\r\n   * @param opts.attachKey {String} 附属集合的key\r\n   * @param opts.codeKey {String} 类型字段的key，与needSet里对应\r\n   * @param opts.nameKey {String} 类型名称字段key\r\n   * @param opts.numKey {String} 数量的key\r\n   * @private\r\n   */\r\n  Service.prototype._caculateDispatchAttachResult = function (needSet, list, opts) {\r\n    var total = list.length,\r\n      maxReposityCount = 0;\r\n    var dispatchSet = {};\r\n    for (var codeKey in needSet) {\r\n      var provideList = [];\r\n      var needCount = needSet[codeKey];\r\n      var fulfillCount = 0;\r\n      for (var i = 0; i < total; i++) {\r\n        var item = list[i];\r\n        var provideItem = {\r\n          num: 0\r\n        };\r\n        for (var kk in item) {\r\n          if (kk == opts.attachKey) {\r\n            continue;\r\n          }\r\n          provideItem[kk] = item[kk];\r\n        }\r\n        var attachList = item[opts.attachKey];\r\n        for (var j = 0; j < attachList.length; j++) {\r\n          var attachItem = attachList[j].tag;\r\n          if (!(attachItem[opts.codeKey] == codeKey)) {\r\n            continue;\r\n          }\r\n          var attachNum = attachItem[opts.numKey],\r\n            promiseCount = fulfillCount + attachNum;\r\n          if (!attachNum || isNaN(attachNum)) {\r\n            continue;\r\n          }\r\n          var addNum = 0;\r\n          if (promiseCount < needCount) {\r\n            addNum = attachNum;\r\n          } else {\r\n            addNum = needCount - fulfillCount;\r\n          }\r\n          fulfillCount += addNum;\r\n          provideItem.num += addNum;\r\n          if (fulfillCount >= needCount) {\r\n            break;\r\n          }\r\n        }\r\n        if (provideItem.num > 0) {\r\n          provideList.push(provideItem);\r\n        }\r\n        if (fulfillCount >= needCount) {\r\n          break;\r\n        }\r\n      }\r\n      dispatchSet[codeKey] = provideList;\r\n      maxReposityCount = Math.max(maxReposityCount, provideList.length);\r\n    }\r\n    return {\r\n      dispatchSet: dispatchSet,\r\n      list: list.slice(0, maxReposityCount)\r\n    };\r\n  };\r\n  /**\r\n   * 查询救援队\r\n   * @param opts\r\n   * @param opts.querys\r\n   * @param opts.querys[i].point {Array} 必填，如[116,39]\r\n   * @param opts.querys[i].typeList {Array} 必填，类型编码，如['T002']\r\n   * @param opts.querys[i].query {Object} 可选，自定义查询条件\r\n   * @param opts.querys[i].geometry {GeoJSON} 必填，地震灾损区，geojson格式\r\n   * @param opts.querys[i].bufferMeter {Number} 可选，缓冲距离/米\r\n   * @param opts.querys[i].limit {Number} 可选，返回数据数量\r\n   * @param opts.querys[i].byDistance {Boolean} 可选，\r\n   * @param cb\r\n   * @param ctx\r\n   */\r\n  Service.prototype._getRescue = function (opts, cb, ctx) {\r\n    var aggregateList = [];\r\n    for (var i = 0; i < opts.querys.length; i++) {\r\n      var aggregateObj = {},\r\n        aggregate = [];\r\n      var queryObj = opts.querys[i];\r\n      //\r\n      var geometry = queryObj.geometry;\r\n      if (queryObj.bufferMeter && geometry) {\r\n        geometry = G.utils.SpatialOPUtil.getBuffer({\r\n          geometry: queryObj.geometry,\r\n          radius: queryObj.bufferMeter,\r\n          spatialReference: 4326\r\n        });\r\n      }\r\n      var query = {\r\n        'tag.RESCUETYPECODE': {\r\n          $in: queryObj.typeList\r\n        }\r\n      }\r\n      if (geometry) {\r\n        query['geom'] = {\r\n          $geoIntersects: {\r\n            $geometry: geometry\r\n          }\r\n        }\r\n      }\r\n      if (queryObj.query) {\r\n        for (var kk in queryObj.query) {\r\n          query[kk] = queryObj.query[kk];\r\n        }\r\n      }\r\n      aggregate.push({\r\n        $geoNear: {\r\n          limit: 100000,\r\n          maxDistance: 5000 * 1000,\r\n          spherical: true,\r\n          includeLocs: 'geom',\r\n          distanceField: 'distance',\r\n          near: {\r\n            type: 'Point',\r\n            coordinates: queryObj.point\r\n          }\r\n        }\r\n      })\r\n      aggregate.push({\r\n        $lookup: {\r\n          from: 'user_safety_EQUIP_RESCUETYPE',\r\n          localField: 'tag.RESCUETYPECODE',\r\n          foreignField: '_id',\r\n          as: 'type'\r\n        }\r\n      })\r\n      aggregate.push({\r\n        $unwind: {\r\n          path: '$type',\r\n          \"preserveNullAndEmptyArrays\": false\r\n        }\r\n      })\r\n      if (queryObj.byDistance) {\r\n        aggregate.push({\r\n          $limit: queryObj.limit || 150\r\n        })\r\n      } else {\r\n        aggregate.push({\r\n          $sort: {\r\n            _id: 1\r\n          }\r\n        })\r\n        aggregate.push({\r\n          $limit: queryObj.limit || 150\r\n        })\r\n      }\r\n      aggregate.push({\r\n        $project: {\r\n          name: '$tag.RESCUENAME',\r\n          typeCode: '$tag.RESCUETYPECODE',\r\n          typeName: '$type.tag.SHORTNAME',\r\n          num: '$tag.TOTALPERNUM',\r\n          geom: '$geom',\r\n          distance: '$distance',\r\n          address: '$tag.ADDRESS',\r\n          carNum: '$tag.CARNUM',\r\n          contact: '$tag.CHARGER',\r\n          tel: '$tag.CHARGERMTEL',\r\n        }\r\n      })\r\n      aggregateObj.aggregate = aggregate;\r\n      aggregateObj.query = query;\r\n      aggregateObj.searchId = i;\r\n      aggregateObj.dataSetId = 'JYXX_TEA_RESCUE';\r\n      aggregateObj.queryIndex = 1;\r\n      aggregateList.push(aggregateObj)\r\n    }\r\n    this.aggregateMulti(aggregateList, function (err, data) {\r\n      if (err == null) {\r\n        var resultCol = [];\r\n        for (var j = 0; j < aggregateList.length; j++) {\r\n          var list = data[j]['JYXX_TEA_RESCUE'];\r\n          // var measureService = new g2.sfs.MeasureService({\r\n          //   projectService: new g2.sfs.CoordinateTransform()\r\n          // });\r\n          for (var i = 0; i < list.length; i++) {\r\n            var itemObj = list[i];\r\n            if (!itemObj.geom) {\r\n              continue;\r\n            }\r\n            itemObj.x = itemObj.geom.coordinates[0];\r\n            itemObj.y = itemObj.geom.coordinates[1];\r\n            delete itemObj.geom;\r\n            itemObj.id = itemObj._id;\r\n            delete itemObj._id;\r\n            //\r\n            // var line = g2.sfs.GeometryFactory.createGeometryFromGeoJson({\r\n            //   type: 'LineString',\r\n            //   coordinates: [\r\n            //     opts.querys[j].point,\r\n            //     [itemObj.x, itemObj.y]\r\n            //   ]\r\n            // });\r\n            // line.spatialReference = 4326;\r\n            // itemObj.distance = measureService.length(line);\r\n          }\r\n          // list.sort(function (a, b) {\r\n          //   return a.distance - b.distance;\r\n          // })\r\n          resultCol.push(list);\r\n        }\r\n        cb && cb.call(ctx, null, resultCol);\r\n      } else {\r\n        cb && cb.call(ctx, err);\r\n      }\r\n    })\r\n\r\n  }\r\n\r\n  /**\r\n   * 扩展\r\n   */\r\n  for (var k in window.EMapServerV2.RescueAssistanceServiceExt) {\r\n    Service.prototype[k] = window.EMapServerV2.RescueAssistanceServiceExt[k];\r\n  }\r\n  for (var k in window.EMapServerV2.RescueAssistanceServiceChartExt) {\r\n    Service.prototype[k] = window.EMapServerV2.RescueAssistanceServiceChartExt[k];\r\n  }\r\n\r\n  window.EMapServerV2 = window.EMapServerV2 || {};\r\n  // 参考\r\n  window.EMapServerV2.RescueAssistanceService = Service;\r\n})(window);  ","(function (window) {\r\n  var ext = {\r\n    /**\r\n     * 获取队伍需求图表数据\r\n     * @param opts\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    getTeamNeedSta: function(opts, cb, ctx) {\r\n      this.getRescueNeed({}, function (err, data) {\r\n        if (err == null) {\r\n          var resultObj = {};\r\n          var textList = [];\r\n          var chartData = [];\r\n          var list = [];\r\n          if (data) {\r\n            list = data.list;\r\n            chartData.push({\r\n              \"name\": \"需要队伍人数\",\r\n              \"value\": 0\r\n            });\r\n            for (var i = 0; i < list.length; i++) {\r\n              var workers = list[i].workers;\r\n              for (var j = 0; j < workers.length; j++) {\r\n                textList.push(workers[j].typetitle + '急需' + parseInt(workers[j].num) + '人' + workers[j].typeName);\r\n                chartData[0].value += parseInt(workers[j].num);\r\n              }\r\n            }\r\n          }\r\n          //\r\n          if (this.store.rescueWorker) {\r\n            chartData.push({\r\n              \"name\": \"现场队伍人数\",\r\n              \"value\": 0\r\n            })\r\n            chartData[chartData.length - 1].value = this.store.rescueWorker.totalNum || 0;\r\n          }\r\n          resultObj.textList = textList;\r\n          resultObj.chartData = chartData;\r\n          cb && cb.call(ctx, null, resultObj);\r\n        } else {\r\n          cb && cb.call(ctx, err)\r\n        }\r\n      }, this)\r\n    },\r\n    /**\r\n     * 获取现场队伍图表数据\r\n     * @param opts\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    getRescueWorkerSta: function (opts, cb, ctx) {\r\n      this.getRescueWorker({}, function (err, data) {\r\n        if (err == null) {\r\n          var dataObj = {\r\n            team: {\r\n              title: \"队伍数量\",\r\n              value: 0,\r\n              unit: \"支\",\r\n              ydata: [],\r\n              xdata: []\r\n            },\r\n            person: {\r\n              title: \"队伍人数\",\r\n              value: 0,\r\n              unit: \"人\",\r\n              ydata: [],\r\n              xdata: []\r\n            }\r\n          }\r\n          var typeMap = {\r\n            '社会救援': {\r\n              teamValue: 0,\r\n              personValue: 0,\r\n              list: ['T011']\r\n            },\r\n            '应急搜救': {\r\n              teamValue: 0,\r\n              personValue: 0,\r\n              list: ['T005', 'T003', 'T004', 'T001', 'T002']\r\n            },\r\n            '医疗防疫': {\r\n              teamValue: 0,\r\n              personValue: 0,\r\n              list: ['T014', 'T006']\r\n            },\r\n            '抢通抢修': {\r\n              teamValue: 0,\r\n              personValue: 0,\r\n              list: ['T008', 'T009', 'T010']\r\n            }\r\n          }\r\n          if (data != null) {\r\n            dataObj.team.value = data.total;\r\n            dataObj.person.value = data.totalNum || 0;\r\n            //\r\n            //\r\n            for (var i = 0; i < data.list.length; i++) {\r\n              var item = data.list[i];\r\n              var matchedType = null;\r\n              for (var typeName in typeMap) {\r\n                var typeList = typeMap[typeName].list;\r\n                for (var j = 0; j < typeList.length; j++) {\r\n                  if (typeList[j] == item.typeCode) {\r\n                    matchedType = typeName;\r\n                    break;\r\n                  }\r\n                }\r\n                if (matchedType) {\r\n                  break;\r\n                }\r\n              }\r\n              if (matchedType) {\r\n                typeMap[typeName].teamValue++;\r\n                var val = isNaN(parseInt(item.num)) ? 0 : parseInt(item.num);\r\n                typeMap[typeName].personValue += val;\r\n              }\r\n            }\r\n          }\r\n          dataObj.team.ydata = Object.keys(typeMap);\r\n          dataObj.team.xdata = [];\r\n          dataObj.person.ydata = Object.keys(typeMap);\r\n          dataObj.person.xdata = [];\r\n          for (var typeName in typeMap) {\r\n            dataObj.team.xdata.push(typeMap[typeName].teamValue);\r\n            dataObj.person.xdata.push(typeMap[typeName].personValue);\r\n          }\r\n          cb && cb.call(ctx, null, dataObj);\r\n        } else {\r\n          cb && cb.call(ctx, err);\r\n        }\r\n      }, this)\r\n    },\r\n\r\n    /**\r\n     * 获取物资需求图表数据\r\n     * @param opts\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    getMaterialNeedSta: function (opts, cb, ctx) {\r\n      this.getMaterialNeed({}, function (err, data) {\r\n        if (err == null) {\r\n          var materialSet = {\r\n            'TP001': {\r\n              \"code\": \"TP001\",\r\n              \"name\": \"救灾帐篷\",\r\n              \"iconClass\": \"tentIcon\",\r\n              unit: \"顶\",\r\n              total: 0,\r\n              transfering: 0,\r\n              onArrival: 0\r\n            },\r\n            'TP002': {\r\n              \"code\": \"TP002\",\r\n              \"name\": \"救灾被服\",\r\n              \"iconClass\": \"tentIcon\",\r\n              unit: \"件\",\r\n              total: 0,\r\n              transfering: 0,\r\n              onArrival: 0\r\n            },\r\n            'TP003': {\r\n              \"code\": \"TP003\",\r\n              \"name\": \"救灾食品\",\r\n              \"iconClass\": \"tentIcon\",\r\n              unit: \"件\",\r\n              total: 0,\r\n              transfering: 0,\r\n              onArrival: 0\r\n            },\r\n            'TP004': {\r\n              \"code\": \"TP004\",\r\n              \"name\": \"生活用品\",\r\n              \"iconClass\": \"tentIcon\",\r\n              unit: \"件\",\r\n              total: 0,\r\n              transfering: 0,\r\n              onArrival: 0\r\n            },\r\n            'TP005': {\r\n              \"code\": \"TP005\",\r\n              \"name\": \"照明用具\",\r\n              \"iconClass\": \"tentIcon\",\r\n              unit: \"件\",\r\n              total: 0,\r\n              transfering: 0,\r\n              onArrival: 0\r\n            },\r\n            'TP006': {\r\n              \"code\": \"TP006\",\r\n              \"name\": \"能源动力\",\r\n              \"iconClass\": \"tentIcon\",\r\n              unit: \"件\",\r\n              total: 0,\r\n              transfering: 0,\r\n              onArrival: 0\r\n            },\r\n            'TP007': {\r\n              \"code\": \"TP007\",\r\n              \"name\": \"应急救生\",\r\n              \"iconClass\": \"tentIcon\",\r\n              unit: \"件\",\r\n              total: 0,\r\n              transfering: 0,\r\n              onArrival: 0\r\n            },\r\n            'TP008': {\r\n              \"code\": \"TP008\",\r\n              \"name\": \"交通工具\",\r\n              \"iconClass\": \"tentIcon\",\r\n              unit: \"件\",\r\n              total: 0,\r\n              transfering: 0,\r\n              onArrival: 0\r\n            }\r\n          }\r\n          if (data != null) {\r\n            var list = data.list;\r\n            if (!list) list = [];\r\n            for (var i = 0; i < list.length; i++) {\r\n              var itemObj = list[i];\r\n              var placed = itemObj.placed,\r\n                placing = itemObj.placing,\r\n                unplaced = itemObj.unplaced;\r\n              for (var j = 0; j < placed.length; j++) {\r\n                var mObj = placed[j];\r\n                if (materialSet.hasOwnProperty(mObj.code)) {\r\n                  materialSet[mObj.code].total += parseInt(mObj.num);\r\n                  materialSet[mObj.code].unit = materialSet[mObj.code].unit || mObj.unit;\r\n                }\r\n              }\r\n              for (var j = 0; j < placing.length; j++) {\r\n                var mObj = placing[j];\r\n                if (materialSet.hasOwnProperty(mObj.code)) {\r\n                  materialSet[mObj.code].total += parseInt(mObj.num);\r\n                  materialSet[mObj.code].transfering += parseInt(mObj.num);\r\n                  materialSet[mObj.code].unit = materialSet[mObj.code].unit || mObj.unit;\r\n                }\r\n              }\r\n              for (var j = 0; j < unplaced.length; j++) {\r\n                var mObj = unplaced[j];\r\n                if (materialSet.hasOwnProperty(mObj.code)) {\r\n                  materialSet[mObj.code].total += parseInt(mObj.num);\r\n                  materialSet[mObj.code].onArrival += parseInt(mObj.num);\r\n                  materialSet[mObj.code].unit = materialSet[mObj.code].unit || mObj.unit;\r\n                }\r\n              }\r\n            }\r\n          }\r\n          var list = [];\r\n          for (var kk in materialSet) {\r\n            //只提供有数据的物资\r\n            if (materialSet[kk].total > 0) {\r\n              list.push(materialSet[kk]);\r\n            }\r\n          }\r\n          cb && cb.call(ctx, null, list);\r\n        } else {\r\n          cb && cb.call(ctx, err);\r\n        }\r\n      }, this)\r\n    },\r\n    /**\r\n     * 获取安置点图表数据\r\n     * @param opts\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    getPlacementSta: function (opts, cb, ctx) {\r\n      this.getPlacement({}, function (err, data) {\r\n        if (err == null) {\r\n          var dataObj = {\r\n            name: ['未安置人数', '剩余安置容量', '安置率'],\r\n            value: [0, 0, 0],\r\n            total: 0,\r\n            notPlacedNum: 0,\r\n            capacity: 0\r\n          };\r\n          if (data != null) {\r\n            dataObj.value[0] = data.totalPlacementLeft;\r\n            dataObj.value[1] = data.totalCapacityLeft;\r\n            dataObj.value[2] = parseFloat((100 * data.totalPlacementVictims / data.totalPlacement).toFixed(2));\r\n            dataObj.notPlacedNum = Math.max(0, dataObj.value[0] - dataObj.value[1]);\r\n            dataObj.capacity = data.totalCapacity;\r\n            dataObj.total = data.totalPlacement;\r\n          }\r\n          cb && cb.call(ctx, null, dataObj);\r\n        } else {\r\n          cb && cb.call(ctx, err);\r\n        }\r\n      }, this)\r\n    }\r\n  }\r\n  window.EMapServerV2 = window.EMapServerV2 || {};\r\n  // 参考\r\n  window.EMapServerV2.RescueAssistanceServiceChartExt = ext;\r\n})(window);  ","(function (window) {\r\n  var ext = {\r\n    /**\r\n     * 多个管道执行方法-公共\r\n     * @param aggregateList 管道列表\r\n     * @param cb\r\n     * @param ctx\r\n     * @returns {*}\r\n     */\r\n    aggregateMulti: function (aggregateList, cb, ctx) {\r\n      var opts = {},\r\n        data = {};\r\n      opts.url = EMAP_CONFIG.common.mongoService + '/dataStatics/aggregateMulti';\r\n      opts.dataType = 'json';\r\n      opts.type = 'POST';\r\n      data.data = JSON.stringify(aggregateList);\r\n      data.eId = 'safety';\r\n      opts.data = data;\r\n      opts.success = function (d) {\r\n        cb && cb.call(ctx, null, d.data);\r\n      }\r\n      opts.error = function (err) {\r\n        cb && cb.call(ctx, new Error(err));\r\n      }\r\n      return jQuery.ajax(opts);\r\n    },\r\n\r\n    /**\r\n     * 获取物资需求\r\n     * @param opts\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    getMaterialNeed: function (opts, cb, ctx) {\r\n      cb && cb.call(ctx, null, this.store.materialNeed);\r\n    },\r\n    /**\r\n     *\r\n     * @param data\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    updateMaterialNeed: function (data, cb, ctx) {\r\n      data = data || [];\r\n      this.store.materialNeed = data;\r\n      cb && cb.call(ctx, null, data);\r\n    },\r\n    /**\r\n     * 根据物资需求获取储备库列表\r\n     * @param opts\r\n     * @param opts.point\r\n     * @param opts.materialSet {Object} 必填\r\n     * @param opts.materialSet[key] key为物资类型编码，value为物资需求\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    getNearbyReposity: function (opts, cb, ctx) {\r\n      return this._getNearbyReposity(opts, function (err, data) {\r\n        if (err == null) {\r\n          cb && cb.call(ctx, null, data.list);\r\n        } else {\r\n          cb && cb.call(ctx, err);\r\n        }\r\n      }, ctx);\r\n    },\r\n    /**\r\n     * 根据物资需求获取储备库列表\r\n     * @param opts\r\n     * @param opts.point\r\n     * @param opts.materialSet {Object} 必填\r\n     * @param opts.materialSet[key] key为物资类型编码，value为物资需求\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    _getNearbyReposity: function (opts, cb, ctx) {\r\n      var point = opts.point;\r\n      var aggregate = [];\r\n      var geoNear = {\r\n        limit: 1000000,\r\n        maxDistance: 5000 * 1000,\r\n        spherical: true,\r\n        includeLocs: 'geom',\r\n        distanceField: 'distance'\r\n      };\r\n      geoNear.near = {\r\n        type: 'Point',\r\n        coordinates: [point[0], point[1]]\r\n      };\r\n      aggregate.push({\r\n        $geoNear: geoNear\r\n      });\r\n      aggregate.push(\r\n        {\r\n          \"$lookup\": {\r\n            \"from\": \"user_safety_JC_MATERIAL_INFO\",\r\n            \"localField\": \"_id\",\r\n            \"foreignField\": \"tag.REPERTORYID\",\r\n            \"as\": \"materials\"\r\n          }\r\n        },\r\n        {\r\n          \"$lookup\": {\r\n            \"from\": \"user_safety_CODE_BAS_DISTRICT\",\r\n            \"localField\": \"tag.DISTRICTCODE\",\r\n            \"foreignField\": \"_id\",\r\n            \"as\": \"districts\"\r\n          }\r\n        },\r\n        {\r\n          \"$lookup\": {\r\n            \"from\": \"user_safety_CODE_REP_LEVEL\",\r\n            \"localField\": \"tag.LEVELCODE_\",\r\n            \"foreignField\": \"id\",\r\n            \"as\": \"levels\"\r\n          }\r\n        },\r\n        {\r\n          \"$project\": {\r\n            \"materials\": \"$materials\",\r\n            \"districts\": \"$districts\",\r\n            \"levels\": \"$levels\",\r\n            \"orgname\": \"$tag.ORGNAME\",\r\n            \"name\": \"$tag.REPERTORYNAME\",\r\n            \"address\": \"$tag.ADDRESS\",\r\n            \"contact\": \"$tag.CONCATEPER\",\r\n            \"phone\": \"$tag.CONCATEMOBTEL\",\r\n            \"tel\": \"$tag.CONCATEOFFTEL\",\r\n            \"distance\": \"$distance\",\r\n            \"geom\": \"$geom\"\r\n          }\r\n        }\r\n      )\r\n      var aggregateObj = {};\r\n      aggregateObj.aggregate = aggregate;\r\n      aggregateObj.query = {};\r\n      aggregateObj.searchId = 0;\r\n      aggregateObj.dataSetId = \"JC_REPERTORY\";\r\n      aggregateObj.queryIndex = 1;\r\n      var aggregateList = [aggregateObj];\r\n      aggregateList.push({\r\n        aggregate: [\r\n          {\r\n            $project: {\r\n              \"name\": \"$tag.MATERIALTYPENAME\",\r\n              \"code\": \"$tag.MATERIALTYPECOE\"\r\n            }\r\n          }\r\n        ],\r\n        query: {},\r\n        searchId: 1,\r\n        dataSetId: 'JC_MATERIAL_TYPE'\r\n      })\r\n      this.aggregateMulti(aggregateList, function (err, data) {\r\n        if (err == null) {\r\n          var list = data[aggregateObj.searchId][aggregateObj.dataSetId];\r\n          var dispatchResult = this._caculateDispatchAttachResult(opts.materialSet, list, {\r\n            attachKey: 'materials',\r\n            codeKey: 'MATERIALTYPE',\r\n            // nameKey: 'MATERIALNAME',\r\n            numKey: 'MATERIALNUM'\r\n          });\r\n          var list = dispatchResult.list;\r\n          for (var i = 0; i < list.length; i++) {\r\n            var item = list[i];\r\n            var materials = item.materials;\r\n            delete item.materials;\r\n            var newList = [];\r\n            for (var j = 0; j < materials.length; j++) {\r\n              var materialObj = materials[j].tag;\r\n              newList.push({\r\n                name: materialObj.MATERIALNAME,\r\n                code: materialObj.MATERIALTYPE,\r\n                num: materialObj.MATERIALNUM,\r\n                unit: materialObj.MEASUREUNIT ||\r\n                  (this.materialSet[materialObj.MATERIALTYPE] ? this.materialSet[materialObj.MATERIALTYPE].unit : '件')\r\n              })\r\n            }\r\n            item.material = newList;\r\n            item.x = item.geom.coordinates[0];\r\n            item.y = item.geom.coordinates[1];\r\n            item.district = '';\r\n            item.level = '';\r\n            if (item.districts && item.districts.length > 0) {\r\n              item.district = item.districts[0].tag.DISTRICTNAME;\r\n              delete item.districts;\r\n            }\r\n            if (item.levels && item.levels.length > 0) {\r\n              item.level = item.levels[0].tag.LEVELNAME;\r\n              delete item.levels;\r\n            }\r\n            delete item.geom;\r\n          }\r\n          //\r\n          dispatchResult.typeList = data[1]['JC_MATERIAL_TYPE'];\r\n          cb.call(ctx, null, dispatchResult);\r\n        } else {\r\n          cb && cb.call(ctx, err)\r\n        }\r\n      }, this);\r\n    },\r\n    /**\r\n     * 获取储备库调度方案\r\n     * @param opts.point\r\n     * @param opts.materialSet {Object} 必填\r\n     * @param opts.materialSet[key] key为物资类型编码，value为物资需求\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    getReposityDispatch: function (opts, cb, ctx) {\r\n      return this._getNearbyReposity(opts, function (err, data) {\r\n        if (err == null) {\r\n          var promise = null;\r\n          var current = 0;\r\n          var self = this;\r\n          var resultList = [];\r\n          var async = function () {\r\n            var dtd = jQuery.Deferred();\r\n            self._pathAnalysis({\r\n              start: [data.list[current].x, data.list[current].y],\r\n              end: opts.point\r\n            }).then(function (data) {\r\n              current++;\r\n              resultList.push(data);\r\n              dtd.resolve();\r\n            })\r\n            return dtd;\r\n          }\r\n          for (var i = 0; i < data.list.length; i++) {\r\n            if (promise == null) {\r\n              promise = async();\r\n            } else {\r\n              promise = promise.then(function () {\r\n                return async();\r\n              });\r\n            }\r\n          }\r\n          if (promise == null) {\r\n            cb && cb.call(ctx, null, []);\r\n          } else {\r\n            promise.done(function () {\r\n              var repositySet = {};\r\n              for (var i = 0; i < data.list.length; i++) {\r\n                data.list[i].duration = parseFloat((resultList[i].duration / 3600).toFixed(2));\r\n                repositySet[data.list[i]._id] = data.list[i];\r\n              }\r\n              var dataList = [];\r\n              for (var type in data.dispatchSet) {\r\n                var reposityList = data.dispatchSet[type];\r\n                var itemObj = {};\r\n                itemObj.list = [];\r\n                //\r\n                for (var j = 0; j < reposityList.length; j++) {\r\n                  var reposity = repositySet[reposityList[j]._id];\r\n                  if (reposity) {\r\n                    delete reposity.material;\r\n                    reposity.num = reposityList[j].num;\r\n                    itemObj.list.push(reposity);\r\n                  }\r\n                }\r\n                //\r\n                for (var k = 0; k < data.typeList.length; k++) {\r\n                  if (data.typeList[k].code == type) {\r\n                    itemObj.name = data.typeList[k].name;\r\n                    itemObj.code = type;\r\n                    itemObj.unit = '件';\r\n                    if (self.materialSet.hasOwnProperty(type)) {\r\n                      itemObj.unit = self.materialSet[type].unit;\r\n                    }\r\n                    break;\r\n                  }\r\n                }\r\n                dataList.push(itemObj);\r\n              }\r\n              cb && cb.call(ctx, null, dataList);\r\n            })\r\n          }\r\n        } else {\r\n          cb && cb.call(ctx, err);\r\n        }\r\n      }, this);\r\n    },\r\n    /**\r\n     * 路径规划\r\n     * @param opts\r\n     * @param opts.start {Array} [116,39]\r\n     * @param opts.end {Array} [117,39]\r\n     * @param cb\r\n     * @param ctx\r\n     * @private\r\n     */\r\n    _pathAnalysis: function (opts, cb, ctx) {\r\n      var promise = jQuery.Deferred();\r\n      var startTemp = opts.start[1] + ',' + opts.start[0];\r\n      var start = window.EMapServerV2.CoordTransformUtil.wgs84togcj02(startTemp);\r\n      var endTemp = opts.end[1] + ',' + opts.end[0];\r\n      var end = window.EMapServerV2.CoordTransformUtil.wgs84togcj02(endTemp);\r\n      var url = EMAP_CONFIG.common.GaoDeService +\r\n        'direction/driving?origin='\r\n        + start + '&destination=' + end +\r\n        '&extensions=all&strategy=10&waypoints=&avoidpolygons=&output=json&key=' +\r\n        EMAP_CONFIG.common.GaoDeKey;\r\n      $.ajax({\r\n        url: url,\r\n        dataType: 'jsonp',\r\n        success: function (res) {\r\n          if (res.route) {\r\n            var dataObj = {};\r\n            dataObj.duration = 0;\r\n            if (res.route.paths.length > 0) {\r\n              dataObj.duration = parseInt(res.route.paths[0].duration);\r\n            } else {\r\n              //根据距离计算\r\n              var measureService = new g2.sfs.MeasureService({\r\n                projectService: new g2.sfs.CoordinateTransform()\r\n              });\r\n              var line = g2.sfs.GeometryFactory.createGeometryFromGeoJson({\r\n                type: 'LineString',\r\n                coordinates: [\r\n                  opts.end,\r\n                  opts.start\r\n                ]\r\n              });\r\n              line.spatialReference = 4326;\r\n              dataObj.duration = parseInt((measureService.length(line) * 3.6 / 60).toFixed(0));\r\n            }\r\n            promise.resolve(dataObj)\r\n          }else{\r\n            promise.reject(res);\r\n          }\r\n        },\r\n        error: function (er) {\r\n          promise.reject(er);\r\n        }\r\n      });\r\n      return promise;\r\n\r\n    },\r\n    /**\r\n     * 获取安置信息\r\n     * @param opts\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    getPlacement: function (opts, cb, ctx) {\r\n      cb && cb.call(ctx, null, this.store.placement);\r\n    },\r\n    /**\r\n     * 更新安置信息\r\n     * @param data\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    updatePlacement: function (data, cb, ctx) {\r\n      data = data || {};\r\n      if (Object.keys(data).length == 0) {//test data\r\n        {\r\n          return\r\n        }\r\n      }\r\n      //   data = {\r\n      //     \"list\": [\r\n      //       {\r\n      //         \"district\": \"大厂回族自治县\",\r\n      //         \"districtCode\": \"320775\",//行政区划编码\r\n      //         \"id\": \"131028100\",\r\n      //         \"x\": 116.97272379,\r\n      //         \"y\": 39.88101247,\r\n      //         \"totalCapacity\": \"200\",//总容量\r\n      //         \"totalCapacityPlaced\": \"100\",//已安置容量\r\n      //         \"totalPlacement\": \"30\",//总安置人数\r\n      //         \"totalPlacementVictims\": \"20\"//已安置人数\r\n      //       }, {\r\n      //         \"district\": \"宝坻区\",\r\n      //         \"districtCode\": \"320775\",//行政区划编码\r\n      //         \"x\": 117.29933412,\r\n      //         \"y\": 39.75204604,\r\n      //         \"totalCapacity\": \"2000\",\r\n      //         \"totalCapacityPlaced\": \"500\",\r\n      //         \"totalPlacement\": \"30\",\r\n      //         \"totalPlacementVictims\": \"10\"\r\n      //       }\r\n      //     ]\r\n      //   }\r\n      // }\r\n      data.totalCapacity = 0;\r\n      data.totalCapacityPlaced = 0;\r\n      data.totalCapacityLeft = 0;\r\n      data.totalPlacement = 0;\r\n      data.totalPlacementVictims = 0;\r\n      data.totalPlacementLeft = 0;\r\n      //安置点数\r\n      data.placeNum = 100;\r\n      //安置缺口\r\n      data.needNum = Math.max(data.totalPlacementVictims - data.totalCapacity, 0);\r\n      for (var i = 0; i < data.list.length; i++) {\r\n        var item = data.list[i];\r\n        item.totalCapacity = parseInt(item.totalCapacity);//总容量\r\n        item.totalCapacityPlaced = parseInt(item.totalCapacityPlaced);//已用安置容量\r\n        item.totalCapacityLeft = item.totalCapacity - item.totalCapacityPlaced;//剩余安置容量\r\n        item.totalPlacement = parseInt(item.totalPlacement);//总安置灾民\r\n        item.totalPlacementVictims = parseInt(item.totalPlacementVictims);//已安置灾民\r\n        item.totalPlacementLeft = item.totalPlacement - item.totalPlacementVictims;//待安置人数\r\n        item.placementPercentage = (100 * item.totalPlacementVictims / item.totalPlacement).toFixed(2) + '%';//安置率\r\n        //\r\n        data.totalCapacity += item.totalCapacity;\r\n        data.totalCapacityPlaced += item.totalCapacityPlaced;\r\n        data.totalCapacityLeft += item.totalCapacityLeft;\r\n        data.totalPlacement += item.totalPlacement;\r\n        data.totalPlacementVictims += item.totalPlacementVictims;\r\n        data.totalPlacementLeft += item.totalPlacementLeft;\r\n      }\r\n      data.placementPercentage = (100 * data.totalPlacementVictims / data.totalPlacement).toFixed(2) + '%';//安置率\r\n      this.store.placement = data;\r\n      cb && cb.call(ctx, null, data);\r\n    }\r\n  }\r\n  window.EMapServerV2 = window.EMapServerV2 || {};\r\n  // 参考\r\n  window.EMapServerV2.RescueAssistanceServiceExt = ext;\r\n})(window);  ","(function (window) {\r\n    /**\r\n     * @param opts\r\n     * @param opts.server\r\n     * @constructor\r\n     */\r\n    var Service = function (opts) {\r\n        this.opts = opts;\r\n        //\r\n        this.materialSet ={\r\n            \"TP001\": {\r\n                \"label\": \"救灾帐篷\",\r\n                \"code\": \"TP001\",\r\n                \"unit\": \"顶\"\r\n            },\r\n            \"TP002\": {\r\n                \"label\": \"救灾被服\",\r\n                \"code\": \"TP002\",\r\n                \"unit\": \"件\"\r\n            },\r\n            \"TP003\": {\r\n                \"label\": \"救灾食品\",\r\n                \"code\": \"TP003\",\r\n                \"unit\": \"件\"\r\n            },\r\n            \"TP004\": {\r\n                \"label\": \"生活用品\",\r\n                \"code\": \"TP004\",\r\n                \"unit\": \"件\"\r\n            },\r\n            \"TP005\": {\r\n                \"label\": \"照明用具\",\r\n                \"code\": \"TP005\",\r\n                \"unit\": \"件\"\r\n            },\r\n            \"TP006\": {\r\n                \"label\": \"能源动力\",\r\n                \"code\": \"TP006\",\r\n                \"unit\": \"件\"\r\n            },\r\n            \"TP007\": {\r\n                \"label\": \"应急救生\",\r\n                \"code\": \"TP007\",\r\n                \"unit\": \"件\"\r\n            },\r\n            \"TP008\": {\r\n                \"label\": \"交通工具\",\r\n                \"code\": \"TP008\",\r\n                \"unit\": \"台\"\r\n            },\r\n            \"TP009\": {\r\n                \"label\": \"彩条苫布\",\r\n                \"code\": \"TP009\",\r\n                \"unit\": \"件\"\r\n            },\r\n            \"TP010\": {\r\n                \"label\": \"卫生设施\",\r\n                \"code\": \"TP010\",\r\n                \"unit\": \"件\"\r\n            },\r\n            \"TP011\": {\r\n                \"label\": \"生活家具\",\r\n                \"code\": \"TP011\",\r\n                \"unit\": \"件\"\r\n            },\r\n            \"TP012\": {\r\n                \"label\": \"装备工具\",\r\n                \"code\": \"TP012\",\r\n                \"unit\": \"件\"\r\n            },\r\n            \"TP013\":{\r\n                \"label\": \"个体防护\",\r\n                \"code\": \"TP013\",\r\n                \"unit\": \"件\"\r\n            },\r\n            \"TP014\":{\r\n                \"label\": \"侦测与搜寻\",\r\n                \"code\": \"TP014\",\r\n                \"unit\": \"件\"\r\n            }\r\n        };\r\n    };\r\n    /**\r\n     * 多个管道执行方法-公共\r\n     * @param aggregateList 管道列表\r\n     * @param cb\r\n     * @param ctx\r\n     * @returns {*}\r\n     */\r\n    Service.prototype.aggregateMulti=function (aggregateList, cb, ctx) {\r\n        var opts = {},\r\n            data = {};\r\n        opts.url = EMAP_CONFIG.common.mongoService + '/dataStatics/aggregateMulti';\r\n        opts.dataType = 'json';\r\n        opts.type = 'POST';\r\n        data.data = JSON.stringify(aggregateList);\r\n        data.eId = 'safety';\r\n        opts.data = data;\r\n        opts.success = function (d) {\r\n            cb && cb.call(ctx, null, d.data);\r\n        }\r\n        opts.error = function (err) {\r\n            cb && cb.call(ctx, new Error(err));\r\n        }\r\n        return jQuery.ajax(opts);\r\n    };\r\n    /**\r\n     * 查询救援队\r\n     * @param opts\r\n     * @param opts.querys\r\n     * @param opts.querys[i].point {Array} 必填，如[116,39]\r\n     * @param opts.querys[i].typeList {Array} 必填，类型编码，如['T002']\r\n     * @param opts.querys[i].query {Object} 可选，自定义查询条件\r\n     * @param opts.querys[i].geometry {GeoJSON} 必填，地震灾损区，geojson格式\r\n     * @param opts.querys[i].limit {Number} 可选，返回数据数量\r\n     * @param opts.querys[i].sortByDistance {Boolean} 可选，默认为true\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getRescueTeam=function (opts, cb, ctx) {\r\n        var aggregateList = [];\r\n        for (var i = 0; i < opts.querys.length; i++) {\r\n            var aggregateObj = {},\r\n                aggregate = [];\r\n            var queryObj = opts.querys[i];\r\n            //\r\n            var geometry = queryObj.geometry;\r\n            var nearQuery = {\r\n                'tag.RESCUETYPECODE': {\r\n                    $in: queryObj.typeList\r\n                }\r\n            }\r\n            var query={};\r\n            if (geometry) {\r\n                query['geom'] = {\r\n                    $geoIntersects: {\r\n                        $geometry: geometry\r\n                    }\r\n                }\r\n            }\r\n            if (queryObj.query) {\r\n                for (var kk in queryObj.query) {\r\n                    query[kk] = queryObj.query[kk];\r\n                }\r\n            }\r\n            aggregate.push({\r\n                $geoNear: {\r\n                    limit: 100000,\r\n                    maxDistance: 500000 * 1000,\r\n                    spherical: true,\r\n                    includeLocs: 'geom',\r\n                    distanceField: 'distance',\r\n                    near:{\r\n                        type:'Point',\r\n                        coordinates:queryObj.point\r\n                    },\r\n                    query:nearQuery\r\n                }\r\n            })\r\n            aggregate.push({\r\n                $lookup: {\r\n                    from: 'user_safety_EQUIP_RESCUETYPE',\r\n                    localField: 'tag.RESCUETYPECODE',\r\n                    foreignField: '_id',\r\n                    as: 'type'\r\n                }\r\n            })\r\n            aggregate.push({\r\n                $unwind: {\r\n                    path: '$type',\r\n                    \"preserveNullAndEmptyArrays\": false\r\n                }\r\n            })\r\n            if(queryObj.sortByDistance==false){aggregate.push({\r\n                $sort: {\r\n                    _id:1\r\n                }\r\n            })\r\n                aggregate.push({\r\n                    $limit: queryObj.limit || 150\r\n                })\r\n            }else{\r\n                aggregate.push({\r\n                    $limit: queryObj.limit || 150\r\n                })\r\n            }\r\n            aggregate.push({\r\n                $project: {\r\n                    name: '$tag.RESCUENAME',\r\n                    typeCode: '$tag.RESCUETYPECODE',\r\n                    typeName: '$type.tag.SHORTNAME',\r\n                    num: '$tag.TOTALPERNUM',\r\n                    geom: '$geom',\r\n                    distance:'$distance'\r\n                }\r\n            })\r\n            aggregateObj.aggregate = aggregate;\r\n            aggregateObj.query = query;\r\n            aggregateObj.searchId = i;\r\n            aggregateObj.dataSetId = 'JYXX_TEA_RESCUE';\r\n            aggregateObj.queryIndex = 1;\r\n            aggregateList.push(aggregateObj)\r\n        }\r\n        this.aggregateMulti(aggregateList, function (err, data) {\r\n            if (err == null) {\r\n                var resultCol = [];\r\n                for (var j = 0; j < aggregateList.length; j++) {\r\n                    var list = data[j]['JYXX_TEA_RESCUE'];\r\n                    // var measureService = new g2.sfs.MeasureService({\r\n                    //   projectService: new g2.sfs.CoordinateTransform()\r\n                    // });\r\n                    for (var i = 0; i < list.length; i++) {\r\n                        var itemObj = list[i];\r\n                        if (!itemObj.geom) {\r\n                            continue;\r\n                        }\r\n                        itemObj.x = itemObj.geom.coordinates[0];\r\n                        itemObj.y = itemObj.geom.coordinates[1];\r\n                        delete itemObj.geom;\r\n                        itemObj.id = itemObj._id;\r\n                        delete itemObj._id;\r\n                        //\r\n                        // var line = g2.sfs.GeometryFactory.createGeometryFromGeoJson({\r\n                        //   type: 'LineString',\r\n                        //   coordinates: [\r\n                        //     opts.querys[j].point,\r\n                        //     [itemObj.x, itemObj.y]\r\n                        //   ]\r\n                        // });\r\n                        // line.spatialReference = 4326;\r\n                        // itemObj.distance = measureService.length(line);\r\n                    }\r\n                    // list.sort(function (a, b) {\r\n                    //   return a.distance - b.distance;\r\n                    // })\r\n                    resultCol.push(list);\r\n                }\r\n                cb && cb.call(ctx, null, resultCol);\r\n            } else {\r\n                cb && cb.call(ctx, err);\r\n            }\r\n        })\r\n    };\r\n    /**\r\n     * 获取储备库\r\n     * @param opts\r\n     * @param opts.point\r\n     * @param opts.query\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getReposity=function(opts,cb,ctx){\r\n        var point = opts.point;\r\n        var aggregate = [];\r\n        var geoNear = {\r\n            limit: 1000000,\r\n            maxDistance: 5000 * 1000,\r\n            spherical: true,\r\n            includeLocs: 'geom',\r\n            distanceField: 'distance'\r\n        };\r\n        geoNear.near = {\r\n            type: 'Point',\r\n            coordinates: [point[0], point[1]]\r\n        };\r\n        aggregate.push({\r\n            $geoNear: geoNear\r\n        });\r\n        aggregate.push(\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_JC_MATERIAL_INFO\",\r\n                    \"localField\": \"_id\",\r\n                    \"foreignField\": \"tag.REPERTORYID\",\r\n                    \"as\": \"materials\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_BAS_DISTRICT\",\r\n                    \"localField\": \"tag.DISTRICTCODE\",\r\n                    \"foreignField\": \"_id\",\r\n                    \"as\": \"districts\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_REP_LEVEL\",\r\n                    \"localField\": \"tag.LEVELCODE_\",\r\n                    \"foreignField\": \"id\",\r\n                    \"as\": \"levels\"\r\n                }\r\n            },\r\n            {\r\n                \"$project\": {\r\n                    \"materials\": \"$materials\",\r\n                    \"districts\": \"$districts\",\r\n                    \"levels\": \"$levels\",\r\n                    \"orgname\": \"$tag.ORGNAME\",\r\n                    \"name\": \"$tag.REPERTORYNAME\",\r\n                    \"address\": \"$tag.ADDRESS\",\r\n                    \"contact\": \"$tag.CONCATEPER\",\r\n                    \"phone\": \"$tag.CONCATEMOBTEL\",\r\n                    \"tel\": \"$tag.CONCATEOFFTEL\",\r\n                    \"distance\": \"$distance\",\r\n                    \"geom\": \"$geom\"\r\n                }\r\n            }\r\n        )\r\n        var aggregateObj = {};\r\n        aggregateObj.aggregate = aggregate;\r\n        aggregateObj.query = opts.query||{};\r\n        aggregateObj.searchId = 0;\r\n        aggregateObj.dataSetId = \"JC_REPERTORY\";\r\n        aggregateObj.queryIndex = 1;\r\n        var aggregateList = [aggregateObj];\r\n        this.aggregateMulti(aggregateList,function (err, data) {\r\n            if(err==null){\r\n                var list=data[0]['JC_REPERTORY'];\r\n                cb&&cb.call(ctx,null,list)\r\n            }else{\r\n                cb&&cb.call(ctx,err);\r\n            }\r\n        },this)\r\n    };\r\n    /**\r\n     * 根据物资需求获取储备库列表\r\n     * @param opts\r\n     * @param opts.point\r\n     * @param opts.materialSet {Object} 必填\r\n     * @param opts.materialSet[key] key为物资类型编码，value为物资需求\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getNearbyReposity= function (opts, cb, ctx) {\r\n        var point = opts.point;\r\n        var aggregate = [];\r\n        var geoNear = {\r\n            limit: 1000000,\r\n            maxDistance: 5000 * 1000,\r\n            spherical: true,\r\n            includeLocs: 'geom',\r\n            distanceField: 'distance'\r\n        };\r\n        geoNear.near = {\r\n            type: 'Point',\r\n            coordinates: [point[0], point[1]]\r\n        };\r\n        aggregate.push({\r\n            $geoNear: geoNear\r\n        });\r\n        aggregate.push(\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_JC_MATERIAL_INFO\",\r\n                    \"localField\": \"_id\",\r\n                    \"foreignField\": \"tag.REPERTORYID\",\r\n                    \"as\": \"materials\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_BAS_DISTRICT\",\r\n                    \"localField\": \"tag.DISTRICTCODE\",\r\n                    \"foreignField\": \"_id\",\r\n                    \"as\": \"districts\"\r\n                }\r\n            },\r\n            {\r\n                \"$lookup\": {\r\n                    \"from\": \"user_safety_CODE_REP_LEVEL\",\r\n                    \"localField\": \"tag.LEVELCODE_\",\r\n                    \"foreignField\": \"id\",\r\n                    \"as\": \"levels\"\r\n                }\r\n            },\r\n            {\r\n                \"$project\": {\r\n                    \"materials\": \"$materials\",\r\n                    \"districts\": \"$districts\",\r\n                    \"levels\": \"$levels\",\r\n                    \"orgname\": \"$tag.ORGNAME\",\r\n                    \"name\": \"$tag.REPERTORYNAME\",\r\n                    \"address\": \"$tag.ADDRESS\",\r\n                    \"contact\": \"$tag.CONCATEPER\",\r\n                    \"phone\": \"$tag.CONCATEMOBTEL\",\r\n                    \"tel\": \"$tag.CONCATEOFFTEL\",\r\n                    \"distance\": \"$distance\",\r\n                    \"geom\": \"$geom\"\r\n                }\r\n            }\r\n        )\r\n        var aggregateObj = {};\r\n        aggregateObj.aggregate = aggregate;\r\n        aggregateObj.query = {};\r\n        aggregateObj.searchId = 0;\r\n        aggregateObj.dataSetId = \"JC_REPERTORY\";\r\n        aggregateObj.queryIndex = 1;\r\n        var aggregateList = [aggregateObj];\r\n        aggregateList.push({\r\n            aggregate: [\r\n                {\r\n                    $project: {\r\n                        \"name\": \"$tag.MATERIALTYPENAME\",\r\n                        \"code\": \"$tag.MATERIALTYPECOE\"\r\n                    }\r\n                }\r\n            ],\r\n            query: {},\r\n            searchId: 1,\r\n            dataSetId: 'JC_MATERIAL_TYPE'\r\n        })\r\n        this.aggregateMulti(aggregateList, function (err, data) {\r\n            if (err == null) {\r\n                var list = data[aggregateObj.searchId][aggregateObj.dataSetId];\r\n                var dispatchResult = this._caculateDispatchAttachResult(opts.materialSet, list, {\r\n                    attachKey: 'materials',\r\n                    codeKey: 'MATERIALTYPE',\r\n                    // nameKey: 'MATERIALNAME',\r\n                    numKey: 'MATERIALNUM'\r\n                });\r\n                var list = dispatchResult.list;\r\n                for (var i = 0; i < list.length; i++) {\r\n                    var item = list[i];\r\n                    var materials = item.materials;\r\n                    delete item.materials;\r\n                    var newList = [];\r\n                    for (var j = 0; j < materials.length; j++) {\r\n                        var materialObj = materials[j].tag;\r\n                        newList.push({\r\n                            name: materialObj.MATERIALNAME,\r\n                            code: materialObj.MATERIALTYPE,\r\n                            num: materialObj.MATERIALNUM,\r\n                            unit: materialObj.MEASUREUNIT||\r\n                            (this.materialSet[materialObj.MATERIALTYPE]?this.materialSet[materialObj.MATERIALTYPE].unit:'件')\r\n                        })\r\n                    }\r\n                    item.material = newList;\r\n                    item.x = item.geom.coordinates[0];\r\n                    item.y = item.geom.coordinates[1];\r\n                    item.district = '';\r\n                    item.level = '';\r\n                    if (item.districts && item.districts.length > 0) {\r\n                        item.district = item.districts[0].tag.DISTRICTNAME;\r\n                        delete item.districts;\r\n                    }\r\n                    if (item.levels && item.levels.length > 0) {\r\n                        item.level = item.levels[0].tag.LEVELNAME;\r\n                        delete item.levels;\r\n                    }\r\n                    delete item.geom;\r\n                }\r\n                //\r\n                dispatchResult.typeList = data[1]['JC_MATERIAL_TYPE'];\r\n                cb.call(ctx, null, dispatchResult);\r\n            } else {\r\n                cb && cb.call(ctx, err)\r\n            }\r\n        }, this);\r\n    };\r\n    /**\r\n     * 提取调配，如关联形式，如储备库物资\r\n     * @param needSet {Object} 需求对象\r\n     * @param list\r\n     * @param opts\r\n     * @param opts.numKey\r\n     * @param opts.attachKey {String} 附属集合的key\r\n     * @param opts.codeKey {String} 类型字段的key，与needSet里对应\r\n     * @param opts.nameKey {String} 类型名称字段key\r\n     * @param opts.numKey {String} 数量的key\r\n     * @private\r\n     */\r\n    Service.prototype._caculateDispatchAttachResult = function (needSet, list, opts) {\r\n        var total = list.length,\r\n            maxReposityCount = 0;\r\n        var dispatchSet = {};\r\n        for (var codeKey  in needSet) {\r\n            var provideList = [];\r\n            var needCount = needSet[codeKey];\r\n            var fulfillCount = 0;\r\n            for (var i = 0; i < total; i++) {\r\n                var item = list[i];\r\n                var provideItem = {\r\n                    num: 0\r\n                };\r\n                for (var kk in item) {\r\n                    if (kk == opts.attachKey) {\r\n                        continue;\r\n                    }\r\n                    provideItem[kk] = item[kk];\r\n                }\r\n                var attachList = item[opts.attachKey];\r\n                for (var j = 0; j < attachList.length; j++) {\r\n                    var attachItem = attachList[j].tag;\r\n                    if (!(attachItem[opts.codeKey] == codeKey)) {\r\n                        continue;\r\n                    }\r\n                    var attachNum = attachItem[opts.numKey],\r\n                        promiseCount = fulfillCount + attachNum;\r\n                    if (!attachNum || isNaN(attachNum)) {\r\n                        continue;\r\n                    }\r\n                    var addNum = 0;\r\n                    if (promiseCount < needCount) {\r\n                        addNum = attachNum;\r\n                    } else {\r\n                        addNum = needCount - fulfillCount;\r\n                    }\r\n                    fulfillCount += addNum;\r\n                    provideItem.num += addNum;\r\n                    if (fulfillCount >= needCount) {\r\n                        break;\r\n                    }\r\n                }\r\n                if(provideItem.num>0){\r\n                    provideList.push(provideItem);\r\n                }\r\n                if (fulfillCount >= needCount) {\r\n                    break;\r\n                }\r\n            }\r\n            dispatchSet[codeKey] = provideList;\r\n            maxReposityCount = Math.max(maxReposityCount, provideList.length);\r\n        }\r\n        return {\r\n            dispatchSet: dispatchSet,\r\n            list: list.slice(0, maxReposityCount)\r\n        };\r\n    };\r\n  window.EMapServerV2 = window.EMapServerV2 || {};\r\n  // 参考\r\n  window.EMapServerV2.RescueHelpService = Service;\r\n})(window);  ","(function (window) {\r\n  var Service = function (opts) {\r\n    var options = {\r\n      //资源类型\r\n      resourceKeys: [\r\n        'floodteam',\r\n          'fireteam',\r\n          'transportationteam',\r\n          'forestfireteam',\r\n          'hazardousteam',\r\n          'mineteam',\r\n          'nonmineteam',\r\n          'corecompetenceteam'\r\n      ]\r\n    }\r\n    this.opts = jQuery.extend(true, options, opts);\r\n    this.commonService = new window.EMapServerV2.CommonService(opts);\r\n  };\r\n\r\n  /**\r\n   *\r\n   * @param callback\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getStatistics = function (callback, ctx) {\r\n    var resourceKeys = this.opts.resourceKeys.slice(0);\r\n    this.commonService.getStatistics(resourceKeys, {}, function (err, data) {\r\n      callback.call(ctx, null, data);\r\n    }, this);\r\n  };\r\n\r\n  /**\r\n   * 按条件统计\r\n   * @param opts\r\n   * @param opts.districtCode\r\n   * @param callback\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getStatisticsByFilter = function (opts, callback, ctx) {\r\n    var filter = {};\r\n    opts = opts || {};\r\n    filter.districtCode = opts.districtCode;\r\n    this.commonService.getStatistics(this.opts.resourceKeys, filter, function (err, data) {\r\n      callback.call(ctx, null, data);\r\n    }, this);\r\n  };\r\n\r\n  /**\r\n   * 查询列表数据\r\n   * @param opts\r\n   * @param opts.resourceKey，多个逗号分隔\r\n   * @param opts.pageSize\r\n   * @param opts.pageIndex\r\n   * @param opts.districtCode\r\n   * @param callback\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getDataList = function (opts, callback, ctx) {\r\n    opts = opts || {};\r\n    opts.flatTag = true;\r\n    this.commonService.getDataList(opts, function (err, data) {\r\n      callback.call(ctx, null, data);\r\n    }, this);\r\n  };\r\n\r\n  Service.prototype.getNearbyList = function (opts, callback, ctx) {\r\n    opts = opts || {};\r\n    opts.flatTag = true;\r\n    opts.resourceKeys = this.opts.resourceKeys;\r\n    var radius = opts.config[\"ANJIAN_DAGCHEMENT※DangerousChemical\"].radius;\r\n    this.commonService.getEventData(opts.eventType, function (err, data) {\r\n      var config = opts.config || {};\r\n      //读取默认距离配置、传参的距离\r\n      var configRadius = data.tag.SEARCH_DIST;\r\n      if (configRadius != null && configRadius != '' && !isNaN(configRadius)) {\r\n        configRadius = parseFloat(configRadius) * 1000;\r\n      } else {\r\n        configRadius = 1000 * 1000;\r\n      }\r\n      for (var i = 0; i < this.opts.resourceKeys.length; i++) {\r\n        var resourceKey = this.opts.resourceKeys[i];\r\n        if (config.hasOwnProperty(resourceKey)) {\r\n          if (!config[resourceKey].radius) {\r\n            config[resourceKey].radius = configRadius;\r\n          }\r\n        } else {\r\n          config[resourceKey] = {\r\n            radius: configRadius\r\n          }\r\n        }\r\n      }\r\n      this.commonService.getNearbyList(opts, function (err, resultSet) {\r\n        var list = resultSet.list;\r\n        resultSet.radius = list[0] ? list[0].radius : radius;\r\n        //危化企业根据产量分类\r\n        for (var i = 0; i < list.length; i++) {\r\n          var item = list[i];\r\n          if (item && item.codeKey === this.opts.resourceKeys[0]) {\r\n            var itemList = item.data;\r\n            var rangeMap = {\r\n              '1000': {\r\n                range: [1000, Number.MAX_VALUE],\r\n                list: []\r\n              },\r\n              '100': {\r\n                range: [100, 1000],\r\n                list: []\r\n              },\r\n              '0': {\r\n                range: [0, 100],\r\n                list: []\r\n              }\r\n            }\r\n            var itemCount = itemList.length;\r\n            for (var j = 0; j < itemCount; j++) {\r\n              var rowObj = itemList[j],\r\n                sumCount = rowObj.SUMOUTPUT;\r\n              for (var rangeKey in rangeMap) {\r\n                var rangeObj = rangeMap[rangeKey],\r\n                  rangeArr = rangeObj.range;\r\n                if (sumCount >= rangeArr[0] && sumCount < rangeArr[1]) {\r\n                  rangeObj.list.push(rowObj);\r\n                  break;\r\n                }\r\n              }\r\n            }\r\n            var newData = {};\r\n            for (var k in rangeMap) {\r\n              newData[k] = rangeMap[k].list;\r\n            }\r\n            item.data = newData;\r\n          }\r\n        }\r\n        callback.call(ctx, null, resultSet);\r\n      }, this);\r\n    }, this);\r\n  };\r\n  window.EMapServerV2 = window.EMapServerV2 || {};\r\n  window.EMapServerV2.RescueTeamService = Service;\r\n})(window);","(function (window) {\r\n  var Service = function (opts) {\r\n    var options = {\r\n    }\r\n    this.opts = jQuery.extend(true, options, opts);\r\n    this.commonService = new window.EMapServerV2.CommonService(opts);\r\n  }\r\n\r\n  /**\r\n   *\r\n   * @param callback\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getStatistics = function (callback, ctx) {\r\n    //去掉最后一类地质隐患点\r\n    var resourceKeys = this.opts.resourceKeys;\r\n    this.commonService.getStatistics(resourceKeys, {}, function (err, data) {\r\n      callback.call(ctx, null, data);\r\n    }, this);\r\n  }\r\n\r\n  /**\r\n   * 按条件统计\r\n   * @param opts\r\n   * @param opts.districtCode\r\n   * @param callback\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getStatisticsByFilter = function (opts, callback, ctx) {\r\n    var filter = {};\r\n    opts = opts || {};\r\n    filter.districtCode = opts.districtCode;\r\n    this.commonService.getStatistics(this.opts.resourceKeys, filter, function (err, data) {\r\n      callback.call(ctx, null, data);\r\n    }, this);\r\n  }\r\n\r\n  /**\r\n   * 查询列表数据\r\n   * @param opts\r\n   * @param opts.resourceKey，多个逗号分隔\r\n   * @param opts.pageSize\r\n   * @param opts.pageIndex\r\n   * @param opts.districtCode\r\n   * @param callback\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getDataList = function (opts, callback, ctx) {\r\n    opts = opts || {};\r\n    opts.flatTag = true;\r\n    this.commonService.getDataList(opts, function (err, data) {\r\n      callback.call(ctx, null, data);\r\n    }, this);\r\n  }\r\n\r\n  Service.prototype.getNearbyList = function (opts, callback, ctx) {\r\n    opts = opts || {};\r\n    opts.flatTag = true;\r\n    // opts.resourceKeys = this.opts.resourceKeys;\r\n    this.commonService.getNearbyList(opts, function (err, resultSet) {\r\n      callback.call(ctx, null, resultSet);\r\n    }, this);\r\n  }\r\n    //查询企业、防护目标、重要设施 2019年12月17日14:25:48\r\n    Service.prototype.getGroupCounts=function (dataA,types,cb) {\r\n        var queryOpts = {\r\n            //查询的表配置\r\n            querys: BigTypeCountQueryConfig[types],\r\n            //缓冲区\r\n            bufferList: [dataA]\r\n        }\r\n        this.servicemodule.bufferStatistics(queryOpts, function (err, data) {\r\n            if (err == null) {\r\n                if(cb){\r\n                    cb(data);\r\n                }\r\n            } else {\r\n                console.error('查询失败：' + err.message)\r\n            }\r\n        })\r\n    }\r\n    \r\n    //查询企业、防护目标、重要设施 2019年12月31日16:03:03\r\n    Service.prototype.getGroupCountsNoPoly=function (codes,types,cb) {\r\n      var queryOpts = {\r\n          //查询的表配置\r\n          querys: BigTypeCountQueryConfig[types],\r\n          //缓冲区\r\n          bufferList: [],\r\n          codes:codes\r\n      }\r\n      this.servicemodule.bufferStatistics(queryOpts, function (err, data) {\r\n          if (err == null) {\r\n              if(cb){\r\n                  cb(data);\r\n              }\r\n          } else {\r\n              console.error('查询失败：' + err.message)\r\n          }\r\n      })\r\n  }    \r\n  window.EMapServerV2 = window.EMapServerV2 || {};\r\n  window.EMapServerV2.ResourceQueryService = Service;\r\n})(window);","window.EMapServerV2.RiskQueryServiceConfig ={\r\n    'dz': {\r\n    \"tables\": [\r\n        {\r\n            \"id\":\"huapo\",\r\n            \"table\": \"BAS_GEOLOGICHAZARD\",\r\n            \"query\": {\r\n                \"tag.GEOHAZARDTYPECODE\":{\r\n                    \"$in\":[\"20104.0300\",\"20104.0200\",\"20104.0100\"]\r\n                }\r\n            },\r\n            \"fieldMap\":{\r\n                \"title\": \"HAZARDNAME\",\r\n                \"monitorType\":\"MONITMODE\",\r\n                \"monitorTel\":\"MONRESPPEROTEL\",\r\n                \"monitorMeasure\":\"TREATSTEP\",\r\n                \"dsBaseLevel\":\"HAZARDLEVELCODE\",\r\n                \"dsBaseType\":\"GEOHAZARDTYPECODE\",\r\n                \"dsBaseAdress\":\"ADDRESS\",\r\n                \"dsThreatenNum\":\"MAXPERSONNUM\",\r\n                \"dsThreatenObj\":\"THREATOBJ\",\r\n                \"dsThreatenProperty\":\"THREATWEALTH\"\r\n            }\r\n        }\r\n    ]\r\n},\r\n    'qy': {\r\n    \"tables\": [\r\n        {\r\n            \"//\": \"危化品企业\",\r\n            \"id\":\"hazardous\",\r\n            \"table\": \"ANJIAN_DAGCHEMENT\",\r\n            \"fieldMap\": {\r\n                \"title\": \"DAGCHEMENTNAME\",\r\n                \"longitude\": \"LONGITUDE\",\r\n                \"latitude\": \"LATITUDE\",\r\n                \"enBaseAdress\": \"ADDRESS\",\r\n                \"enBaseLevel\":\"RISKLEVEL\",\r\n                \"enBaseEnTel\": \"EMERASKTEL\",\r\n                \"enBaseStaffNum\": \"EMPNUM\"\r\n            }\r\n        },\r\n        {\r\n            \"//\": \"煤矿企业\",\r\n            \"id\":\"coalMine\",\r\n            \"table\": \"ANJIAN_COAL\",\r\n            \"fieldMap\": {\r\n                \"title\": \"COALNAME\",\r\n                \"enBaseAdress\": \"ADDRESS\",\r\n                \"enBaseLevel\":\"RISKLEVEL\",\r\n                \"enBaseEnTel\": \"CONTROLCENTERTEL\",\r\n                \"enBaseStaffNum\":\"WORERNUM\"\r\n            }\r\n        },\r\n        {\r\n            \"//\": \"烟花爆竹企业\",\r\n            \"id\":\"explosive\",\r\n            \"table\": \"ANJIAN_FIREWORKENT\",\r\n            \"fieldMap\": {\r\n                \"title\": \"FIREWORKENTNAME\",\r\n                \"enBaseEnTel\": \"TEL\",\r\n                \"enBaseAdress\": \"ADDRESS\",\r\n                \"longitude\": \"LONGITUDE\",\r\n                \"latitude\": \"LATITUDE\",\r\n                \"enBaseStaffNum\":\"WORKERNUM\"\r\n            }\r\n        },\r\n        {\r\n            \"//\": \"非煤矿山企业\",\r\n            \"id\":\"mine\",\r\n            \"table\": \"ANJIAN_TAILINGPOND\",\r\n            \"fieldMap\": {\r\n                \"title\": \"WKKMC\",\r\n                \"enBaseEnTel\": \"WKKFZRYDDH\",\r\n                \"enBaseAdress\": \"WKKDZMC\",\r\n                \"longitude\": \"LONGITUDE\",\r\n                \"latitude\": \"LATITUDE\",\r\n                \"respper\": \"WKKFZR\",\r\n                \"enBaseStaffNum\": \"TZZYRYSL\"\r\n            }\r\n        }\r\n    ]\r\n},\r\n    'ss': {\r\n    \"tables\": [\r\n        {\r\n            \"//\": \"水库\",\r\n            \"id\":\"reservoir\",\r\n            \"table\": \"BAS_RESERVOIR\",\r\n            \"fieldMap\": {\r\n                \"title\": \"NAME\",\r\n                \"CODE\": \"CODE\"\r\n            }\r\n        },\r\n        {\r\n            \"//\": \"桥梁\",\r\n            \"id\":\"tunnel\",\r\n            \"table\": \"BAS_BRIDGE\",\r\n            \"fieldMap\": {\r\n                \"title\": \"BRIDGENAME\",\r\n                \"inBaseEnTel\": \"RESPOTEL\",\r\n                \"inBaseAdress\": \"ADDRESS\",\r\n                \"respper\": \"RESPPER\",\r\n                \"BRIDGECATEGORYCODE\":\"BRIDGECATEGORYCODE\",\r\n                \"DISTRICTCODE\":\"DISTRICTNAME\"\r\n            }\r\n        }\r\n    ]\r\n}\r\n}","(function (window) {\r\n  var Service = function (opts) {\r\n    var options = {\r\n      //资源类型\r\n      resourceKeys: [\r\n        'NAH_GEO_GEOLOGICHAZ_P※01',//地质隐患\r\n        'mountaincollapse',\r\n        'landslide',\r\n        'debrisflow',\r\n        'miningcollapse',\r\n        'bottomcollapse',\r\n        'ANJIAN_DAGCHEMENT※DangerousChemical',//危化企业\r\n        'productionindustry',\r\n        'runeddustry',\r\n        'useddustry',\r\n        'otherdustry',\r\n        \r\n        'majordanger', //危险源\r\n        'tailingpond',//尾矿库\r\n        'firework',//烟花爆竹企业\r\n        'fireworkhouse',//烟花爆竹企业\r\n        'metalnonmetal',\r\n        'coal',\r\n        'ANJIAN_ENT_WHSMYHBZ※01',\r\n        'metallurgical',\r\n        'nonferrous',\r\n        'mechanical',\r\n        'dust',\r\n        'refrigeration',\r\n      ]\r\n    }\r\n    this.opts = jQuery.extend(true, options, opts);\r\n    // this.commonService = window.EMapServerV2.CommonService.getInstance(opts);\r\n    this.commonService = new window.EMapServerV2.CommonService(opts);\r\n  }\r\n\r\n  /**\r\n   * @param opts.resourceKeys\r\n   * @param callback\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getStatistics = function (opts, callback, ctx) {\r\n    //去掉最后一类地质隐患点\r\n    var resourceKeys = opts.resourceKeys || this.opts.resourceKeys.slice(0);\r\n    this.commonService.getStatistics(resourceKeys, {}, function (err, data) {\r\n      callback.call(ctx, null, data);\r\n    }, this);\r\n  }\r\n\r\n  /**\r\n   * 按条件统计\r\n   * @param opts\r\n   * @param opts.districtCode\r\n   * @param callback\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getStatisticsByFilter = function (opts, callback, ctx) {\r\n    var filter = {};\r\n    opts = opts || {};\r\n    filter.districtCode = opts.districtCode;\r\n    this.commonService.getStatistics(this.opts.resourceKeys, filter, function (err, data) {\r\n      callback.call(ctx, null, data);\r\n    }, this);\r\n  }\r\n\r\n  /**\r\n   * 查询列表数据\r\n   * @param opts\r\n   * @param opts.resourceKey，多个逗号分隔\r\n   * @param opts.pageSize\r\n   * @param opts.pageIndex\r\n   * @param opts.districtCode\r\n   * @param callback\r\n   * @param ctx\r\n   */\r\n  Service.prototype.getDataList = function (opts, callback, ctx) {\r\n    opts = opts || {};\r\n    opts.flatTag = true;\r\n    this.commonService.getDataList(opts, function (err, data) {\r\n      callback.call(ctx, null, data);\r\n    }, this);\r\n  }\r\n\r\n  Service.prototype.getNearbyList = function (opts, callback, ctx) {\r\n    opts = opts || {};\r\n    opts.flatTag = true;\r\n    opts.resourceKeys = this.opts.resourceKeys;\r\n    var radius = opts.config[\"ANJIAN_DAGCHEMENT※DangerousChemical\"].radius;\r\n    this.commonService.getEventData(opts.eventType, function (err, data) {\r\n      var config = opts.config || {};\r\n      //读取默认距离配置、传参的距离\r\n      var configRadius = data.tag.SEARCH_DIST;\r\n      if (configRadius != null && configRadius != '' && !isNaN(configRadius)) {\r\n        configRadius = parseFloat(configRadius) * 1000;\r\n      } else {\r\n        configRadius = 1000 * 1000;\r\n      }\r\n      for (var i = 0; i < this.opts.resourceKeys.length; i++) {\r\n        var resourceKey = this.opts.resourceKeys[i];\r\n        if (config.hasOwnProperty(resourceKey)) {\r\n          if (!config[resourceKey].radius) {\r\n            config[resourceKey].radius = configRadius;\r\n          }\r\n        } else {\r\n          config[resourceKey] = {\r\n            radius: configRadius\r\n          }\r\n        }\r\n      }\r\n      this.commonService.getNearbyList(opts, function (err, resultSet) {\r\n        var list = resultSet.list;\r\n        resultSet.radius = list[0] ? list[0].radius : radius;\r\n        //危化企业根据产量分类\r\n        for (var i = 0; i < list.length; i++) {\r\n          var item = list[i];\r\n          if (item && item.codeKey === this.opts.resourceKeys[0]) {\r\n            var itemList = item.data;\r\n            var rangeMap = {\r\n              '1000': {\r\n                range: [1000, Number.MAX_VALUE],\r\n                list: []\r\n              },\r\n              '100': {\r\n                range: [100, 1000],\r\n                list: []\r\n              },\r\n              '0': {\r\n                range: [0, 100],\r\n                list: []\r\n              }\r\n            }\r\n            var itemCount = itemList.length;\r\n            for (var j = 0; j < itemCount; j++) {\r\n              var rowObj = itemList[j],\r\n                sumCount = rowObj.SUMOUTPUT;\r\n              for (var rangeKey in rangeMap) {\r\n                var rangeObj = rangeMap[rangeKey],\r\n                  rangeArr = rangeObj.range;\r\n                if (sumCount >= rangeArr[0] && sumCount < rangeArr[1]) {\r\n                  rangeObj.list.push(rowObj);\r\n                  break;\r\n                }\r\n              }\r\n            }\r\n            var newData = {};\r\n            for (var k in rangeMap) {\r\n              newData[k] = rangeMap[k].list;\r\n            }\r\n            item.data = newData;\r\n          }\r\n        }\r\n        callback.call(ctx, null, resultSet);\r\n      }, this);\r\n    }, this);\r\n  }\r\n\r\n  window.EMapServerV2 = window.EMapServerV2 || {};\r\n  // 参考\r\n  window.EMapServerV2.RiskSourceService = Service;\r\n\r\n})(window);\r\n\r\n","(function (window) {\r\n    var util = {\r\n        /**\r\n         * @param opts\r\n         * @param opts.server\r\n         * @param opts.data\r\n         * @param cb\r\n         * @param ctx\r\n         */\r\n        aggregateMulti: function (opts, cb, ctx) {\r\n            jQuery.ajax({\r\n                url: opts.server + '/dataStatics/aggregateMulti',\r\n                type: 'post',\r\n                data: {\r\n                    eId: 'safety',\r\n                    data: JSON.stringify(opts.data)\r\n                },\r\n                dataType: 'json',\r\n                success: function (data) {\r\n                    if (data.success) {\r\n                        cb && cb.call(ctx, null, data.data);\r\n                    } else {\r\n                        cb && cb.call(ctx, new Error(data.msg))\r\n                    }\r\n                },\r\n                error: function (xhr, msg, err) {\r\n                    cb && cb.call(ctx, new Error(err))\r\n                }\r\n            })\r\n        },\r\n        /**\r\n         * @param opts\r\n         * @param opts.server\r\n         * @param opts.eId\r\n         * @param opts.data\r\n         * @param cb\r\n         * @param ctx\r\n         */\r\n        queryMulti: function (opts, cb, ctx) {\r\n            jQuery.ajax({\r\n                url: opts.server + '/dataOperate/queryMulti',\r\n                type: 'post',\r\n                data: {\r\n                    eId: opts.eId||'safety',\r\n                    data: JSON.stringify(opts.data)\r\n                },\r\n                dataType: 'json',\r\n                success: function (data) {\r\n                    if (data.success) {\r\n                        cb && cb.call(ctx, null, data.data);\r\n                    } else {\r\n                        cb && cb.call(ctx, new Error(data.msg))\r\n                    }\r\n                },\r\n                error: function (xhr, msg, err) {\r\n                    cb && cb.call(ctx, new Error(err))\r\n                }\r\n            })\r\n        },\r\n        //是否为空\r\n        isEmptyValue: function (value) {\r\n            return value == null\r\n                || value == undefined\r\n                || value == \"\"\r\n                || value == \" \";\r\n        },\r\n        R:6378137,\r\n        fullRange:{\r\n            type: 'Polygon',\r\n            coordinates: [\r\n                [\r\n                    [0, 0],\r\n                    [180, 0],\r\n                    [180, 90],\r\n                    [0, 90],\r\n                    [0, 0]\r\n                ]\r\n            ]\r\n        },\r\n        //计算经纬度距离\r\n        caculateDistancePoints: function (pt1, pt2) {\r\n            var R = util.R,\r\n                rad = Math.PI / 180,\r\n                lat1 = pt1[1] * rad,\r\n                lat2 = pt2[1] * rad,\r\n                a = Math.sin(lat1) * Math.sin(lat2) +\r\n                    Math.cos(lat1) * Math.cos(lat2) * Math.cos((pt2[0] - pt1[0]) * rad);\r\n            return R * Math.acos(Math.min(a, 1));\r\n        },\r\n        levelFn: function(opts) {\r\n            var ratio = opts.data.distance / opts.maxDistance;\r\n            var levelCode = null;\r\n            for (var k in opts.levels) {\r\n                if (ratio > opts.levels[k][0] && ratio <= opts.levels[k][1]) {\r\n                    levelCode = k;\r\n                    break;\r\n                }\r\n            }\r\n            return {\r\n                level:levelCode\r\n            };\r\n        },\r\n    };\r\n    /**\r\n     *\r\n     * @param opts\r\n     * @param opts.server\r\n     * @constructor\r\n     */\r\n    var Service = function (opts) {\r\n        this.opts = {\r\n            server: EMAP_CONFIG.common.mongoService,\r\n          };\r\n    }\r\n    /**\r\n     * 地震烈度范围的地质隐患统计\r\n     * @param opts\r\n     * @param opts.point {Array} [x,y] 事故点\r\n     * @param opts.geometry {GeoJSON} 烈度范围\r\n     * @param opts.resources {Object}\r\n     * @param opts.resources[k] {Object}\r\n     * @param opts.resources[k].tables {Array}\r\n     * @param opts.resources[k].tables[i].table\r\n     * @param opts.resources[k].tables[i].query\r\n     * @param opts.resources[k].tables[i].fieldMap\r\n     * @param opts.levels {Object} 级别映射表\r\n     * @param opts.levelFn {Function} 计算等级的方法\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getEqStatistics=function (opts, cb, ctx) {\r\n        var seperator='_ss_',\r\n            geoJsonReader=G.utils.GeometryUtil.getGeoJSONReader();\r\n        //aggregate\r\n        var jtsGeometry=geoJsonReader.read(util.fullRange).difference(\r\n                geoJsonReader.read(opts.geometry)),\r\n            pointJson={\r\n                \"type\": \"Point\",\r\n                \"coordinates\": opts.point\r\n            },\r\n            jtsPoint=geoJsonReader.read(pointJson);\r\n        var distanceLimit=jtsGeometry.distance(jtsPoint)*Math.PI*util.R/180;\r\n        var geoNear={\r\n            \"$geoNear\":{\r\n                \"spherical\": true,\r\n                \"near\": pointJson,\r\n                \"limit\": 1000*10000,\r\n                \"maxDistance\": distanceLimit,\r\n                \"distanceField\": \"distance\",\r\n                \"includeLocs\": \"geom\"\r\n            }\r\n        }\r\n        var resourceCol=jQuery.extend(true,{},opts.resources);\r\n        var aggregateList=[];\r\n        for(var resourceKey in resourceCol){\r\n            var resourceTables=resourceCol[resourceKey].tables;\r\n            for(var i=0;i<resourceTables.length;i++){\r\n                var tableObj=resourceTables[i];\r\n                var aggregateObj={},\r\n                    aggregate=[];\r\n                aggregate.push(geoNear);\r\n                aggregate.push({\r\n                    $match:{\r\n                        \"geom\":{\r\n                            \"$geoIntersects\":{\r\n                                \"$geometry\":opts.geometry\r\n                            }\r\n                        }\r\n                    }\r\n                })\r\n                if(tableObj.query&&Object.keys(tableObj.query).length>0){\r\n                    aggregate.push({\r\n                        $match:tableObj.query\r\n                    })\r\n                }\r\n                aggregate.push({\r\n                    \"$project\":{\r\n                        \"distance\":\"$distance\"\r\n                    }\r\n                })\r\n                aggregateObj.aggregate = aggregate;\r\n                aggregateObj.queryIndex=1;\r\n                aggregateObj.searchId = [resourceKey,tableObj.id].join(seperator);\r\n                aggregateObj.dataSetId = tableObj.table;\r\n                aggregateList.push(aggregateObj);\r\n            }\r\n        }\r\n        util.aggregateMulti({\r\n            server:this.opts.server,\r\n            data:aggregateList\r\n        },function (err, data) {\r\n            var resultObj={};\r\n            for(var resourceKey in resourceCol){\r\n                var resourceObj=resourceCol[resourceKey];\r\n                var resourceResult={\r\n                    total:0,\r\n                    levels:new Array(4)\r\n                }\r\n                for(var kk=0;kk<resourceResult.levels.length;kk++){\r\n                    resourceResult.levels[kk]={\r\n                        value:0\r\n                    }\r\n                }\r\n                resultObj[resourceKey]=resourceResult;\r\n                var resourceTables=resourceObj.tables;\r\n                for(var i=0;i<resourceTables.length;i++){\r\n                    var dataList=data[[resourceKey,resourceTables[i].id].join(seperator)][resourceTables[i].table];\r\n                    for(var j=0,dataLen=dataList.length;j<dataLen;j++){\r\n                        var levelResult=opts.levelFn({\r\n                            data:dataList[j],\r\n                            maxDistance:distanceLimit,\r\n                            levels:opts.levels\r\n                        })\r\n                        resourceResult.levels[levelResult.level].value++;\r\n                    }\r\n                    resourceResult.total+=dataLen;\r\n                }\r\n            }\r\n            cb&&cb.call(ctx,null,resultObj)\r\n        },this)\r\n    }\r\n\r\n    /**\r\n     * 地震烈度范围的地质隐患查询\r\n     * @param opts\r\n     * @param opts.point {Array} [x,y] 事故点\r\n     * @param opts.geometry {GeoJSON} 烈度范围\r\n     * @param opts.resources {Object}\r\n     * @param opts.resources[k] {Object}\r\n     * @param opts.resources[k].tables {Array}\r\n     * @param opts.resources[k].tables[i].table\r\n     * @param opts.resources[k].tables[i].query\r\n     * @param opts.resources[k].tables[i].fieldMap\r\n     * @param opts.levels {Object} 级别映射表\r\n     * @param opts.levelFn {Function} 计算等级的方法\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    Service.prototype.getEqData=function (opts, cb, ctx) {\r\n        var geoJsonReader=G.utils.GeometryUtil.getGeoJSONReader();\r\n        //aggregate\r\n        var jtsGeometry=geoJsonReader.read(util.fullRange).difference(\r\n            geoJsonReader.read(opts.geometry)),\r\n            pointJson={\r\n                \"type\": \"Point\",\r\n                \"coordinates\": opts.point\r\n            },\r\n            jtsPoint=geoJsonReader.read(pointJson);\r\n        var distanceLimit=jtsGeometry.distance(jtsPoint)*Math.PI*util.R/180;\r\n        var resourceCol=jQuery.extend(true,{},opts.resources);\r\n        var queryCol={};\r\n        for(var resourceKey in resourceCol){\r\n            var resourceTables=resourceCol[resourceKey].tables;\r\n            for(var i=0;i<resourceTables.length;i++){\r\n                var tableObj=resourceTables[i];\r\n                var queryItem={},\r\n                    query={\r\n                        $and:[\r\n                            {\r\n                                \"geom\":{\r\n                                    \"$geoIntersects\":{\r\n                                        \"$geometry\":opts.geometry\r\n                                    }\r\n                                }\r\n                            }\r\n                        ]\r\n                    };\r\n                queryItem.query=query;\r\n                if(tableObj.query){\r\n                    query.$and.push(tableObj.query)\r\n                }\r\n                var selectList=['geom','_id'];\r\n                if(tableObj.fieldMap){\r\n                    for(var field in tableObj.fieldMap){\r\n                        selectList.push('tag.'+tableObj.fieldMap[field])\r\n                    }\r\n                }\r\n                queryItem.select=selectList.join(' ');\r\n                queryCol[tableObj.table]=queryItem;\r\n            }\r\n        }\r\n        var resultHandler=function(resultdata){\r\n            var resultCol={};\r\n            for(var resourceKey in resourceCol){\r\n                var resultObj={};\r\n                resultCol[resourceKey]=resultObj;\r\n                for(var levelCode in opts.levels){\r\n                    resultObj[levelCode]=[];\r\n                }\r\n                var resourceTables=resourceCol[resourceKey].tables;\r\n                for(var i=0;i<resourceTables.length;i++){\r\n                    var tableObj=resourceTables[i];\r\n                    var dataList=resultdata[tableObj.table];\r\n                    for(var j=0,dataLen=dataList.length;j<dataLen;j++){\r\n                        var dataItem=dataList[j];\r\n                        var dataTemp={};\r\n                        dataTemp.id=dataItem._id;\r\n                        dataTemp.geom=dataItem.geom;\r\n                        dataTemp._table=tableObj.table;\r\n                        dataTemp._type=tableObj.id;\r\n                        //attributes\r\n                        if(tableObj.fieldMap){\r\n                            for(var field in tableObj.fieldMap){\r\n                                dataTemp[field]=dataItem.tag[tableObj.fieldMap[field]]||'';\r\n                            }\r\n                        }\r\n                        //\r\n                        dataTemp.distance=util.caculateDistancePoints(opts.point,dataItem.geom.coordinates);\r\n                        var levelResult=opts.levelFn({\r\n                            data:dataTemp,\r\n                            maxDistance:distanceLimit,\r\n                            levels:opts.levels\r\n                        })\r\n                        resultObj[levelResult.level].push(dataTemp);\r\n                    }\r\n                }\r\n            }\r\n            return resultCol;\r\n        }\r\n        util.queryMulti({\r\n            server:this.opts.server,\r\n            data:queryCol\r\n        },function (err, data) {\r\n            if(err==null){\r\n                cb&&cb.call(ctx,null,resultHandler(data,opts));\r\n            }else{\r\n                cb&&cb.call(ctx,err);\r\n            }\r\n        },this)\r\n    }\r\n    /**\r\n     * opts\r\n     * opts.type \r\n     * opts.point \r\n     * opts.geometry \r\n     */\r\n    Service.prototype.queryData=function (opts,cb) {\r\n        //按照类型查询数据\r\n        var query={};\r\n        query[opts.type] = window.EMapServerV2.RiskQueryServiceConfig[opts.type];\r\n        this.getEqData({\r\n            point: opts.point,\r\n            geometry: opts.geometry,\r\n            levelFn: util.levelFn,\r\n            levels:{\r\n                3: [0.7, 100000],//最大距离的0.7倍以上\r\n                2: [0.4, 0.7],//最大距离的0.4-0.7倍\r\n                1: [0.2, 0.4],//最大距离的0.2-0.4倍\r\n                0: [0, 0.2]//最大距离的0.2倍\r\n            },\r\n            resources: query\r\n        }, function (err, data) {\r\n            if (err == null) {\r\n                console.log('隐患点统计')\r\n                cb(data);\r\n            } else {\r\n                console.error(err);\r\n            }\r\n        })\r\n    }\r\n    window.EMapServerV2 = window.EMapServerV2 || {};\r\n    window.EMapServerV2.RiskTroubleQueryService = Service;\r\n})(window);","(function (window) {\r\n   var util = {\r\n        /**\r\n         * @param opts\r\n         * @param opts.server\r\n         * @param opts.eId\r\n         * @param opts.data\r\n         * @param cb\r\n         * @param ctx\r\n         */\r\n        aggregateMulti: function (opts, cb, ctx) {\r\n            var url = opts.server + '/dataStatics/aggregateMulti';\r\n            var confs = opts.data;\r\n            var isNearbyQuery = false;\r\n            if (confs && confs.length === 1) {\r\n                var conf = confs[0];\r\n                if (conf.near) {\r\n                    isNearbyQuery = true;\r\n                    url = opts.server + '/dataStatics/aggregatePageNear';\r\n                }\r\n            }\r\n            jQuery.ajax({\r\n                url: url,\r\n                type: 'post',\r\n                data: {\r\n                    eId: opts.eId,\r\n                    data: JSON.stringify(opts.data)\r\n                },\r\n                dataType: 'json',\r\n                success: function (data) {\r\n                    if (data.success) {\r\n                        var result = null;\r\n                        if (isNearbyQuery) {\r\n                            var searchId = conf.searchId;\r\n                            var datasetId = conf.dataSetId;\r\n                            if (Array.isArray(data.data) && searchId && datasetId) {\r\n                                result = {};\r\n                                result[searchId] = {};\r\n                                result[searchId][datasetId] = data.data;\r\n                            }\r\n                        } else {\r\n                            result = data.data;\r\n                        }\r\n                        cb && cb.call(ctx, null, result);\r\n                    } else {\r\n                        cb && cb.call(ctx, new Error(data.msg))\r\n                    }\r\n                },\r\n                error: function (xhr, msg, err) {\r\n                    cb && cb.call(ctx, new Error(err))\r\n                }\r\n            })\r\n        }      \r\n    };\r\n    //\r\n    var TABLE_PREFIX = 'user_safety_'\r\n    var DICT_SUFFIX = '_OBJ';\r\n    var EID = 'safety'\r\n    /**\r\n     *\r\n     * @param opts\r\n     * @param opts.server\r\n     */\r\n    var service = function (opts) {\r\n        this.options = {\r\n            server: opts.server,\r\n            eId: EID\r\n        }\r\n    };\r\n    /**\r\n     * @private\r\n     */\r\n    service.prototype.aggregateMulti = util.aggregateMulti;\r\n    /**\r\n     * 缓冲区范围内的总数统计\r\n     * @param opts\r\n     * @param [opts.districtCode] {string} 行政区划编码\r\n     * @param [opts.districtField] {string} 行政区划编码字段\r\n     * @param opts.keyWord\r\n     * @param opts.bufferList {Array} 缓冲范围，geojson格式数组，4326坐标系\r\n     * @param opts.querys {Object} 统计的数据集合\r\n     * @param opts.querys[i].table {String}  表名\r\n     * @param opts.querys[i].query {String} 属性过滤\r\n     * @param opts.querys[i].sumType {String} 计数类型，1=按照记录数统计，2=按照记录某些数值属性统计，默认为1\r\n     * @param opts.querys[i].sumFields {Array} 用于统计总和的字段名数组（数字类型），当sumType=2时必填\r\n     */\r\n    service.prototype.bufferStatistics = function (opts, cb, ctx) {\r\n        var bufferList = opts.bufferList || [],\r\n            bufferCount = bufferList.length,\r\n            querys = opts.querys || {};\r\n        var queryCol = [];\r\n        for (var queryId in querys) {\r\n            var queryObj = querys[queryId];\r\n            if(bufferCount>0)\r\n            {\r\n                for (var j = 0; j < bufferCount; j++) {\r\n                    var queryItem = {};\r\n                    queryItem.query = queryObj.query || {};\r\n                    queryItem.dataSetId = queryObj.table;\r\n                    queryItem.queryIndex = 1;\r\n                    queryItem.searchId = [queryId, j].join('_');\r\n                    var aggregates = [\r\n                        {\r\n                            \"$match\": {\r\n                                \"geom\": {\r\n                                    \"$geoIntersects\": {\r\n                                        \"$geometry\": bufferList[j]\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    ]\r\n                    var keyWords = [];\r\n                    if (Array.isArray(opts.keyWord)) {\r\n                        keyWords = opts.keyWord;\r\n                    } else if (typeof(opts.keyWord)=='string') {\r\n                        keyWords.push(opts.keyWord);\r\n                    }\r\n                    var self = this;\r\n                    keyWords.forEach(function(keyWord) {\r\n                        var kwMatch = self.getSearchMatch(keyWord, queryObj);\r\n                        if (kwMatch) {\r\n                            aggregates.push(kwMatch);\r\n                        }                     \r\n                    });\r\n                    queryObj.districtField = (queryObj.districtField || opts.districtField) || 'DISTRICTCODE';\r\n                    var districtMatch = this.getDistrictMatch(opts.districtCode, queryObj);\r\n                    if (districtMatch) {\r\n                        aggregates.push(districtMatch);\r\n                    }\r\n                    queryObj.defaultSumObj = {};\r\n                    if (queryObj.sumType == 2) {//按照字段统计\r\n                        if (queryObj.sumFields && queryObj.sumFields.length > 0) {\r\n                            var groupObj = {\r\n                                _id: null\r\n                            };\r\n                            var defaultSumObj = {};\r\n                            for (var q = 0; q < queryObj.sumFields.length; q++) {\r\n                                var sumField = queryObj.sumFields[q];\r\n                                groupObj[sumField] = {\r\n                                    $sum: '$tag.' + sumField\r\n                                }\r\n                                defaultSumObj[sumField] = 0;\r\n                            }\r\n                            aggregates.push({\r\n                                $group: groupObj\r\n                            })\r\n                            queryObj.defaultSumObj = defaultSumObj;\r\n                        } else {\r\n                            throw(new Error(queryObj.table + '：sumFields必须为正确的字段名数组！'))\r\n                        }\r\n                    } else {\r\n                        queryObj.defaultSumObj.count = 0;\r\n                        aggregates.push({\r\n                            $count: 'count'\r\n                        })\r\n                    }\r\n                    queryItem.aggregate = aggregates;\r\n                    queryCol.push(queryItem)\r\n                }\r\n            }\r\n            else\r\n            {\r\n                if(opts.codes&&opts.codes.length>0)\r\n                {\r\n                    var queryItem = {};\r\n                    // queryItem.query = queryObj.query || {};\r\n                    queryItem.dataSetId = queryObj.table;\r\n                    queryItem.queryIndex = 0;\r\n                    queryItem.searchId = [queryId, 0].join('_');\r\n                    var aggregates = [];\r\n                    if (queryObj.query) {\r\n                        aggregates.push({\r\n                            $match: queryObj.query,\r\n                        });\r\n                    }\r\n                    queryObj.districtField = (queryObj.districtField || opts.districtField) || 'DISTRICTCODE';\r\n                    var districtMatch = this.getDistrictMatch(opts.codes, queryObj);\r\n                    if (districtMatch) {\r\n                        aggregates.push(districtMatch);\r\n                    }\r\n\r\n                    var keyWords = [];\r\n                    if (Array.isArray(opts.keyWord)) {\r\n                        keyWords = opts.keyWord;\r\n                    } else if (typeof(opts.keyWord)=='string') {\r\n                        keyWords.push(opts.keyWord);\r\n                    }\r\n                    var self = this;\r\n                    keyWords.forEach(function(keyWord) {\r\n                        var kwMatch = self.getSearchMatch(keyWord, queryObj);\r\n                        if (kwMatch) {\r\n                            aggregates.push(kwMatch);\r\n                        }                     \r\n                    }); \r\n                                      \r\n                    queryObj.defaultSumObj = {};\r\n                    if (queryObj.sumType == 2) {//按照字段统计\r\n                        if (queryObj.sumFields && queryObj.sumFields.length > 0) {\r\n                            var groupObj = {\r\n                                _id: null\r\n                            };\r\n                            var defaultSumObj = {};\r\n                            for (var q = 0; q < queryObj.sumFields.length; q++) {\r\n                                var sumField = queryObj.sumFields[q];\r\n                                groupObj[sumField] = {\r\n                                    $sum: '$tag.' + sumField\r\n                                }\r\n                                defaultSumObj[sumField] = 0;\r\n                            }\r\n                            aggregates.push({\r\n                                $group: groupObj\r\n                            })\r\n                            queryObj.defaultSumObj = defaultSumObj;\r\n                        } else {\r\n                            throw(new Error(queryObj.table + '：sumFields必须为正确的字段名数组！'))\r\n                        }\r\n                    } else {\r\n                        queryObj.defaultSumObj.count = 0;\r\n                        aggregates.push({\r\n                            $count: 'count'\r\n                        })\r\n                    }\r\n                    queryItem.aggregate = aggregates;\r\n                    queryCol.push(queryItem)\r\n                }\r\n            }\r\n        }\r\n        util.aggregateMulti({\r\n            server: this.options.server,\r\n            eId: this.options.eId,\r\n            async : false,\r\n            data: queryCol\r\n        }, function (err, data) {\r\n            if (err == null) {\r\n                var dataSet = data;\r\n                var resultSet = [];\r\n                if(bufferCount>0)\r\n                {\r\n                    for (var j = 0; j < bufferCount; j++) {\r\n                        var bufferResult = {};\r\n                        for (var queryId in querys) {\r\n                            var searchId = [queryId, j].join('_');\r\n                            var countResult = dataSet[searchId];\r\n                            if (countResult) {\r\n                                var sumObj = countResult[Object.keys(countResult)[0]][0] || querys[queryId].defaultSumObj;\r\n                                delete sumObj._id;\r\n                                bufferResult[queryId] = sumObj;\r\n                            } else {\r\n                                bufferResult[queryId] = 0\r\n                            }\r\n                        }\r\n                        resultSet.push(bufferResult);\r\n                    }\r\n                }\r\n                else\r\n                {\r\n                    var bufferResult = {};\r\n                    for (var queryId in querys) {\r\n                        var searchId = [queryId, 0].join('_');\r\n                        var countResult = dataSet[searchId];\r\n                        if (countResult) {\r\n                            var sumObj = countResult[Object.keys(countResult)[0]][0] || querys[queryId].defaultSumObj;\r\n                            delete sumObj._id;\r\n                            bufferResult[queryId] = sumObj;\r\n                        } else {\r\n                            bufferResult[queryId] = 0\r\n                        }\r\n                    }\r\n                    resultSet.push(bufferResult);\r\n                }\r\n                cb && cb.call(ctx, null, resultSet);\r\n            } else {\r\n                cb && cb.call(ctx, err)\r\n            }\r\n        }, this)\r\n    };\r\n\r\n    /**\r\n     * 缓冲区范围内的数据查询\r\n     * @param opts\r\n     * @param opts.id id\r\n     * @param opts.keyWord 关键字\r\n     * @param opts.point {Array} 事发地点经纬度坐标 [x,y]\r\n     * @param opts.maxDistance {Number} 查询的范围半径，单位米，当buffer指定时，此属性无效\r\n     * @param opts.buffer {Object} 指定缓冲范围，geojson格式，4326坐标系\r\n     * @param opts.limit {Number} 每类数据查询结果记录数量限制，默认为100000\r\n     * @param opts.distanceField {String} 距离属性名\r\n     * @param opts.querys {Array} 查询的数据集合\r\n     * @param opts.querys[i].table {String}  表名\r\n     * @param opts.querys[i].maxDistance {Number} 当前数据查询的范围半径，单位米，默认等于opts.maxDistance\r\n     * @param opts.querys[i].limit {Number} 当前数据查询的记录数量限制，默认等于opts.limit\r\n     * @param opts.querys[i].query {String} 属性过滤\r\n     * @param opts.querys[i].fieldMap {String} 字段映射\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    service.prototype.bufferQuery = function (opts, cb, ctx) {\r\n        var defaultLimit = 400000;\r\n        var defaults = {\r\n            limit: defaultLimit,\r\n            distanceField: '_distance'\r\n        }\r\n        var options = jQuery.extend(true, defaults, opts || {});\r\n        if (options.buffer) {\r\n            options.maxDistance = 3000 * 1000;\r\n        }\r\n        var limit = options.limit,\r\n            maxDistance = options.maxDistance,\r\n            distanceField = options.distanceField;\r\n        var queryCol = [];\r\n        for (var queryId in options.querys) {\r\n            var queryObj = options.querys[queryId];\r\n            var queryItem = {};\r\n            var aggregates = [];\r\n            //geonear\r\n            //去除geonear条件，改用aggregatePageNear接口，解决mongo管道限制\r\n            \r\n            // if (options.point) {\r\n            //     var geoNear = {\r\n            //         \"spherical\": true,\r\n            //         \"near\": {\r\n            //             \"type\": \"Point\",\r\n            //             \"coordinates\": options.point\r\n            //         },\r\n            //         \"limit\": queryObj.limit || limit || defaultLimit,\r\n            //         \"maxDistance\": queryObj.maxDistance || maxDistance,\r\n            //         \"distanceField\": distanceField,\r\n            //         \"includeLocs\": \"geom\"\r\n            //     };\r\n            //     aggregates.push({\r\n            //         \"$geoNear\": geoNear\r\n            //     });                \r\n            // }\r\n            if (options.id) {\r\n                aggregates.push(this.getIdMatch(opts.id));\r\n            }\r\n            queryObj.districtField = queryObj.districtField || 'DISTRICTCODE';\r\n            var districtMatch = this.getDistrictMatch(opts.districtCode, queryObj);\r\n            if (districtMatch) {\r\n                aggregates.push(districtMatch);\r\n            }        \r\n            var keyWords = [];\r\n            if (Array.isArray(opts.keyWord)) {\r\n                keyWords = opts.keyWord;\r\n            } else if (typeof(opts.keyWord)=='string') {\r\n                keyWords.push(opts.keyWord);\r\n            }\r\n            var self = this;\r\n            keyWords.forEach(function(keyWord) {\r\n                var kwMatch = self.getSearchMatch(keyWord, queryObj);\r\n                if (kwMatch) {\r\n                    aggregates.push(kwMatch);\r\n                }                     \r\n            });            \r\n            if (options.near) {\r\n                queryItem.near = options.near;\r\n                queryItem.distanceField = options.distanceField;\r\n            }\r\n            if (options.paging && options.pageSize && options.pageIndex) {\r\n                queryItem.paging = options.paging;\r\n                queryItem.pageSize = options.pageSize;\r\n                queryItem.pageIndex = options.pageIndex;\r\n            }               \r\n            //属性过滤\r\n            if (queryObj.query && Object.keys(queryObj.query).length > 0) {\r\n                aggregates.push({\r\n                    \"$match\": queryObj.query\r\n                })\r\n            }\r\n            //缓冲过滤\r\n            if (options.buffer) {\r\n                aggregates.push({\r\n                    \"$match\": {\r\n                        \"geom\": {\r\n                            \"$geoIntersects\": {\r\n                                \"$geometry\": options.buffer\r\n                            }\r\n                        }\r\n                    }\r\n                })\r\n            }\r\n            //\r\n            var projectMap = {\r\n                'geom': '$geom'\r\n            };\r\n            projectMap[distanceField] = '$' + distanceField;\r\n            //排序\r\n            var sorts=queryObj.sorts;\r\n            if (sorts) {\r\n                    aggregates.push({\r\n                        \"$sort\": sorts\r\n                    });\r\n            }\r\n            //关联\r\n            var relations = queryObj.relations || [];\r\n            var relProjectSet = {};\r\n            if (relations.length > 0) {\r\n                for (var kk = 0; kk < relations.length; kk++) {\r\n                    var relationObj = relations[kk]\r\n                    aggregates.push({\r\n                        \"$lookup\": {\r\n                            \"from\": TABLE_PREFIX + relationObj.table,\r\n                            \"localField\": \"tag.\" + relationObj.localField,\r\n                            \"foreignField\": \"tag.\" + relationObj.foreignField,\r\n                            \"as\": relationObj.localField\r\n                        }\r\n                    });\r\n                    aggregates.push({\r\n                        \"$unwind\": {\r\n                            \"path\": \"$\" + relationObj.localField,\r\n                            \"preserveNullAndEmptyArrays\": true\r\n                        }\r\n                    });\r\n                    relProjectSet[relationObj.localField] = '$' + relationObj.localField + '.tag'\r\n                }\r\n            }\r\n            //字段映射\r\n            var fieldMap = queryObj.fieldMap || {};\r\n            for (var relField in relProjectSet) {\r\n                var alias = 'tag.' + relField;\r\n                for (var fieldName in fieldMap) {\r\n                    if (fieldMap[fieldName] === relField) {\r\n                        alias = 'tag.' + fieldName + DICT_SUFFIX\r\n                    }\r\n                }\r\n                projectMap[alias] = relProjectSet[relField]\r\n            }\r\n            for (var fieldName in fieldMap) {\r\n                if (fieldMap[fieldName].indexOf('.')>=0){\r\n                    projectMap['tag.' + fieldName] = '$' + fieldMap[fieldName];\r\n                } else{\r\n                    projectMap['tag.' + fieldName] = '$tag.' + fieldMap[fieldName];\r\n                }\r\n            }\r\n            aggregates.push({\r\n                \"$project\": projectMap\r\n            })\r\n            //\r\n            queryItem.dataSetId = queryObj.table;\r\n            queryItem.queryIndex = 1;\r\n            queryItem.searchId = queryId;\r\n            queryItem.aggregate = aggregates;\r\n            //重大风险加筛选 by lsl\r\n            if(queryObj.query){\r\n                queryItem.query = queryObj.query;\r\n            }\r\n            queryCol.push(queryItem);\r\n        }\r\n        var eId;\r\n        if(options.eId)\r\n        {\r\n            eId=options.eId;\r\n        }\r\n        else\r\n        {\r\n            eId=this.options.eId;\r\n        }\r\n        util.aggregateMulti({\r\n            server: this.options.server,\r\n            eId: eId,\r\n            data: queryCol\r\n        }, function (err, dataSet) {\r\n            if (err == null) {\r\n                var resultSet = {};\r\n                for (var queryId in options.querys) {\r\n                    var eachData = dataSet[queryId];\r\n                    var list = eachData[Object.keys(eachData)[0]];\r\n                    resultSet[queryId] = list;\r\n                }\r\n                cb && cb.call(ctx, null, resultSet);\r\n            } else {\r\n                cb && cb.call(ctx, err)\r\n            }\r\n        }, this)\r\n    };\r\n    /**\r\n     * 主键（id）筛选\r\n     * @param id\r\n     * @param [idField]\r\n     */\r\n    service.prototype.getIdMatch = function (id, idField) {\r\n        if (!idField) {\r\n        idField = '_id';\r\n        }\r\n        if(id)\r\n        {\r\n            var query={};\r\n            var filter={};\r\n            filter['$regex'] = \"^\" + id + \"$\";\r\n            query[idField]=filter;\r\n            var idquery={\r\n                $match: query\r\n            };\r\n            return idquery;\r\n        }\r\n        else\r\n        {\r\n        return null;\r\n        }\r\n    }\r\n  /**\r\n   * 拼接关键字条件--预留方法\r\n   * @param kw\r\n   * @param resource\r\n   */\r\n  service.prototype.getSearchMatch = function (kw, resource) {\r\n    if(kw)\r\n    {\r\n        var query={};\r\n        var filter={};\r\n        filter['$regex']=\"^.*\" + kw + \".*$\";\r\n        query['tag.' + resource.keyWordFields]=filter;\r\n        var kwquery={\r\n            $match: query\r\n        };\r\n        return kwquery;\r\n    }\r\n    else\r\n    {\r\n      return null;\r\n    }\r\n  }    \r\n    /**\r\n     * 查询详情\r\n     * @param opts\r\n     * @param opts.table {String} 表名\r\n     * @param opts.dataId {String} 数据id\r\n     * @param opts.relations {Array} 关联\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    service.prototype.queryById = function (opts, cb, ctx) {\r\n        var queryCol = [],\r\n            queryItem = {},\r\n            aggregates = [];\r\n        //\r\n        aggregates.push({\r\n            $match: {\r\n                \"_id\": opts.dataId\r\n            }\r\n        })\r\n        //\r\n        var projectMap = {\r\n            'geom': '$geom',\r\n            'tag': '$tag'\r\n        };\r\n        //关联\r\n        var relations = opts.relations || [];\r\n        if (relations.length > 0) {\r\n            for (var kk = 0; kk < relations.length; kk++) {\r\n                var relationObj = relations[kk];\r\n                aggregates.push({\r\n                    \"$lookup\": {\r\n                        \"from\": TABLE_PREFIX + relationObj.table,\r\n                        \"localField\": \"tag.\" + relationObj.localField,\r\n                        \"foreignField\": \"tag.\" + relationObj.foreignField,\r\n                        \"as\": relationObj.localField\r\n                    }\r\n                });\r\n                aggregates.push({\r\n                    \"$unwind\": {\r\n                        \"path\": \"$\" + relationObj.localField,\r\n                        \"preserveNullAndEmptyArrays\": true\r\n                    }\r\n                });\r\n                projectMap[relationObj.localField] = '$' + relationObj.localField + '.tag'\r\n            }\r\n            aggregates.push({\r\n                '$project': projectMap\r\n            })\r\n        }\r\n        //\r\n        queryItem.dataSetId = opts.table;\r\n        queryItem.queryIndex = 1;\r\n        queryItem.searchId = 'query';\r\n        queryItem.aggregate = aggregates;\r\n        queryCol.push(queryItem)\r\n        util.aggregateMulti({\r\n            server: this.options.server,\r\n            eId: this.options.eId,\r\n            data: queryCol\r\n        }, function (err, dataSet) {\r\n            if (err == null) {\r\n                var resultObj = dataSet.query;\r\n                var resultSet = resultObj[opts.table][0];\r\n                var tag = resultSet.tag;\r\n                for (var kk in tag) {\r\n                    if (resultSet.hasOwnProperty(kk)) {\r\n                        tag[kk + DICT_SUFFIX] = resultSet[kk];\r\n                        delete resultSet[kk];\r\n                    }\r\n                }\r\n                cb && cb.call(ctx, null, resultSet);\r\n            } else {\r\n                cb && cb.call(ctx, err)\r\n            }\r\n        }, this)\r\n    };\r\n\r\n    service.prototype.queryByAttr = function (opts, cb, ctx) {\r\n        var queryCol = [],\r\n            queryItem = {},\r\n            aggregates = [];\r\n        //\r\n        if(opts.dataId)\r\n        {\r\n            aggregates.push({\r\n                $match: {\r\n                    \"tag.CLASID\": opts.dataId\r\n                }\r\n            })\r\n        }\r\n\r\n        //\r\n        var projectMap = {\r\n            'geom': '$geom',\r\n            'tag': '$tag'\r\n        };\r\n        //关联\r\n        var relations = opts.relations || [];\r\n        if (relations.length > 0) {\r\n            for (var kk = 0; kk < relations.length; kk++) {\r\n                var relationObj = relations[kk];\r\n                aggregates.push({\r\n                    \"$lookup\": {\r\n                        \"from\": TABLE_PREFIX + relationObj.table,\r\n                        \"localField\": \"tag.\" + relationObj.localField,\r\n                        \"foreignField\": \"tag.\" + relationObj.foreignField,\r\n                        \"as\": relationObj.localField\r\n                    }\r\n                });\r\n                aggregates.push({\r\n                    \"$unwind\": {\r\n                        \"path\": \"$\" + relationObj.localField,\r\n                        \"preserveNullAndEmptyArrays\": true\r\n                    }\r\n                });\r\n                projectMap[relationObj.localField] = '$' + relationObj.localField + '.tag'\r\n            }\r\n            aggregates.push({\r\n                '$project': projectMap\r\n            })\r\n        }\r\n        //\r\n        queryItem.dataSetId = opts.table;\r\n        queryItem.queryIndex = 10;\r\n        queryItem.searchId = 'query';\r\n        queryItem.aggregate = aggregates;\r\n        queryCol.push(queryItem)\r\n        util.aggregateMulti({\r\n            server: this.options.server,\r\n            eId: this.options.eId,\r\n            data: queryCol\r\n        }, function (err, dataSet) {\r\n            if (err == null) {\r\n                var resultObj = dataSet.query;\r\n                var resultSet = resultObj[opts.table];\r\n                // var tag = resultSet.tag;\r\n                // for (var kk in tag) {\r\n                //     if (resultSet.hasOwnProperty(kk)) {\r\n                //         tag[kk + DICT_SUFFIX] = resultSet[kk];\r\n                //         delete resultSet[kk];\r\n                //     }\r\n                // }\r\n                cb && cb.call(ctx, null, resultSet);\r\n            } else {\r\n                cb && cb.call(ctx, err)\r\n            }\r\n        }, this)\r\n    };\r\n\r\n\r\n    /**\r\n     * 缓冲区范围内的数据查询\r\n     * @param opts\r\n     * @param opts.point {Array} 事发地点经纬度坐标 [x,y]\r\n     * @param opts.distanceField {String} 距离属性名\r\n     * @param opts.materialNeed　{Object} 物资需求\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    service.prototype.bufferQueryMaterial = function (opts, cb, ctx) {\r\n        opts.distanceField = opts.distanceField || '_distance'\r\n        var queryCol = [],\r\n            queryItem = {};\r\n        var aggregates = [\r\n            {\r\n                \"$geoNear\": {\r\n                    \"spherical\": true,\r\n                    \"near\": {\r\n                        \"type\": \"Point\",\r\n                        \"coordinates\": opts.point\r\n                    },\r\n                    \"limit\": 100000,\r\n                    \"maxDistance\": 10000000,\r\n                    \"distanceField\": opts.distanceField,\r\n                    \"includeLocs\": \"geom\"\r\n                }\r\n            },\r\n            {\r\n                $lookup: {\r\n                    \"from\": \"user_safety_JC_MATERIAL_INFO\",\r\n                    \"localField\": \"_id\",\r\n                    \"foreignField\": \"tag.REPERTORYID\",\r\n                    \"as\": \"materials\"\r\n                }\r\n            }\r\n        ]\r\n        queryItem.dataSetId = 'JC_REPERTORY';\r\n        queryItem.queryIndex = 1;\r\n        queryItem.searchId = 'query';\r\n        queryItem.aggregate = aggregates;\r\n        queryCol.push(queryItem)\r\n        util.aggregateMulti({\r\n            server: this.options.server,\r\n            eId: this.options.eId,\r\n            data: queryCol\r\n        }, function (err, dataSet) {\r\n            if (err == null) {\r\n                var reposityList = dataSet.query[Object.keys(dataSet.query)[0]];\r\n                var resultSet = {};\r\n                //计算提取物资提取\r\n                var materialNeed = opts.materialNeed || {};\r\n                for (var materialId in materialNeed) {\r\n                    var dispatchResult = this._caculateDispatchResult(\r\n                        materialId,\r\n                        materialNeed[materialId],\r\n                        reposityList,\r\n                        {\r\n                            attachKey: 'materials',\r\n                            codeKey: 'MATERIALTYPE',\r\n                            numKey: 'MATERIALNUM',\r\n                            distanceField: opts.distanceField\r\n                        }\r\n                    )\r\n                    resultSet[materialId] = dispatchResult;\r\n                }\r\n                cb && cb.call(ctx, null, resultSet);\r\n            } else {\r\n                cb && cb.call(ctx, err)\r\n            }\r\n        }, this)\r\n    };\r\n\r\n    /**\r\n     * 提取调配\r\n     * @param code\r\n     * @param needCount\r\n     * @param list\r\n     * @private\r\n     */\r\n    service.prototype._caculateDispatchResult = function (code, needCount, list, opts) {\r\n        var provideList = [],\r\n            fulfillCount = 0,\r\n            total = list.length,\r\n            attachKey = opts.attachKey,\r\n            codeKey = opts.codeKey,\r\n            numKey = opts.numKey;\r\n        for (var i = 0; i < total; i++) {\r\n            var item = list[i];\r\n            var attachList = item[attachKey] || [],\r\n                attachCount = attachList.length,\r\n                thisItem = {\r\n                    _id: item._id,\r\n                    geom: item.geom,\r\n                    dis: item[opts.distanceField],\r\n                    tag: item.tag\r\n                };\r\n            //遍历装备物资\r\n            for (var j = 0; j < attachCount; j++) {\r\n                var attachItem = attachList[j];\r\n                if (attachItem && attachItem.tag\r\n                    && attachItem.tag[codeKey] == code) {\r\n                    var attachNum = attachItem.tag[numKey],\r\n                        promiseCount = fulfillCount + attachNum;\r\n                    if (!attachNum || isNaN(attachNum)) {\r\n                        continue;\r\n                    }\r\n                    if (promiseCount < needCount) {\r\n                        thisItem.num = attachNum;\r\n                    } else {\r\n                        thisItem.num = needCount - fulfillCount;\r\n                    }\r\n                    fulfillCount += thisItem.num;\r\n                    provideList.push(thisItem);\r\n                    break;\r\n                }\r\n            }\r\n            if (fulfillCount >= needCount) {\r\n                break;\r\n            }\r\n        }\r\n        var result={\r\n            num:fulfillCount,\r\n            list:provideList\r\n        };\r\n        return result;\r\n    };\r\n\r\n    /**\r\n     * 拼接行政区划条件\r\n     * @param districtCode\r\n     * @param resource\r\n     * @param resource.districtField 行政区划字段名\r\n     * @param resource.districtKey 可选，默认为空\r\n     */\r\n    service.prototype.getDistrictMatch = function (districtCode, resource) {\r\n        var match = null;\r\n        if (districtCode && districtCode !== '000000' && resource.districtField) {\r\n            var districtCodes = districtCode.split(','),\r\n                districtField = resource.districtField;\r\n            var or = [],\r\n                districtKey = null;\r\n            if (resource.districtKey) {\r\n                districtKey = resource.districtKey;\r\n            } else {\r\n                districtKey = 'tag.' + districtField;\r\n            }\r\n            for (var i = 0; i < districtCodes.length; i++) {\r\n                var districtCode = districtCodes[i];\r\n                if (districtCode) {\r\n                    var eachFilter = {};\r\n                    eachFilter[districtKey] = {\r\n                        $regex: getDistrictRegex(districtCode)\r\n                    };\r\n                    or.push(eachFilter);\r\n                }\r\n            }\r\n            match = {\r\n                $match: {\r\n                    $or: or\r\n                }\r\n            }\r\n        } else {\r\n            var matchObj = {};\r\n            // matchObj['tag.'+resource.districtField] = {\r\n            //     $regex: '.*',\r\n            // };\r\n            match = {\r\n                $match: matchObj,\r\n            }\r\n            console.debug('ignore district filter');\r\n        }\r\n        return match;\r\n\r\n        function getDistrictRegex(code) {\r\n            var c = code.substr(0, 6);\r\n            if ('000000' == c) {//全国不过滤\r\n                c = '.*';\r\n            } else if (/^\\d{2}0000$/.test(c)) {\r\n                c = c.substr(0, 2) + '.*';\r\n            } else if (/^\\d{4}00$/.test(c)) {\r\n                c = c.substr(0, 4) + '.*';\r\n            } else {//灾情信息员code都是12位\r\n                c = c + '.*'\r\n            }\r\n            return '^' + c + '$';\r\n        }\r\n    }    \r\n    window.EMapServerV2 = window.EMapServerV2 || {};\r\n    // 参考\r\n    window.EMapServerV2.ServiceModule = service;\r\n})(window);","(function(window) {\r\n    window.EMapServerV2 = window.EMapServerV2 || {};\r\n    // 参考\r\n    window.EMapServerV2.bufferService = {};\r\n    var EID = 'safety'\r\n    var CONSTS = {\r\n        \"EMPTY_STR\": \"-\",\r\n        \"TEAM\": \"队伍\",\r\n        \"EQUIPMENT\": \"装备\",\r\n        \"CONTACT\": \"CONTACT\",\r\n        \"CONTACT_LABEL\": \"负责人\",\r\n        \"TEL\": \"TEL\",\r\n        \"TEL_LABEL\": \"负责人电话\",\r\n        \"BELONG_RESCUE\": \"所属救援队伍\"\r\n    }\r\n    var util = {\r\n        /**\r\n         * 获取元数据\r\n         * @param opts\r\n         * @param opts\r\n         * @param opts.server\r\n         * @param opts.eId\r\n         * @param opts.tableNames {Array}\r\n         * @param cb\r\n         * @param ctx\r\n         */\r\n        queryDataSet: function(opts, cb, ctx) {\r\n            var query = {\r\n                \"dataSetId\": {\r\n                    \"$in\": opts.tableNames\r\n                }\r\n            };\r\n            jQuery.ajax({\r\n                url: opts.server + '/dataSet/query',\r\n                type: 'post',\r\n                data: {\r\n                    eId: opts.eId,\r\n                    query: JSON.stringify(query)\r\n                },\r\n                dataType: 'json',\r\n                success: function(data) {\r\n                    if (data.success) {\r\n                        cb && cb.call(ctx, null, data.data);\r\n                    } else {\r\n                        cb && cb.call(ctx, new Error(data.msg))\r\n                    }\r\n                },\r\n                error: function(xhr, msg, err) {\r\n                    cb && cb.call(ctx, new Error(err))\r\n                }\r\n            });\r\n\r\n        },\r\n        /**\r\n         * @param opts\r\n         * @param opts.server\r\n         * @param opts.eId\r\n         * @param opts.data\r\n         * @param cb\r\n         * @param ctx\r\n         */\r\n        aggregateMulti: function(opts, cb, ctx) {\r\n            jQuery.ajax({\r\n                url: opts.server + '/dataStatics/aggregateMulti',\r\n                type: 'post',\r\n                data: {\r\n                    eId: opts.eId,\r\n                    data: JSON.stringify(opts.data)\r\n                },\r\n                dataType: 'json',\r\n                success: function(data) {\r\n                    if (data.success) {\r\n                        cb && cb.call(ctx, null, data.data);\r\n                    } else {\r\n                        cb && cb.call(ctx, new Error(data.msg))\r\n                    }\r\n                },\r\n                error: function(xhr, msg, err) {\r\n                    cb && cb.call(ctx, new Error(err))\r\n                }\r\n            })\r\n        },\r\n        /**\r\n         * @param opts\r\n         * @param opts.server\r\n         * @param opts.eId\r\n         * @param opts.data\r\n         * @param cb\r\n         * @param ctx\r\n         */\r\n        queryMulti: function(opts, cb, ctx) {\r\n            jQuery.ajax({\r\n                url: opts.server + '/dataOperate/queryMulti',\r\n                type: 'post',\r\n                data: {\r\n                    eId: opts.eId,\r\n                    data: JSON.stringify(opts.data)\r\n                },\r\n                dataType: 'json',\r\n                success: function(data) {\r\n                    if (data.success) {\r\n                        cb && cb.call(ctx, null, data.data);\r\n                    } else {\r\n                        cb && cb.call(ctx, new Error(data.msg))\r\n                    }\r\n                },\r\n                error: function(xhr, msg, err) {\r\n                    cb && cb.call(ctx, new Error(err))\r\n                }\r\n            })\r\n        },\r\n        //计算经纬度距离\r\n        caculateDistancePoints: function(pt1, pt2) {\r\n            var R = 6378137,\r\n                rad = Math.PI / 180,\r\n                lat1 = pt1[1] * rad,\r\n                lat2 = pt2[1] * rad,\r\n                a = Math.sin(lat1) * Math.sin(lat2) +\r\n                Math.cos(lat1) * Math.cos(lat2) * Math.cos((pt2[0] - pt1[0]) * rad);\r\n            return R * Math.acos(Math.min(a, 1));\r\n        },\r\n        //计算距离\r\n        caculateDistance: function(point, geojson) {\r\n            var geom = g2.sfs.GeometryFactory.createGeometryFromGeoJson(geojson);\r\n            geom.spatialReference = 4326;\r\n            var point2d = util.projectService.transform(\r\n                new g2.sfs.Point({\r\n                    x: point[0],\r\n                    y: point[1],\r\n                    spatialReference: 4326\r\n                }), 3857);\r\n            var geom2d = util.projectService.transform(geom, 3857);\r\n            var jtsPoint = util.geoJsonReader.read(point2d.asGeoJson())\r\n            var jtsGeom = util.geoJsonReader.read(geom2d.asGeoJson())\r\n            return jtsPoint.distance(jtsGeom)\r\n        },\r\n        isObject: function(obj) {\r\n            return Object.prototype.toString.call(obj) == '[object Object]'\r\n        },\r\n        isString: function(obj) {\r\n            return Object.prototype.toString.call(obj) == '[object String]'\r\n        },\r\n        //处理空值\r\n        handleEmptyValue: function(obj) {\r\n            if (obj) {\r\n                for (var attrName in obj) {\r\n                    var attrVal = obj[attrName];\r\n                    obj[attrName] = util.isEmptyValue(attrVal) ? CONSTS.EMPTY_STR : attrVal;\r\n                }\r\n            }\r\n        },\r\n        //是否为空\r\n        isEmptyValue: function(value) {\r\n            return value == null ||\r\n                value == undefined ||\r\n                value == \"\" ||\r\n                value == \" \";\r\n        },\r\n        /**\r\n         * 提取关联项字段\r\n         * @param showField\r\n         * @param data\r\n         */\r\n        extractDictShowField: function(localField, showField, data) {\r\n            if (data[localField]) {\r\n                if (util.isObject(showField)) {\r\n                    var tag = data[localField].tag;\r\n                    delete data[localField];\r\n                    for (var k in showField) {\r\n                        if (k == '//') {\r\n                            continue;\r\n                        }\r\n                        data[showField[k]] = util.isEmptyValue(tag[k]) ? CONSTS.EMPTY_STR : tag[k];\r\n                    }\r\n                } else {\r\n                    data[localField] =\r\n                        data[localField].tag[showField];\r\n                }\r\n            }\r\n        },\r\n        /**\r\n         * 处理联系人电话\r\n         * @param type\r\n         * @param data\r\n         */\r\n        handleContactTel: function(type, data) {\r\n            if (type === CONSTS.EQUIPMENT || type === CONSTS.TEAM) {\r\n                var count = 4,\r\n                    i = 1,\r\n                    n = 0;\r\n                for (; i <= count; i++) {\r\n                    if (n == 2) {\r\n                        break;\r\n                    }\r\n                    if (data.hasOwnProperty('C' + i) &&\r\n                        data['C' + i] != CONSTS.EMPTY_STR) {\r\n                        data[CONSTS.CONTACT] = data['C' + i];\r\n                        n++;\r\n                    }\r\n                    if (data.hasOwnProperty('T' + i) &&\r\n                        data['T' + i] != CONSTS.EMPTY_STR) {\r\n                        data[CONSTS.TEL] = data['T' + i];\r\n                        n++;\r\n                    }\r\n                }\r\n                if (n < 2) {\r\n                    data[CONSTS.CONTACT] = data[CONSTS.CONTACT] || CONSTS.EMPTY_STR;\r\n                    data[CONSTS.TEL] = data[CONSTS.TEL] || CONSTS.EMPTY_STR;\r\n                }\r\n            }\r\n        },\r\n        //关键字过滤\r\n        filterByKw: function(kw, data, kwFields) {\r\n            if (kw) {\r\n                var flag = false;\r\n                for (var i = 0; i < kwFields.length; i++) {\r\n                    var kwField = kwFields[i];\r\n                    if (util.isObject(kwField.relShowField)) {\r\n                        for (var relField in kwField.relShowField) {\r\n                            var fieldName = kwField.relShowField[relField];\r\n                            if (data[fieldName] && (data[fieldName] + '').indexOf(kw) >= 0) {\r\n                                flag = true;\r\n                                break;\r\n                            }\r\n                        }\r\n                        if (flag) {\r\n                            break;\r\n                        }\r\n                    } else {\r\n                        var fieldName = kwField.mapName || kwField.name;\r\n                        if (data[fieldName] && (data[fieldName] + '').indexOf(kw) >= 0) {\r\n                            flag = true;\r\n                            break;\r\n                        }\r\n                    }\r\n                }\r\n                return flag;\r\n            } else {\r\n                return true;\r\n            }\r\n        }\r\n    };\r\n    util.projectService = new g2.sfs.CoordinateTransform();\r\n    util.geoJsonReader = new jsts.io.GeoJSONReader();\r\n    //\r\n    /**\r\n     *\r\n     * @param opts\r\n     * @param opts.server\r\n     * @param opts.resourceConfig\r\n     */\r\n    window.EMapServerV2.bufferService = function(opts) {\r\n        this.options = {\r\n            server: opts.server,\r\n            eId: EID,\r\n            resourceConfig: jQuery.extend(true, {}, opts.resourceConfig)\r\n        }\r\n        this.initialize();\r\n    };\r\n\r\n    /**\r\n     * 初始化\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    window.EMapServerV2.bufferService.prototype.initialize = function() {\r\n        var resources = this.options.resourceConfig.resources;\r\n        var tableNames = [];\r\n        for (var i = 0; i < resources.length; i++) {\r\n            var resourceObj = resources[i];\r\n            resourceObj.tableIdSet = {};\r\n            var resourceTables = resourceObj.tables;\r\n            for (var j = 0; j < resourceTables.length; j++) {\r\n                var tableObj = resourceTables[j];\r\n                tableNames.push(tableObj.name)\r\n                    //\r\n                resourceObj.tableIdSet[tableObj.name] = true;\r\n                //\r\n                var listFields = tableObj.list;\r\n                var kwFields = [];\r\n                var listFieldMap = {};\r\n                var listRelations = [];\r\n                for (var k = 0; k < listFields.length; k++) {\r\n                    var fieldObj = listFields[k];\r\n                    if (fieldObj.match) {\r\n                        kwFields.push(listFields[k]);\r\n                    }\r\n                    if (fieldObj.mapName) {\r\n                        listFieldMap[fieldObj.name] = fieldObj.mapName;\r\n                    }\r\n                    //关联\r\n                    if (fieldObj.relShowField) {\r\n                        listRelations.push({\r\n                            localField: fieldObj.name,\r\n                            showField: fieldObj.relShowField\r\n                        })\r\n                    }\r\n                }\r\n                //\r\n                var detailFields = tableObj.detail;\r\n                var detailFieldMap = {};\r\n                var detailRelations = [];\r\n                for (var k = 0; k < detailFields.length; k++) {\r\n                    var fieldObj = detailFields[k];\r\n                    if (fieldObj.mapName) {\r\n                        detailFieldMap[fieldObj.name] = fieldObj.mapName;\r\n                    }\r\n                    //关联\r\n                    if (fieldObj.relShowField) {\r\n                        detailRelations.push({\r\n                            localField: fieldObj.name,\r\n                            showField: fieldObj.relShowField\r\n                        })\r\n                    }\r\n                }\r\n                //\r\n                var relateTables = tableObj.relateTables || [];\r\n                for (var k = 0; k < relateTables.length; k++) {\r\n                    var relateTable = relateTables[k];\r\n                    var fields = relateTable.fields || [];\r\n                    var relateFieldMap = {};\r\n                    var relateRelations = [];\r\n                    for (var kk = 0; kk < fields.length; kk++) {\r\n                        var fieldObj = fields[kk];\r\n                        if (fieldObj.mapName) {\r\n                            relateFieldMap[fieldObj.name] = fieldObj.mapName;\r\n                        }\r\n                        //关联\r\n                        if (fieldObj.relShowField) {\r\n                            relateRelations.push({\r\n                                localField: fieldObj.name,\r\n                                showField: fieldObj.relShowField\r\n                            })\r\n                        }\r\n                    }\r\n                    relateTable.fieldMap = relateFieldMap;\r\n                    relateTable.relations = relateRelations;\r\n                }\r\n                //\r\n                tableObj.listFieldMap = listFieldMap;\r\n                tableObj.listKw = kwFields;\r\n                tableObj.listRelations = listRelations;\r\n                tableObj.detailFieldMap = detailFieldMap;\r\n                tableObj.detailRelations = detailRelations;\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 缓冲查或者范围查询\r\n     * @param opts\r\n     * @param opts.point {Array} 事发地点经纬度坐标 [x,y]\r\n     * @param opts.radius　{Number} 缓冲距离，单位公里，与geometry互斥\r\n     * @param opts.geometry　{Number} 查询多边形，优先于radius\r\n     * @param opts.distanceField {String} 距离属性名\r\n     * @param opts.keyword　{String} 模糊匹配\r\n     * @param opts.resources {Array} 资源数组\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    window.EMapServerV2.bufferService.prototype.bufferOrPolygonQuery = function(opts, cb, ctx) {\r\n        var polygon = null;\r\n        if (opts.geometry) {\r\n            if (util.isString(opts.geometry)) {\r\n                var jtsGeom = G.utils.GeometryUtil.getWktReader().read(opts.geometry);\r\n                polygon = G.utils.GeometryUtil.getGeoJSONWriter().write(jtsGeom);\r\n            } else {\r\n                polygon = opts.geometry;\r\n            }\r\n        } else {\r\n            var projService = new g2.sfs.CoordinateTransform();\r\n            var pointGeom = new g2.sfs.Point({\r\n                x: opts.point[0],\r\n                y: opts.point[1],\r\n                spatialReference: 4326\r\n            })\r\n            var pointGeom3857 = projService.transform(pointGeom, 3857);\r\n            polygon = G.utils.SpatialOPUtil.getBuffer({\r\n                geometry: {\r\n                    type: \"Point\",\r\n                    coordinates: [pointGeom3857.x, pointGeom3857.y]\r\n                },\r\n                radius: opts.radius * 1000,\r\n                spatialReference: 3857\r\n            });\r\n            var polygonGeom = g2.sfs.GeometryFactory.createGeometryFromGeoJson(polygon);\r\n            polygonGeom.spatialReference = 3857;\r\n            polygon = projService.transform(polygonGeom, 4326).asGeoJson();\r\n        }\r\n        return this._query({\r\n            geometry: polygon,\r\n            point: opts.point,\r\n            distanceField: opts.distanceField,\r\n            keyword: opts.keyword,\r\n            resources: opts.resources\r\n        }, cb, ctx);\r\n    }\r\n\r\n    /**\r\n     * 查询行政区划内的数据，并计算到指定点距离，由近到远排序\r\n     * @param opts\r\n     * @param opts.point {Array} 事发地点经纬度坐标 [x,y]\r\n     * @param opts.districtCode　{String} 行政区划编码\r\n     * @param opts.distanceField {String} 距离属性名\r\n     * @param opts.keyword　{String} 模糊匹配\r\n     * @param opts.resources {Array} 资源数组\r\n     * @param opts.resources[i].tables {Array} 查询的条件\r\n     * @param opts.resources[i].tables[j].table {String} 查询的表\r\n     * @param opts.resources[i].tables[j].query {Object} 查询条件\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    window.EMapServerV2.bufferService.prototype.districtQuery = function(opts, cb, ctx) {\r\n            var queryCol = {},\r\n                queryItem = {},\r\n                districtCodes = opts.districtCode.split(',');\r\n            for (var i = 0; i < districtCodes.length; i++) {\r\n                var districtCode = districtCodes[i];\r\n                var districtTable = \"province0.01\";\r\n                if (districtCode.endsWith('0000')) {\r\n                    districtTable = 'province0.01';\r\n                } else if (districtCode.endsWith('00')) {\r\n                    districtTable = 'city0.03';\r\n                } else {\r\n                    districtTable = 'county0.06';\r\n                }\r\n                if (queryCol.hasOwnProperty(districtTable)) {\r\n                    queryItem.query['$or'].push({\r\n                        \"tag.adcode\": districtCode\r\n                    });\r\n                } else {\r\n                    queryItem.query = {\r\n                        \"$or\": [{\r\n                            \"tag.adcode\": districtCode\r\n                        }]\r\n                    }\r\n                    queryCol[districtTable] = queryItem;\r\n                }\r\n            }\r\n            util.queryMulti({\r\n                server: this.options.server,\r\n                eId: 'siptea',\r\n                data: queryCol\r\n            }, function(err, data) {\r\n                if (err == null) {\r\n                    var geojsonList = [];\r\n                    for (var table in data) {\r\n                        var list = data[table];\r\n                        for (var i = 0; i < list.length; i++) {\r\n                            if (list[i] && list[i].geom) {\r\n                                geojsonList.push(list[i].geom);\r\n                            }\r\n                        }\r\n                    }\r\n                    var geometry = null;\r\n                    if (geojsonList.length > 1) {\r\n                        var tempCoordinates = [];\r\n                        console.debug(JSON.stringify(geojsonList, null, 4))\r\n                        for (var k = 0; k < geojsonList.length; k++) {\r\n                            var geoJsonItem = geojsonList[k];\r\n                            if (geoJsonItem.type === 'MultiPolygon') {\r\n                                for (var kk = 0; kk < geoJsonItem.coordinates.length; kk++) {\r\n                                    tempCoordinates.push(geoJsonItem.coordinates[kk]);\r\n                                }\r\n                            } else {\r\n                                tempCoordinates.push(geoJsonItem.coordinates);\r\n                            }\r\n                        }\r\n                        geometry = {\r\n                            type: 'MultiPolygon',\r\n                            coordinates: tempCoordinates\r\n                        };\r\n                    } else {\r\n                        geometry = geojsonList[0];\r\n                    }\r\n                    this._query({\r\n                        geometry: geometry,\r\n                        point: opts.point,\r\n                        distanceField: opts.distanceField,\r\n                        keyword: opts.keyword,\r\n                        resources: opts.resources\r\n                    }, cb, ctx);\r\n                } else {\r\n                    cb && cb.call(ctx, err)\r\n                }\r\n            }, this)\r\n        }\r\n        /**\r\n         * 查询范围内的数据，并计算到指定点距离，由近到远排序\r\n         * @param opts\r\n         * @param opts.tableName　{String} 表名\r\n         * @param opts.dataId {String} 数据id\r\n         * @param cb\r\n         * @param ctx\r\n         */\r\n    window.EMapServerV2.bufferService.prototype.queryDetail = function(opts, cb, ctx) {\r\n            var tableObj = null;\r\n            var resources = this.options.resourceConfig.resources;\r\n            var thisResourceObj = null;\r\n            for (var i = 0; i < resources.length; i++) {\r\n                var resourceObj = resources[i];\r\n                for (var j = 0; j < resourceObj.tables.length; j++) {\r\n                    var thisTable = resourceObj.tables[j];\r\n                    if (thisTable.name === opts.tableName) {\r\n                        tableObj = thisTable;\r\n                        thisResourceObj = resourceObj;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n            if (tableObj == null) {\r\n                cb && cb.call(ctx, new Error('表不存在！'))\r\n                return;\r\n            }\r\n            var queryCol = {},\r\n                relationTableNames = [];\r\n            //关联数据\r\n            var relationTables = tableObj.relateTables || [];\r\n            for (var r = 0; r < relationTables.length; r++) {\r\n                var relation = relationTables[r];\r\n                var qItem = {};\r\n                var fields = relation.fields || [];\r\n                if (fields.length > 0) {\r\n                    var select = {\r\n                        _id: true,\r\n                        geom: true\r\n                    };\r\n                    for (var s = 0; s < fields.length; s++) {\r\n                        select['tag.' + fields[s].name] = true;\r\n                    }\r\n                    qItem = this._makeQuery(relation.relations, relation.fieldMap, fields);\r\n                    qItem.select = Object.keys(select).join(' ');\r\n                } else {\r\n                    qItem.select = '';\r\n                }\r\n                qItem.query = {};\r\n                qItem.query['tag.' + relation.relField] = opts.dataId;\r\n                queryCol[relation.table] = qItem;\r\n                relationTableNames.push(relation.table)\r\n            }\r\n            this._getTableMeta(\r\n                [tableObj.name].concat(relationTableNames),\r\n                function(err, tableMetaSet) {\r\n                    if (err == null) {\r\n                        //\r\n                        var relations = tableObj.listRelations,\r\n                            fieldMap = tableObj.fieldMap;\r\n                        var queryItem = this._makeQuery(relations, fieldMap, tableObj.detail);\r\n                        queryItem.query = {\r\n                                '_id': opts.dataId\r\n                            }\r\n                            //救援队跟储备库的关联装备查询 add by lsl\r\n                        if (opts.equConfig) {\r\n                            for (var key in queryCol) {\r\n                                opts.equConfig[tableObj.name] = queryItem;\r\n                                queryCol = opts.equConfig;\r\n                            }\r\n                        } else {\r\n                            queryCol[tableObj.name] = queryItem;\r\n                        }\r\n                        //查询\r\n                        util.queryMulti({\r\n                            server: this.options.server,\r\n                            eId: this.options.eId,\r\n                            data: queryCol\r\n                        }, function(err, dataSet) {\r\n                            if (err == null) {\r\n                                var dataList = dataSet[tableObj.name];\r\n                                if (dataList && dataList.length == 1) {\r\n                                    var tableMeta = tableMetaSet[tableObj.name];\r\n                                    var dataItem = dataList[0],\r\n                                        attrObj = dataItem.tag;\r\n                                    var metaFields = tableMeta.model,\r\n                                        detailFields = tableObj.detail;\r\n                                    var fieldMap = tableObj.detailFieldMap || {};\r\n                                    var attributes = [],\r\n                                        result = {\r\n                                            id: dataItem._id,\r\n                                            attributes: attributes\r\n                                        };\r\n                                    for (var i = 0; i < detailFields.length; i++) {\r\n                                        var fieldObj = detailFields[i];\r\n                                        if (util.isObject(fieldObj.relShowField)) {\r\n                                            var relObj = {};\r\n                                            relObj[fieldObj.name] = dataItem['tag'][fieldObj.name];\r\n                                            util.extractDictShowField(fieldObj.name, fieldObj.relShowField, relObj);\r\n                                            util.handleContactTel(thisResourceObj.name, relObj);\r\n                                            for (var kk in fieldObj.relShowField) {\r\n                                                var kkVv = fieldObj.relShowField[kk];\r\n                                                if (kk == '//' || /^C\\d$/.test(kkVv) || /^T\\d$/.test(kkVv)) {\r\n                                                    continue;\r\n                                                }\r\n                                                var attribute = {};\r\n                                                attribute.name = kkVv;\r\n                                                attribute.label = kkVv === \"RESCUENAME\" ? CONSTS.BELONG_RESCUE : \"\";\r\n                                                attribute.value = relObj[attribute.name];\r\n                                                attributes.push(attribute);\r\n                                            }\r\n                                            if (thisResourceObj.name === CONSTS.EQUIPMENT) { //装备\r\n                                                var attribute1 = {};\r\n                                                attribute1.name = CONSTS.CONTACT;\r\n                                                attribute1.label = CONSTS.CONTACT_LABEL;\r\n                                                attribute1.value = relObj[CONSTS.CONTACT];\r\n                                                attributes.push(attribute1);\r\n                                                var attribute2 = {};\r\n                                                attribute2.name = CONSTS.TEL;\r\n                                                attribute2.label = CONSTS.TEL_LABEL;\r\n                                                attribute2.value = relObj[CONSTS.TEL];\r\n                                                attributes.push(attribute2);\r\n                                            }\r\n                                        } else {\r\n                                            var itemObj = {};\r\n                                            itemObj.name = fieldObj.name;\r\n                                            itemObj.label = \"\";\r\n                                            itemObj.value = attrObj[fieldObj.name];\r\n                                            itemObj.value = util.isEmptyValue(itemObj.value) ? CONSTS.EMPTY_STR : itemObj.value;\r\n                                            if (fieldObj.relShowField) {\r\n                                                if (util.isObject(itemObj.value)) {\r\n                                                    itemObj.value = attrObj[fieldObj.name].tag[fieldObj.relShowField]\r\n                                                } else {\r\n                                                    itemObj.value = CONSTS.EMPTY_STR;\r\n                                                }\r\n                                            }\r\n                                            if (fieldMap.hasOwnProperty(itemObj.name)) {\r\n                                                itemObj.name = fieldMap[itemObj.name]\r\n                                            }\r\n                                            if (fieldObj.label) {\r\n                                                itemObj.label = fieldObj.label;\r\n                                            } else {\r\n                                                for (var j = 0; j < metaFields.length; j++) {\r\n                                                    var metaField = metaFields[j];\r\n                                                    if (metaField.fieldName === fieldObj.name) {\r\n                                                        itemObj.label = metaField.fieldDesc;\r\n                                                        break;\r\n                                                    }\r\n                                                }\r\n                                            }\r\n                                            attributes.push(itemObj)\r\n                                        }\r\n                                    }\r\n                                    if (opts.equConfig) {\r\n                                        result.equTable = {};\r\n                                        for (var key in dataSet) {\r\n                                            if (dataSet[key].length > 0 &&\r\n                                                key != \"EQUIP_TEA_RESCUE\"\r\n                                                // &&key!=\"JC_FIRETEAMSTA\"\r\n                                            ) {\r\n                                                result.equTable[key] = dataSet[key];\r\n                                            }\r\n                                        }\r\n                                        cb && cb.call(ctx, null, result);\r\n                                    } else {\r\n                                        //relations\r\n                                        for (var r = 0; r < relationTables.length; r++) {\r\n                                            var relationObj = relationTables[r];\r\n                                            var relationData = dataSet[relationObj.table];\r\n                                            var metaFields = tableMetaSet[relationObj.table].model,\r\n                                                metaFieldsLen = metaFields.length,\r\n                                                fields = relationObj.fields || [],\r\n                                                fieldsLen = fields.length,\r\n                                                fieldMap = relationObj.fieldMap,\r\n                                                relations = relationObj.relations;\r\n                                            for (var kk = 0; kk < relationData.length; kk++) {\r\n                                                var dataItem = relationData[kk];\r\n                                                var attributes = [],\r\n                                                    dataObj = {\r\n                                                        attributes: attributes\r\n                                                    };\r\n                                                dataObj.id = dataItem._id;\r\n                                                dataObj.geom = dataItem.geom;\r\n                                                for (var kkk = 0; kkk < metaFieldsLen; kkk++) {\r\n                                                    var metaField = metaFields[kkk];\r\n                                                    var fieldObj = {};\r\n                                                    for (var k4 = 0; k4 < fieldsLen; k4++) {\r\n                                                        if (fields[k4].name === metaField.fieldName) {\r\n                                                            fieldObj = fields[k4];\r\n                                                            break;\r\n                                                        }\r\n                                                    }\r\n                                                    if (dataItem.tag.hasOwnProperty(metaField.fieldName)) {\r\n                                                        var attribute = {};\r\n                                                        attribute.name = metaField.fieldName;\r\n                                                        attribute.value = dataItem.tag[metaField.fieldName];\r\n                                                        attributes.push(attribute);\r\n                                                        //\r\n                                                        if (fieldObj.relShowField) {\r\n                                                            if (dataItem.tag[fieldObj.name]) { //党未查询到\r\n                                                                attribute.value = dataItem.tag[fieldObj.name].tag[fieldObj.relShowField]\r\n                                                            } else {\r\n                                                                attribute.value = \"\";\r\n                                                            }\r\n                                                        }\r\n                                                        if (fieldMap.hasOwnProperty(itemObj.name)) {\r\n                                                            attribute.name = fieldMap[attribute.name]\r\n                                                        }\r\n                                                        if (fieldObj.label) {\r\n                                                            attribute.label = fieldObj.label;\r\n                                                        } else {\r\n                                                            attribute.label = metaField.fieldDesc;\r\n                                                        }\r\n                                                    }\r\n                                                }\r\n                                                relationData[kk] = dataObj;\r\n                                            }\r\n                                            result[relationObj.as || relationObj.table] = relationData;\r\n                                        }\r\n                                        cb && cb.call(ctx, null, result);\r\n                                    }\r\n                                } else {\r\n                                    cb && cb.call(ctx, new Error('查询失败！'));\r\n                                }\r\n                            } else {\r\n                                cb && cb.call(ctx, err)\r\n                            }\r\n                        }, this)\r\n                    } else {\r\n                        cb && cb.call(ctx, err)\r\n                    }\r\n                }, this)\r\n        }\r\n        /**\r\n         * 查询装备的详情框\r\n         * @param opts 查询参数\r\n         * @opts.param：参数集\r\n         * @param cb：回调函数\r\n         * @param ctx\r\n         */\r\n    window.EMapServerV2.bufferService.prototype.queryEquDetail = function(opts, cb, ctx) {\r\n            //查询\r\n            util.queryMulti({\r\n                server: this.options.server,\r\n                eId: this.options.eId,\r\n                data: opts\r\n            }, function(err, dataSet) {\r\n                if (err == null) {\r\n                    for (var key in dataSet) {\r\n                        var dataList = dataSet[key];\r\n                        if (dataList && dataList.length == 1) {\r\n                            cb && cb.call(ctx, null, dataList);\r\n                        } else {\r\n                            cb && cb.call(ctx, new Error('查询失败！'));\r\n                        }\r\n                    }\r\n                } else {\r\n                    cb && cb.call(ctx, err)\r\n                }\r\n            }, this)\r\n        }\r\n        /**\r\n         * 获取分类列表\r\n         * @param opts\r\n         * @param opts.resources {Array} 资源序号数组\r\n         * @param cb\r\n         * @param ctx\r\n         */\r\n    window.EMapServerV2.bufferService.prototype.getTypeList = function(opts, cb, ctx) {\r\n        // var dataParam={};\r\n        // dataParam.EQUIP_EQU_TYPE={};\r\n        // dataParam.EQUIP_EQU_TYPE.query={\"tag.PARENTCODE\":\"0\"};\r\n        // dataParam.EQUIP_EQU_TYPE.select=\"_id tag.EQUIPTYPECODE tag.EQUIPTYPENAME tag.PARENTCODE tag.SHORTNAME\";\r\n        // dataParam.EQUIP_EQU_TYPE.sort=\"tag.ORDERBY\";\r\n        // util.queryMulti({\r\n        //     server: this.options.server,\r\n        //     eId: this.options.eId,\r\n        //     data:dataParam\r\n        // }, function (err, data) {\r\n        //     for(var i=0;i<data.length;i++){\r\n        //         let eleData=data[i];\r\n        //         resourceTypes[i] = {\r\n        //             label: eleData.tag.EQUIPTYPENAME,\r\n        //             field: null,\r\n        //             value: eleData.tag.SHORTNAME,\r\n        //             id:eleData.tag.EQUIPTYPECODE,\r\n        //             pId:eleData.tag.PARENTCODE\r\n        //         };\r\n        //     }\r\n        // })\r\n\r\n        var configResources = this.options.resourceConfig.resources,\r\n            resourceCount = opts.resources.length;\r\n        var resultSet = [];\r\n        if (opts.resources.length == 0) {\r\n            cb && cb.call(ctx, null, resultSet);\r\n            return;\r\n        }\r\n        var tempSet = {};\r\n        for (var i = 0; i < resourceCount; i++) {\r\n            var resourceIndex = opts.resources[i],\r\n                index = parseInt(resourceIndex) - 1;\r\n            var resourceObj = configResources[index];\r\n            if (!resourceObj) {\r\n                continue;\r\n            }\r\n            /*\r\n            /此处处理装备的字典查询\r\n             */\r\n            var tables = resourceObj.tables;\r\n            var resourceTypes = new Array(tables.length);\r\n            if (resourceObj.classification && resourceObj.classification.type == \"dict\") {\r\n                tempSet[i + '_0'] = {};\r\n                tempSet[i + '_0'].classification = resourceObj.classification;\r\n            } else {\r\n                for (var j = 0; j < tables.length; j++) {\r\n                    var table = tables[j];\r\n                    var classification = table.classification || {};\r\n                    if (classification.type == 'dict') {\r\n                        resourceTypes[j] = {};\r\n                        tempSet[i + '_' + j] = table;\r\n                    } else {\r\n                        resourceTypes[j] = {\r\n                            label: table.label || table.name,\r\n                            table: table.name,\r\n                            field: null,\r\n                            value: null,\r\n                            id: G.utils.CommonUtil.newUUID(),\r\n                            pId: '0'\r\n                        };\r\n                    }\r\n                }\r\n                resultSet.push(resourceTypes);\r\n            }\r\n        }\r\n        if (Object.keys(tempSet).length == 0) {\r\n            cb && cb.call(ctx, null, resultSet);\r\n            return;\r\n        }\r\n        var queryCol = {};\r\n        for (var idx in tempSet) {\r\n            var tempObj = tempSet[idx],\r\n                classification = tempObj.classification;\r\n            var queryItem = {};\r\n            if (classification.pId) {\r\n                queryItem.select = ['_id', 'tag.' + classification.showField, 'tag.' + classification.pId].join(' ');\r\n            } else {\r\n                queryItem.select = ['_id', 'tag.' + classification.showField].join(' ');\r\n            }\r\n            queryItem.query = classification.query || {};\r\n            if (classification.sortField) {\r\n                var sort = classification.sortDirection === 'DESC' ? '-' : '';\r\n                queryItem.sort = sort + 'tag.' + classification.sortField;\r\n            }\r\n            queryCol[classification.dictTable] = queryItem;\r\n        }\r\n\r\n        util.queryMulti({\r\n            server: this.options.server,\r\n            eId: this.options.eId,\r\n            data: queryCol\r\n        }, function(err, data) {\r\n            if (err == null) {\r\n                for (var idx in tempSet) {\r\n                    var tempObj = tempSet[idx],\r\n                        classification = tempObj.classification;\r\n                    var dataList = data[classification.dictTable];\r\n                    var list = [];\r\n                    for (var k = 0; k < dataList.length; k++) {\r\n                        var dataItem = dataList[k];\r\n                        var dataObj = {};\r\n                        dataObj.label = dataItem.tag[classification.showField];\r\n                        dataObj.value = dataItem._id;\r\n                        dataObj.table = tempObj.name;\r\n                        dataObj.field = classification.localField;\r\n                        dataObj.id = G.utils.CommonUtil.newUUID();\r\n                        if (classification.pId) {\r\n                            dataObj.pId = dataItem.tag[classification.pId];;\r\n                        } else {\r\n                            dataObj.pId = '0';\r\n                        }\r\n                        list.push(dataObj);\r\n                    }\r\n                    var idxArr = idx.split('_');\r\n                    if (resultSet[idxArr[0]]) {\r\n                        resultSet[idxArr[0]][idxArr[1]] = list;\r\n                    } else {\r\n                        resultSet[idxArr[0]] = list;\r\n                    }\r\n\r\n                }\r\n                for (var m = 0; m < resultSet.length; m++) {\r\n                    var resultItem = resultSet[m];\r\n                    var list = [];\r\n                    for (var n = 0; n < resultItem.length; n++) {\r\n                        list = list.concat(resultItem[n])\r\n                    }\r\n                    resultSet[m] = list;\r\n                }\r\n                cb && cb.call(ctx, null, resultSet)\r\n            } else {\r\n                cb && cb.call(ctx, err);\r\n            }\r\n        }, this)\r\n    }\r\n\r\n\r\n    /**\r\n     *\r\n     * @param opts.point {Array} 事发地点经纬度坐标 [x,y]\r\n     * @param opts.geometry　{GeoJson} 筛选范围\r\n     * @param opts.caculateDistance {Boolean} 是否计算距离并排序\r\n     * @param opts.distanceField {String} 距离属性名\r\n     * @param opts.keyword　{String} 模糊匹配\r\n     * @param opts.resources　{Array} 资源id\r\n     * @param cb\r\n     * @param ctx\r\n     * @private\r\n     */\r\n    window.EMapServerV2.bufferService.prototype._query = function(opts, cb, ctx) {\r\n            var resourcesOpt = jQuery.extend(true, {}, opts.resources);\r\n            var queryCol = {};\r\n            var distanceField = opts.distanceField || 'dis';\r\n            var keyword = opts.keyword ? (opts.keyword + '').trim() : '';\r\n            var resourceConfig = jQuery.extend(true, {}, this.options.resourceConfig.resources);\r\n            var queryResurces = [];\r\n            for (var resourceId in resourcesOpt) {\r\n                var resourceIndex = parseInt(resourceId) - 1;\r\n                var resourceObj = resourceConfig[resourceIndex];\r\n                if (!resourceObj) {\r\n                    continue;\r\n                }\r\n                var resourceQueryTables = resourcesOpt[resourceId] || [],\r\n                    queryAllTable = resourceQueryTables.length == 0;\r\n                //处理每类数据的筛选条件\r\n                var resourceQueryTableSet = {};\r\n                for (var i = 0; i < resourceQueryTables.length; i++) {\r\n                    var queryTable = resourceQueryTables[i];\r\n                    var tableQueryObj = resourceQueryTableSet[queryTable.table];\r\n                    if (tableQueryObj) {\r\n                        if (queryTable.field) {\r\n                            tableQueryObj['tag.' + queryTable.field][\"$in\"].push(queryTable.value)\r\n                        }\r\n                    } else {\r\n                        tableQueryObj = {};\r\n                        if (queryTable.field) {\r\n                            tableQueryObj['tag.' + queryTable.field] = {\r\n                                \"$in\": [queryTable.value]\r\n                            }\r\n                        }\r\n                        resourceQueryTableSet[queryTable.table] = tableQueryObj;\r\n                    }\r\n                }\r\n                var filteredQueryTable = [];\r\n                for (var j = 0; j < resourceObj.tables.length; j++) {\r\n                    var tableObj = resourceObj.tables[j];\r\n                    if (!(queryAllTable ||\r\n                            resourceQueryTableSet.hasOwnProperty(tableObj.name))) {\r\n                        continue;\r\n                    }\r\n                    var andList = [];\r\n                    if (resourceQueryTableSet.hasOwnProperty(tableObj.name) &&\r\n                        Object.keys(resourceQueryTableSet[tableObj.name]).length > 0) {\r\n                        andList.push(resourceQueryTableSet[tableObj.name]);\r\n                    }\r\n                    if (opts.geometry) {\r\n                        andList.push({\r\n                            \"geom\": {\r\n                                \"$geoIntersects\": {\r\n                                    \"$geometry\": opts.geometry\r\n                                }\r\n                            }\r\n                        })\r\n                    }\r\n                    //模糊匹配\r\n                    var shouldFilterOnServer = this._kwFilterOnServer(tableObj.list);\r\n                    tableObj.shouldFilterOnServer = shouldFilterOnServer;\r\n                    if (opts.keyword && shouldFilterOnServer) {\r\n                        var kwFields = tableObj.listKw;\r\n                        var orList = [];\r\n                        for (var j1 = 0; j1 < kwFields.length; j1++) {\r\n                            var or = {};\r\n                            or[\"tag.\" + kwFields[j1].name] = {\r\n                                $regex: \"^.*\" + keyword + \".*$\"\r\n                            };\r\n                            orList.push(or);\r\n                        }\r\n                        andList.push({\r\n                            \"$or\": orList\r\n                        });\r\n                    }\r\n                    var relations = tableObj.listRelations,\r\n                        fieldMap = tableObj.fieldMap;\r\n                    var queryItem = this._makeQuery(relations, fieldMap, tableObj.list);\r\n                    queryItem.query = {\r\n                        \"$and\": andList\r\n                    }\r\n                    queryCol[tableObj.name] = queryItem;\r\n                    //\r\n                    filteredQueryTable.push(tableObj)\r\n                }\r\n                //\r\n                if (!queryAllTable) {\r\n                    resourceObj.tables = filteredQueryTable;\r\n                }\r\n                queryResurces.push(resourceObj);\r\n            }\r\n            console.debug('> 查询的表名：' + JSON.stringify(Object.keys(queryCol)));\r\n            util.queryMulti({\r\n                server: this.options.server,\r\n                eId: this.options.eId,\r\n                data: queryCol\r\n            }, function(err, dataSet) {\r\n                if (err == null) {\r\n                    var resultSet = {},\r\n                        caculateDistance = opts.caculateDistance;\r\n                    for (var i = 0; i < queryResurces.length; i++) {\r\n                        var resourceObj = queryResurces[i];\r\n                        var resourceDataList = [];\r\n                        for (var j = 0; j < resourceObj.tables.length; j++) {\r\n                            var tableObj = resourceObj.tables[j],\r\n                                relations = tableObj.listRelations,\r\n                                relationsLen = relations.length,\r\n                                fieldMap = tableObj.listFieldMap || {},\r\n                                shouldMap = Object.keys(fieldMap).length > 0;\r\n                            var dataList = dataSet[tableObj.name],\r\n                                dataTempList = [];\r\n                            for (var k = 0, dataCount = dataList.length; k < dataCount; k++) {\r\n                                var dataItem = dataList[k],\r\n                                    attrObj = dataItem.tag;\r\n                                var tempItem = attrObj;\r\n                                tempItem.id = dataItem._id;\r\n                                if (relationsLen > 0) {\r\n                                    for (var rIdx = 0; rIdx < relationsLen; rIdx++) {\r\n                                        var relationObj = relations[rIdx];\r\n                                        if (tempItem[relationObj.localField]) {\r\n                                            tempItem[relationObj.localField + '_'] = tempItem[relationObj.localField]._id;\r\n                                            util.extractDictShowField(relationObj.localField, relationObj.showField, tempItem);\r\n                                        }\r\n                                    }\r\n                                }\r\n                                if (shouldMap) {\r\n                                    for (var mapField in fieldMap) {\r\n                                        tempItem[fieldMap[mapField]] = tempItem[mapField]\r\n                                        delete tempItem[mapField]\r\n                                    }\r\n                                }\r\n                                //关键字过滤\r\n                                if (!(tableObj.shouldFilterOnServer || util.filterByKw(opts.keyword, tempItem, tableObj.listKw))) {\r\n                                    continue;\r\n                                }\r\n                                if (dataItem.geom) {\r\n                                    tempItem['longitude'] = dataItem.geom.coordinates[0]\r\n                                    tempItem['latitude'] = dataItem.geom.coordinates[1]\r\n                                    if (caculateDistance !== false) {\r\n                                        tempItem[distanceField] = util.caculateDistance(opts.point, dataItem.geom)\r\n                                    }\r\n                                }\r\n                                tempItem.table_name = tableObj.name;\r\n                                tempItem.table_label = tableObj.label;\r\n                                //替换空值\r\n                                util.handleEmptyValue(tempItem)\r\n                                util.handleContactTel(resourceObj.name, tempItem);\r\n                                dataTempList.push(tempItem);\r\n                            }\r\n                            resourceDataList = resourceDataList.concat(dataTempList);\r\n                        }\r\n                        resourceDataList.sort(function(a, b) {\r\n                            return a[distanceField] - b[distanceField];\r\n                        })\r\n                        resultSet[resourceObj.name] = resourceDataList;\r\n                    }\r\n                    cb && cb.call(ctx, null, resultSet);\r\n                } else {\r\n                    cb && cb.call(ctx, err)\r\n                }\r\n            }, this)\r\n        }\r\n        /**\r\n         *\r\n         * @param relations\r\n         * @param fieldMap\r\n         * @param fieldList\r\n         * @return {{}}\r\n         * @private\r\n         */\r\n    window.EMapServerV2.bufferService.prototype._makeQuery = function(relations, fieldMap, fieldList) {\r\n            var queryItem = {};\r\n            fieldMap = fieldMap || {};\r\n            var populate = [],\r\n                select = {\r\n                    _id: true,\r\n                    geom: true\r\n                }\r\n            if (relations.length > 0) {\r\n                for (var kk = 0; kk < relations.length; kk++) {\r\n                    var relationObj = relations[kk];\r\n                    select[relationObj.localField] = true;\r\n                    for (var fieldAlias in fieldMap) {\r\n                        select[\"tag.\" + fieldMap[fieldAlias]] = true;\r\n                        if (fieldMap[fieldAlias] == relationObj.localField) {\r\n                            relationObj.alias = fieldAlias;\r\n                            break;\r\n                        }\r\n                    }\r\n                    select[\"tag.\" + relationObj.localField] = true;\r\n                    populate.push([\"tag.\" + relationObj.localField])\r\n                }\r\n                queryItem.populate = populate;\r\n            }\r\n            for (var j2 = 0; j2 < fieldList.length; j2++) {\r\n                select[\"tag.\" + fieldList[j2].name] = true;\r\n            }\r\n            queryItem.select = Object.keys(select).join(' ');\r\n            return queryItem;\r\n        }\r\n        /**\r\n         *\r\n         * @param dataSetIds\r\n         * @param cb\r\n         * @param ctx\r\n         * @private\r\n         */\r\n    window.EMapServerV2.bufferService.prototype._getTableMeta = function(dataSetIds, cb, ctx) {\r\n        this.dataSetCache = this.dataSetCache || {};\r\n        var dataSetIds2Query = [];\r\n        var resultSet = {};\r\n        for (var i = 0; i < dataSetIds.length; i++) {\r\n            var dataSetId = dataSetIds[i];\r\n            if (this.dataSetCache[dataSetId]) {\r\n                resultSet[dataSetId] = this.dataSetCache[dataSetId]\r\n            } else {\r\n                dataSetIds2Query.push(dataSetId)\r\n            }\r\n        }\r\n        if (dataSetIds2Query.length == 0) {\r\n            cb && cb.call(ctx, null, resultSet)\r\n        } else {\r\n            util.queryDataSet({\r\n                server: this.options.server,\r\n                eId: this.options.eId,\r\n                tableNames: dataSetIds2Query\r\n            }, function(err, data) {\r\n                if (err == null) {\r\n                    if (data.result && data.result.length > 0) {\r\n                        for (var j = 0; j < data.result.length; j++) {\r\n                            resultSet[data.result[j].dataSetId] = data.result[j]\r\n                        }\r\n                        cb && cb.call(ctx, null, resultSet)\r\n                    } else {\r\n                        cb && cb.call(ctx, new Error('查询元数据失败！'));\r\n                    }\r\n                } else {\r\n                    cb && cb.call(ctx, err)\r\n                }\r\n            }, this)\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 是否服务端关键子过滤，对于装备（因为关联救援队伍的名称）类型前端过滤\r\n     * @param fieldList\r\n     * @private\r\n     */\r\n    window.EMapServerV2.bufferService.prototype._kwFilterOnServer = function(fieldList) {\r\n        var flag = true;\r\n        for (var i = 0; i < fieldList.length; i++) {\r\n            if (util.isObject(fieldList[i].relShowField)) {\r\n                flag = false;\r\n                break;\r\n            }\r\n        }\r\n        return flag;\r\n    }\r\n\r\n    /****\r\n     * 行政区划统计\r\n     * @param opts\r\n     * @param opts.table 表名\r\n     * @param opts.districtField 行政区划字段名\r\n     * @param opts.districtCode 行政区划编码\r\n     * @param opts.useCache 使用缓存\r\n     * @param cb\r\n     * @param ctx\r\n     */\r\n    window.EMapServerV2.bufferService.prototype.statisticByDistrict = function(opts, cb, ctx) {\r\n        var url = this.options.server + '/biz/district/statistics'\r\n        var data = {\r\n            eId: this.options.eId,\r\n            dataSetId: opts.table,\r\n            districtField: opts.districtField,\r\n            districtTable: 'CODE_BAS_DISTRICT',\r\n            districtCode: opts.districtCode,\r\n            useCache: !!opts.useCache\r\n        };\r\n        if (opts.districtCode === '000000') {\r\n            data.useCache = true;\r\n        }\r\n        jQuery.ajax({\r\n            url: url,\r\n            type: 'get',\r\n            data: data,\r\n            success: function(data) {\r\n                cb && cb.call(ctx, null, data.data)\r\n            },\r\n            error: function(x, msg, err) {\r\n                cb && cb.call(ctx, err);\r\n            }\r\n        })\r\n    }\r\n\r\n    /**\r\n     * 按行政区划查询\r\n     * @param opts\r\n     * @param opts.dataSetId\r\n     * @param opts.districtField\r\n     * @param opts.districtCode\r\n     *\r\n     */\r\n    window.EMapServerV2.bufferService.prototype.queryByDistrict = function(opts, cb, ctx) {\r\n            var queryCol = {},\r\n                queryItem = opts;\r\n            queryItem.query = {};\r\n            queryItem.query['tag.' + opts.districtField] = {\r\n                \"$regex\": opts.districtCode + \".*\"\r\n            }\r\n            queryCol[opts.dataSetId] = queryItem;\r\n            util.queryMulti({\r\n                server: this.options.server,\r\n                eId: this.options.eId,\r\n                data: queryCol\r\n            }, function(err, data) {\r\n                if (err == null) {\r\n                    cb && cb.call(ctx, null, data[opts.dataSetId])\r\n                } else {\r\n                    cb && cb.call(ctx, err)\r\n                }\r\n            }, this)\r\n        }\r\n        /**\r\n         * 查询所有装备的展示字段\r\n         * @opts 参数\r\n         */\r\n    window.EMapServerV2.bufferService.prototype.queryAllField = function(opts, cb, ctx) {\r\n        util.queryMulti({\r\n            server: this.options.server,\r\n            eId: this.options.eId,\r\n            data: opts\r\n        }, function(err, data) {\r\n            if (err == null) {\r\n                cb && cb(data);\r\n            } else {\r\n                cb && cb(ctx, err)\r\n            }\r\n        }, this)\r\n    }\r\n    window.EMapServerV2.bufferService.Util = util;\r\n})(window);","require('./CommonService.js');\r\n//<!----资源查询-行政区划 服务-->\r\nrequire('./DistrictUtil.js');\r\n//<!----资源查询-资源查询 服务-->\r\nrequire('./ResourceQueryService.js');\r\n//<!----资源查询-类型树 服务-->\r\nrequire('./bufferService.js');\r\nrequire('./queryData.js');\r\nrequire('./typeTree.js');\r\n//<!----应急资源 服务-->\r\nrequire('./EmerSourceService.js');\r\n//!----风险隐患 服务-->\r\nrequire('./RiskSourceService.js');\r\n//<!----基础数据 服务-->\r\nrequire('./BaseDataService.js');\r\nrequire('./provinceData.js');\r\n//<!----应急物资、风险隐患、基础数据 详情框 服务-->\r\nrequire('./DetailInfoServices.js');\r\n//<!----人口热力 服务-->\r\nrequire('./ServiceModule.js');\r\nrequire('./queryservice.js');\r\n//<!----救援队伍 服务-->\r\nrequire('./RescueTeamService.js');\r\n//<!-- 风险隐患地震 -->\r\nrequire('./HazardQueryService.js');\r\n//<!----风险隐患排查 服务-->\r\nrequire('./RiskQueryServiceConfig.js');\r\nrequire('./RiskTroubleQueryService.js');\r\n//<!----救援救助 服务-->\r\nrequire('./CoordTransformUtil.js');\r\nrequire('./RescueAssistanceServiceExt.js');\r\nrequire('./RescueAssistanceServiceChartExt.js');\r\nrequire('./RescueAssistanceService.js');\r\nrequire('./RescueHelpService.js');","window.EMapServerV2.provinceDistrictData={\r\n    \"province\":[\r\n        {\r\n            \"code\": \"110000\",\r\n            \"lat\": 39.9236,\r\n            \"lng\": 116.3809,\r\n            \"name\": \"北京市\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"120000\",\r\n            \"lat\": 39.1311,\r\n            \"lng\": 117.2034,\r\n            \"name\": \"天津市\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"130000\",\r\n            \"lat\": 38.1,\r\n            \"lng\": 114.4336,\r\n            \"name\": \"河北省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"140000\",\r\n            \"lat\": 38.0827,\r\n            \"lng\": 112.5659,\r\n            \"name\": \"山西省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"150000\",\r\n            \"lat\": 40.8801,\r\n            \"lng\": 111.6723,\r\n            \"name\": \"内蒙古自治区\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"210000\",\r\n            \"lat\": 42.033,\r\n            \"lng\": 123.4644,\r\n            \"name\": \"辽宁省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"220000\",\r\n            \"lat\": 44.3081,\r\n            \"lng\": 125.3101,\r\n            \"name\": \"吉林省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"230000\",\r\n            \"lat\": 46.1646,\r\n            \"lng\": 126.6504,\r\n            \"name\": \"黑龙江省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"310000\",\r\n            \"lat\": 31.2381,\r\n            \"lng\": 121.4692,\r\n            \"name\": \"上海市\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"320000\",\r\n            \"lat\": 32.4171,\r\n            \"lng\": 118.6743,\r\n            \"name\": \"江苏省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"330000\",\r\n            \"lat\": 30.5433,\r\n            \"lng\": 120.0806,\r\n            \"name\": \"浙江省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"340000\",\r\n            \"lat\": 32.0826,\r\n            \"lng\": 117.29,\r\n            \"name\": \"安徽省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"350000\",\r\n            \"lat\": 26.4312,\r\n            \"lng\": 119.2236,\r\n            \"name\": \"福建省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"360000\",\r\n            \"lat\": 28.9985,\r\n            \"lng\": 115.8398,\r\n            \"name\": \"江西省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"370000\",\r\n            \"lat\": 37.0376,\r\n            \"lng\": 116.9824,\r\n            \"name\": \"山东省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"410000\",\r\n            \"lat\": 34.7777,\r\n            \"lng\": 113.5767,\r\n            \"name\": \"河南省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"420000\",\r\n            \"lat\": 30.9776,\r\n            \"lng\": 114.2798,\r\n            \"name\": \"湖北省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"430000\",\r\n            \"lat\": 28.4783,\r\n            \"lng\": 113.0054,\r\n            \"name\": \"湖南省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"440000\",\r\n            \"lat\": 23.1189,\r\n            \"lng\": 113.2614,\r\n            \"name\": \"广东省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"450000\",\r\n            \"lat\": 23.4229,\r\n            \"lng\": 108.3252,\r\n            \"name\": \"广西壮族自治区\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"460000\",\r\n            \"lat\": 20.0308,\r\n            \"lng\": 110.3439,\r\n            \"name\": \"海南省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"500000\",\r\n            \"lat\": 29.5581,\r\n            \"lng\": 106.5103,\r\n            \"name\": \"重庆市\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"510000\",\r\n            \"lat\": 31.4662,\r\n            \"lng\": 104.0625,\r\n            \"name\": \"四川省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"520000\",\r\n            \"lat\": 27.0983,\r\n            \"lng\": 106.7432,\r\n            \"name\": \"贵州省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"530000\",\r\n            \"lat\": 25.6613,\r\n            \"lng\": 102.7661,\r\n            \"name\": \"云南省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"540000\",\r\n            \"lat\": 30.8268,\r\n            \"lng\": 91.2305,\r\n            \"name\": \"西藏自治区\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"610000\",\r\n            \"lat\": 34.7777,\r\n            \"lng\": 109.0063,\r\n            \"name\": \"陕西省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"620000\",\r\n            \"lat\": 36.09,\r\n            \"lng\": 103.7622,\r\n            \"name\": \"甘肃省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"630000\",\r\n            \"lat\": 36.5734,\r\n            \"lng\": 101.8066,\r\n            \"name\": \"青海省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"640000\",\r\n            \"lat\": 39.0106,\r\n            \"lng\": 106.3037,\r\n            \"name\": \"宁夏回族自治区\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"650000\",\r\n            \"lat\": 43.8024,\r\n            \"lng\": 87.5683,\r\n            \"name\": \"新疆维吾尔自治区\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"710000\",\r\n            \"lat\": 25.0491,\r\n            \"lng\": 121.5142,\r\n            \"name\": \"台湾省\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"810000\",\r\n            \"lat\": 22.2806,\r\n            \"lng\": 114.1544,\r\n            \"name\": \"香港特别行政区\",\r\n            \"count\":0\r\n        },\r\n        {\r\n            \"code\": \"820000\",\r\n            \"lat\": 22.2007,\r\n            \"lng\": 113.55,\r\n            \"name\": \"澳门特别行政区\",\r\n            \"count\":0\r\n        }\r\n    ]\r\n}\r\n\r\n\r\n\r\n","(function (window) {\r\n    window.EMapServerV2 = window.EMapServerV2 || {};\r\n    // 参考\r\n    window.EMapServerV2.queryData = {};\r\n    window.EMapServerV2.queryData.getConfig = function (cb) {\r\n        var self = this;\r\n        $.ajax({\r\n            url: './json/oldserver/queryData/resourceQueryConfig.json',\r\n            dataType: \"json\",\r\n            success: function (resourceConfig) {\r\n                self.service = new window.EMapServerV2.bufferService({\r\n                    server: EMAP_CONFIG.common.mongoService,\r\n                    resourceConfig: resourceConfig\r\n                });\r\n                cb&&cb();\r\n            }\r\n        })\r\n        $.ajax( \"./json/oldserver/queryData/equTableCorCode.json\").then(function (data) {\r\n            self.equTableAndCodeConfig = data;\r\n        })\r\n    }\r\n    /**\r\n     * 通过缓冲区查询\r\n     * @param param\r\n     */\r\n    window.EMapServerV2.queryData.bufferOrPolygonQuery = function (param, callBack) {\r\n        var self = this;\r\n        self.service.bufferOrPolygonQuery(param, function (err, data) {\r\n            if (err == null) {\r\n                $(\"#loadingnewoverlay\").hide();\r\n                self.addTypeNameToEqu(data);\r\n                callBack(data);\r\n            } else {\r\n                $(\"#loadingnewoverlay\").hide();\r\n                console.error(err)\r\n            }\r\n        })\r\n    }\r\n    /**\r\n     * 装备的返回数据添加装备类型\r\n     */\r\n    window.EMapServerV2.queryData.addTypeNameToEqu = function (data) {\r\n        var self = this;\r\n        if ($(\".requeryBox-inner-tap1\").find(\".active\").attr(\"listcode\") == 2) {//当展示装备列表时\r\n            for (var key in data) {\r\n                var EquInfArr = data[key];\r\n                for (var i = 0; i < EquInfArr.length; i++) {\r\n                    var tagInf = EquInfArr[i];\r\n                    var equTypeCode = \"\";\r\n                    if (tagInf.hasOwnProperty(\"EQUIPTYPECODE\")) {\r\n                        equTypeCode = tagInf.EQUIPTYPECODE;\r\n                    } else {\r\n                        var equTableNameConfig = self.equTableAndCodeConfig;\r\n                        a: for (var keyTwo in equTableNameConfig) {\r\n                            if (equTableNameConfig[keyTwo].code == tagInf.table_name) {\r\n                                equTypeCode = keyTwo;\r\n                                break a;\r\n                            }\r\n                        }\r\n                    }\r\n                    var equTypeName = G.equConfigInf.equContrast[equTypeCode];\r\n                    tagInf.EQUIPTYPENAME = equTypeName;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 通过缓冲区查询\r\n     * @param param\r\n     */\r\n    window.EMapServerV2.queryData.queryDataByBuffer = function (param, callBack) {\r\n        var self = this;\r\n        self.service.bufferOrPolygonQuery(param, function (err, data) {\r\n            if (err == null) {\r\n                callBack(data);\r\n                // console.log(data)\r\n            } else {\r\n                // console.error(err)\r\n            }\r\n        })\r\n\r\n    }\r\n    /**\r\n     * 行政区划查询\r\n     * @param param\r\n     */\r\n    window.EMapServerV2.queryData.queryDataByDis = function (param, callBackFun) {\r\n        var self = this;\r\n        //行政区划查询\r\n        // var param = {\r\n        //     //1=队伍 2=装备 …… 跟原来一致\r\n        //     \"resources\": [1],\r\n        //     \"point\": point,\r\n        //     \"districtCode\": \"530000\",//多个逗号分隔\r\n        //     \"keyword\": \"大\"\r\n        // }\r\n        self.service.districtQuery(param, function (err, data) {\r\n            if (err == null) {\r\n                // console.log(data);\r\n                callBackFun(data);\r\n            } else {\r\n                // console.error(err)\r\n            }\r\n        })\r\n    }\r\n    /**\r\n     * 查询详情\r\n     * @param param\r\n     * @param callBack\r\n     */\r\n    window.EMapServerV2.queryData.queryDetail = function (param, callBack) {\r\n        var self = this;\r\n        //查询详情\r\n        // var param = {\r\n        //     tableName: \"EQUIP_EQU_WATERTANKCAR\",\r\n        //     dataId: \"RFSGXFBU0001\"\r\n        // }\r\n        // var param = {\r\n        //     tableName: param.tableName,\r\n        //     dataId: param.dataId\r\n        // }\r\n        self.service.queryDetail(param, function (err, data) {\r\n            if (err == null) {\r\n                if (data.equTable) {\r\n                    self.getRelevnceEquTypeName(data.equTable);\r\n                }\r\n                callBack(data);\r\n            } else {\r\n                console.error(err)\r\n            }\r\n        });\r\n    }\r\n    /**\r\n     * 救援队关联装备的装备类型\r\n     */\r\n    window.EMapServerV2.queryData.getRelevnceEquTypeName = function (data) {\r\n        var self = this;\r\n        for (var key in data) {\r\n            var EquInfArr = data[key];\r\n            for (var i = 0; i < EquInfArr.length; i++) {\r\n                var tagInf = EquInfArr[i].tag;\r\n                var equTypeCode = \"\";\r\n                if (tagInf.hasOwnProperty(\"EQUIPTYPECODE\")) {\r\n                    equTypeCode = tagInf.EQUIPTYPECODE;\r\n                } else {\r\n                    var equTableNameConfig = self.equTableAndCodeConfig;\r\n                    a: for (var keyTwo in equTableNameConfig) {\r\n                        if (equTableNameConfig[keyTwo].code == key) {\r\n                            equTypeCode = keyTwo;\r\n                            break a;\r\n                        }\r\n                    }\r\n                }\r\n                var equTypeName = G.equConfigInf.equContrast[equTypeCode];\r\n                tagInf.EQUIPTYPENAME = equTypeName;\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     *装备的详情框\r\n     */\r\n    window.EMapServerV2.queryData.queryEquDetail = function (param, callBack) {\r\n        var self = this;\r\n        self.service.queryEquDetail(param, function (err, data) {\r\n            if (err == null) {\r\n                for (var key in param) {\r\n                    self.getDetailEquTypeName(data, key);\r\n                    callBack(data);\r\n                }\r\n            } else {\r\n                console.error(err)\r\n            }\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 装备的详情框的装备类型转换\r\n     * @param param\r\n     * @param callBackFun\r\n     */\r\n    window.EMapServerV2.queryData.getDetailEquTypeName = function (data, tableName) {\r\n        var self = this;\r\n        var tagInf = data[0].tag;\r\n        var equTypeCode = \"\";\r\n        for (var key in tagInf) {\r\n            if (key == \"EQUIPTYPECODE\") {\r\n                equTypeCode = tagInf[key];\r\n            }\r\n        }\r\n        if (!equTypeCode) {\r\n            var equTableNameConfig = self.equTableAndCodeConfig;\r\n            a: for (var keyTwo in equTableNameConfig) {\r\n                if (equTableNameConfig[keyTwo].code == tableName) {\r\n                    equTypeCode = keyTwo;\r\n                    break a;\r\n                }\r\n            }\r\n        }\r\n        var equTypeName = G.equConfigInf.equContrast[equTypeCode];\r\n        var newTypeName = \"\";\r\n        if (equTypeName && equTypeName != \"-\") {//如果能在类型字典表找到名称\r\n            newTypeName = equTypeName;\r\n        } else {//之前表中有code表示name的\r\n            newTypeName = equTypeCode;\r\n        }\r\n        tagInf.EQUIPTYPENAME = newTypeName;\r\n    }\r\n    //获取救援队类型\r\n    window.EMapServerV2.queryData.queryTree = function (param, callBackFun) {\r\n        var self = this;\r\n        this.getConfig(function(){\r\n            var param = {\r\n                resources: [1, 2]\r\n            };\r\n            self.service.getTypeList(param, function (err, data) {\r\n                if (err == null) {\r\n                    callBackFun &&callBackFun(data);\r\n                } else {\r\n                }\r\n            })\r\n        });\r\n    };\r\n    //查询关联装备\r\n    window.EMapServerV2.queryData.queryEquById = function (param, callBackFun) {\r\n        var self = this;\r\n        self.service.getTypeList(param, function (err, data) {\r\n            if (err == null) {\r\n                console.log('获取救援队类型 ', data);\r\n                callBackFun(data);\r\n            } else {\r\n                console.error(err)\r\n            }\r\n        })\r\n    };\r\n    //查询所有装备的展示字段\r\n    window.EMapServerV2.queryData.queryAllEquField = function (param, callBackFun) {\r\n        var self = this;\r\n        self.service.queryAllField(param, function (data) {\r\n            callBackFun(data);\r\n        })\r\n    };\r\n})(window);    ","(function (window) {\r\n    var service = {};\r\n    var DefenceObjConfig = {\r\n        \"development\": {\r\n            \"table\": \"BAS_DEVELOPMENT\",\r\n            \"fieldMap\": {\r\n                \"name\": \"DEFOBJNAME\",\r\n                \"phone\": \"RESPOTEL\",\r\n                \"address\": \"ADDRESS\",\r\n                \"respper\": \"RESPPER\"\r\n            }\r\n        },\r\n        \"school\": {\r\n            \"table\": \"BAS_SCHOOL\",\r\n            \"fieldMap\": {\r\n                \"name\": \"SCHOOLNAME\",\r\n                \"SCHOOLTYPENAME\": {\r\n                    \"from\": \"user_safety_CODE_SCHOOL_TYPE\",\r\n                    \"localField\": \"tag.DEFOBJTYPECODE\",\r\n                    \"foreignField\": \"tag.SCHOOLTYPECODE\",\r\n                    \"as\": \"DEFOBJTYPECODE\"\r\n                },\r\n                \"address\": \"ADDRESS\",\r\n                \"CONTACTPER\": \"RESPPER\",\r\n                \"CONTACTMTEL\": \"RESPMTEL\",\r\n                \"STUDENTNUM\": \"STUDENTNUM\",\r\n                \"FACULTYNUM\": \"FACULTYNUM\",\r\n                \"BUILDAREA\": \"BUILDAREA\",\r\n                \"district\": \"COUNTY\",\r\n                \"districtname\": \"COUNTY.tag.FULLNAME\",\r\n                \"objecttype\": \"DEFOBJTYPECODE\",\r\n                \"DEFOBJTYPECODE\": \"DEFOBJTYPECODE.tag.SCHOOLTYPENAME\"\r\n            },\r\n            \"relations\": [{\r\n                    \"table\": \"CODE_BAS_DISTRICT\",\r\n                    \"localField\": \"COUNTY\",\r\n                    \"foreignField\": \"DISTRICTCODE\"\r\n                },\r\n                {\r\n                    \"table\": \"CODE_SCHOOL_TYPE\",\r\n                    \"localField\": \"DEFOBJTYPECODE\",\r\n                    \"foreignField\": \"SCHOOLTYPECODE\"\r\n                }\r\n            ]\r\n        },\r\n        \"hospital\": {\r\n            \"table\": \"BAS_HEALTHORG\",\r\n            \"fieldMap\": {\r\n                \"name\": \"ORGNAME\",\r\n                \"phone\": \"RESPOTEL\",\r\n                \"address\": \"ADDRESS\",\r\n                \"respper\": \"RESPPER\"\r\n            }\r\n        }\r\n    };\r\n    var QueryConfig = {};\r\n    $.ajax({\r\n        url: './json/oldserver/queryservice.json',\r\n        type: 'get',\r\n        dataType: \"json\",\r\n        async: false,\r\n        success: function (res) {\r\n            QueryConfig = res;\r\n        },\r\n        error: function (res) {\r\n        }})\r\n    //人口热力\r\n    service.getpeopleInforData = function (point, dataA, EventTime, cb) {\r\n        this.servicemodule = new window.EMapServerV2.ServiceModule({\r\n            server: EMAP_CONFIG.common.mongoService\r\n        })\r\n        var peopletable = \"POPU_FEVER\";\r\n\r\n        if (EventTime.indexOf('时') != -1) {\r\n            var currenttime = EventTime.split('日')[1].split('时')[0] * 1;\r\n            if (currenttime >= 6 && currenttime <= 18) {\r\n                peopletable = \"POPU_FEVER\";\r\n            } else {\r\n                peopletable = \"POPU_FEVER_NIGHT\";\r\n            }\r\n        }\r\n        var queryOpts = {\r\n            point: point,\r\n            //指定每类最多返回的记录数\r\n            limit: 999999,\r\n            //查询的表配置\r\n            querys: {\r\n                \"POPU_DISTPOPU\": {\r\n                    \"table\": peopletable,\r\n                    \"//\": \"默认过滤条件\",\r\n                    \"//\": \"字段映射，需要查询的字段都在这里写\",\r\n                    \"fieldMap\": {\r\n                        \"poptotal\": \"POPTOTAL\",\r\n                        \"district\": \"DISTRICT\",\r\n                        \"downtow\": \"DISTNAME\",\r\n                        \"distcode\": \"DISTCODE\"\r\n                    }\r\n                }\r\n            },\r\n            //缓冲区\r\n            buffer: dataA\r\n        }\r\n        this.servicemodule.bufferQuery(queryOpts, function (err, data) {\r\n            if (err == null) {\r\n                cb(data);\r\n            } else {\r\n                console.error('查询失败：' + err.message)\r\n            }\r\n        })\r\n    };\r\n    //人口总数\r\n    service._querypeopleTotaldata = function (dataA, districtCode, callback) {\r\n        var self = this;\r\n        // self.querypeopleTotalData = null;\r\n        var callBackGetData = function (data) {\r\n            var people = 0;\r\n            if (data.length > 0) {\r\n                people = parseInt(data[0].POPU_DISTPOPU.POPTOTAL); //查询到的数据\r\n                callback(people);\r\n            }\r\n        }\r\n        service.bufferStatistics(callBackGetData, dataA, districtCode);\r\n    };\r\n\r\n    //查询乡镇区县\r\n    service.getDistrictInforData = function (cb, dataA, point) {\r\n        this.servicemodule = new window.EMapServerV2.ServiceModule({\r\n            server: EMAP_CONFIG.common.mongoService\r\n        })\r\n\r\n        var queryOpts = {\r\n            point: point,\r\n            //指定每类最多返回的记录数\r\n            limit: 9999,\r\n            //查询的表配置\r\n            querys: {\r\n                \"POPU_DISTPOPU\": {\r\n                    \"table\": \"POPU_DISTPOPU\",\r\n                    \"fieldMap\": {\r\n                        \"poptotal\": \"POPTOTAL\",\r\n                        \"district\": \"DISTRICT\",\r\n                        \"downtow\": \"DISTNAME\",\r\n                        \"distcode\": \"DISTCODE\"\r\n                    }\r\n                }\r\n            },\r\n            //缓冲区\r\n            buffer: dataA,\r\n        }\r\n        this.servicemodule.bufferQuery(queryOpts, function (err, data) {\r\n            if (err == null) {\r\n                cb(data);\r\n            } else {\r\n                console.error('查询失败：' + err.message)\r\n            }\r\n        })\r\n    };\r\n\r\n    /**\r\n     * 查询多个类型的数据\r\n     * @param param  typecode 编码  dataA为polygon point为事件点\r\n     * @param cb\r\n     */\r\n    service.getCurrencyData = function (param, cb) {\r\n        this.servicemodule = new window.EMapServerV2.ServiceModule({\r\n            server: EMAP_CONFIG.common.mongoService\r\n        })\r\n        var id = param.id;\r\n        var typecode = param.typecode;\r\n        var dataA = param.dataA;\r\n        var point = param.point;\r\n        var near = param.near;\r\n        var distanceField = param.distanceField;\r\n        var paging = param.paging;\r\n        var pageIndex = param.pageIndex;\r\n        var pageSize = param.pageSize;\r\n        var keyWord = param.keyWord;\r\n        var districtCode = param.districtCode;\r\n        var query = {};\r\n        if (typecode == \"enterprise\" || typecode == \"derivativerisk\") //重点企业和地质灾害\r\n        {\r\n            query = QueryConfig[typecode];\r\n        } else {\r\n            query[typecode] = QueryConfig[typecode];\r\n        }\r\n        if (param.query) {\r\n            if (query[typecode].query) {\r\n                Object.assign(query[typecode].query, param.query);\r\n            } else {\r\n                query[typecode].query = param.query;\r\n            }\r\n        } else {\r\n            if (!param.rescueTypecodes && typecode == 'RescueTeam※03') { //解决赋值rescuetypecode后，再次查询由于没有清空类型筛选导致救援队伍详情出不来\r\n                query[typecode].query = {}\r\n            } else {\r\n                query[typecode].query = query[typecode].query || {};\r\n                Object.assign(query[typecode].query, param.query);\r\n            }\r\n        }\r\n        if (keyWord) {\r\n            var fbsArr = [\"\\\\\", \"$\", \"(\", \")\", \"*\", \"+\", \".\", \"[\", \"]\", \"?\", \"^\", \"{\", \"}\", \"|\"];\r\n            for (var key in fbsArr) {\r\n                for (var kw in keyWord) {\r\n                    if (keyWord[kw].indexOf(fbsArr[key]) != -1) {\r\n                        keyWord[kw] = keyWord[kw].replace(fbsArr[key], \"\\\\\" + fbsArr[key]);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        var queryOpts = {\r\n            id: id,\r\n            keyWord: keyWord,\r\n            districtCode: districtCode,\r\n            point: point,\r\n            near: near,\r\n            distanceField: distanceField,\r\n            paging: paging,\r\n            pageIndex: pageIndex,\r\n            pageSize: pageSize,\r\n            //指定每类最多返回的记录数\r\n            limit: 99999,\r\n            //缓冲区\r\n            buffer: dataA,\r\n            //查询的表配置\r\n            querys: query\r\n        }\r\n        //危化企业烈度圈标志位\r\n        if (param.earthLevel) var earthLevel = param.earthLevel;\r\n        this.servicemodule.bufferQuery(queryOpts, function (err, data) {\r\n            if (err == null) {\r\n                if (cb) {\r\n                    //危化企业烈度圈标志位\r\n                    if (earthLevel) data['level'] = earthLevel;\r\n                    if (!data[typecode]) {\r\n                        var typecodeArr = [\"collapse\", \"mudslide\", \"falldown\", \"landslide\"];\r\n                        for (var i in typecodeArr) {\r\n                            var code = typecodeArr[i];\r\n                            for (var kk in data[code]) {\r\n                                data[code][kk].level = earthLevel;\r\n                            }\r\n                        }\r\n                    } else {\r\n                        for (var kk in data[typecode]) {\r\n                            data[typecode][kk].level = earthLevel;\r\n                        }\r\n                    }\r\n                    cb(data);\r\n                }\r\n            } else {\r\n                console.error('查询失败：' + err.message)\r\n            }\r\n        })\r\n    }\r\n    // 查询多个类型的统计数量\r\n    service.getCurrencyCount = function (cb, dataA) {\r\n        this.servicemodule = new window.EMapServerV2.ServiceModule({\r\n            server: EMAP_CONFIG.common.mongoService\r\n        })\r\n        var queryOpts = {\r\n            //查询的表配置\r\n            querys: {\r\n                \"居民区\": {\r\n                    \"table\": \"BAS_DEVELOPMENT\",\r\n                    \"fieldMap\": {\r\n                        \"name\": \"DEFOBJNAME\",\r\n                        \"phone\": \"RESPOTEL\",\r\n                        \"address\": \"ADDRESS\",\r\n                        \"respper\": \"RESPPER\"\r\n                    }\r\n                },\r\n                \"学校\": {\r\n                    \"table\": \"BAS_SCHOOL\",\r\n                    \"fieldMap\": {\r\n                        \"name\": \"SCHOOLNAME\",\r\n                        \"phone\": \"RESPOTEL\",\r\n                        \"address\": \"ADDRESS\",\r\n                        \"respper\": \"RESPPER\"\r\n                    }\r\n                },\r\n                \"医院\": {\r\n                    \"table\": \"BAS_HEALTHORG\",\r\n                    \"fieldMap\": {\r\n                        \"name\": \"ORGNAME\",\r\n                        \"phone\": \"RESPOTEL\",\r\n                        \"address\": \"ADDRESS\",\r\n                        \"respper\": \"RESPPER\"\r\n                    }\r\n                },\r\n                \"灾情信息员\": {\r\n                    \"table\": \"JC_DISINFOPER\",\r\n                    \"//\": \"灾情信息员\",\r\n                    \"fieldMap\": {\r\n                        \"name\": \"DISINFOPERNAME\",\r\n                        \"phone\": \"MOBPHONE\",\r\n                        \"districtname\": \"DISTRICTNAME\",\r\n                        \"post\": \"POST\"\r\n                    }\r\n                }\r\n            },\r\n            //缓冲区\r\n            bufferList: [dataA]\r\n        }\r\n        this.servicemodule.bufferStatistics(queryOpts, function (err, data) {\r\n            if (err == null) {\r\n                if (cb) {\r\n                    cb(data);\r\n                }\r\n            } else {\r\n                console.error('查询失败：' + err.message)\r\n            }\r\n        })\r\n    }\r\n    /**\r\n     * 获取资源统计\r\n     * @param opts\r\n     * @param opts.level\r\n     * @param opts.typecodes\r\n     * @param opts.geometry [Array]  //[{level:\"Ⅵ级\", geometry:{}},{level:\"Ⅶ级\", geometry:{}}}\r\n     * @param [opts.query]\r\n     */\r\n    service.getStatistics = function (opts, callback) {\r\n        var servicemodule = new window.EMapServerV2.ServiceModule({\r\n            server: EMAP_CONFIG.common.mongoService,\r\n        });\r\n        //var deffered = jQuery.Deferred();\r\n        // return new Promise((resolve, reject) => {\r\n        var queries = {};\r\n        var result = {};\r\n        let counter = 0;\r\n        opts.typecodes.forEach(function (typecode) {\r\n            queries[typecode] = QueryConfig[typecode];\r\n            // if (opts.query) {\r\n            if (queries[typecode].query) {\r\n                Object.assign(queries[typecode].query, opts.query);\r\n            } else {\r\n                queries[typecode].query = opts.query;\r\n            }\r\n        });\r\n        var level = opts.level;\r\n        var geometry = opts.geometry;\r\n        var queryOpts = {\r\n            querys: queries,\r\n            bufferList: [geometry],\r\n        };\r\n        servicemodule.bufferStatistics(queryOpts, function (err, data) {\r\n            if (err) {\r\n                //deffered.reject(err);\r\n                callback(err);\r\n            }\r\n            result[level] = {};\r\n            result[level].data = data[0];\r\n            result[level].total = 0;\r\n            for (var typecode in result[level].data) {\r\n                result[level].total += result[level].data[typecode].count;\r\n            }\r\n            // if (counter === opts.typecodes.length - 1) {\r\n            // deffered.resolve(result);\r\n            callback(result);\r\n            // }\r\n            // counter++;\r\n        });\r\n        // return deffered.promise();\r\n        // });\r\n    }\r\n    service.bufferStatistics = function (callback, dataA, districtCode) {\r\n        var self = this;\r\n        self.dataA = dataA;\r\n        this.servicemodule = new window.EMapServerV2.ServiceModule({\r\n            server: EMAP_CONFIG.common.mongoService\r\n        })\r\n        var bufferList = dataA ? [dataA] : [];\r\n        var statisticsOpts = {\r\n            querys: {\r\n                \"POPU_DISTPOPU\": {\r\n                    \"table\": \"POPU_FEVER\",\r\n                    \"///\": \"计数类型，1=按照记录数统计，2=按照记录某些数值属性统计\",\r\n                    \"sumType\": 2,\r\n                    \"//\": \"统计人口的字段，可以指定多个数字类型的字段\",\r\n                    \"sumFields\": [\"POPTOTAL\"]\r\n                }\r\n            },\r\n            districtCode: districtCode,\r\n            codes: districtCode,\r\n            districtField: 'DISTCODE',\r\n            bufferList: bufferList\r\n        }\r\n        this.servicemodule.bufferStatistics(statisticsOpts, function (err, data) {\r\n            if (err == null) {\r\n                // var text = '统计结果：' + JSON.stringify(data, null, 4) ;\r\n                // console.log(text)\r\n                if (callback) {\r\n                    callback(data, self.dataA);\r\n                }\r\n            } else {\r\n                // console.error('查询失败：' + err.message)\r\n                callback([]);\r\n            }\r\n        })\r\n    };\r\n\r\n    //受灾区县\r\n    service._queryDistricts = function (point, dataA, cb) {\r\n        var callback1 = function (data) {\r\n            cb(data);\r\n        }\r\n        service.getDistrictInforData(callback1, dataA, point)\r\n    }\r\n    //受灾区县的多边形\r\n    service._queryDistrictPolygon = function (point, dataA, cb) {\r\n        this.servicemodule = new window.EMapServerV2.ServiceModule({\r\n            server: EMAP_CONFIG.common.mongoService\r\n        })\r\n        var queryOpts = {\r\n            point: point,\r\n            //指定每类最多返回的记录数\r\n            limit: 9999,\r\n            eId: 'siptea',\r\n            //查询的表配置\r\n            querys: {\r\n                \"COUNTY\": {\r\n                    \"table\": \"county0.06\",\r\n                    \"fieldMap\": {\r\n                        \"name\": \"name\",\r\n                        \"adcode\": \"adcode\",\r\n                        \"gov\": \"gov\"\r\n                    }\r\n                }\r\n            },\r\n            //缓冲区\r\n            buffer: dataA,\r\n        }\r\n        this.servicemodule.bufferQuery(queryOpts, function (err, data) {\r\n            if (err == null) {\r\n                cb(data);\r\n            } else {\r\n                console.error('查询失败：' + err.message)\r\n            }\r\n        })\r\n    }\r\n\r\n    //查询乡镇面\r\n    service._queryTownPolygon = function (url, point, dataA, cb) {\r\n        var geom = g2.sfs.GeometryFactory.createGeometryFromGeoJson(dataA).asWkt();\r\n\r\n        $.ajax({\r\n            url: url + '/api/public/dlgbouaxiang/list/v1',\r\n            type: 'POST',\r\n            dataType: \"json\",\r\n            async: false,\r\n            contentType: \"application/json\",\r\n            data: '{\"polygon\":\"' + geom + '\"}',\r\n            // data: JSON.stringify({\r\n            //     \"polygon\": geom\r\n            // }),\r\n            success: function (res) {\r\n                if (res.success || res.code === 0) {\r\n                    var dataArr = res.data;\r\n                    var result = []\r\n                    for (var i in dataArr) {\r\n                        if (dataArr[i].centerid) {\r\n                            var tmpitem = {};\r\n                            tmpitem.tag = {};\r\n                            tmpitem.tag.name = dataArr[i].name;\r\n                            tmpitem.tag.adcode = dataArr[i].pac;\r\n                            tmpitem.shape_area = dataArr[i].shapeArea;\r\n                            if (g2.sfs.GeometryFactory.createGeometryFromWkt(dataArr[i].centerid, 4326)) { //\r\n                                var startpoint = new g2.sfs.Point({\r\n                                    x: point[0],\r\n                                    y: point[1],\r\n                                    spatialReference: 4326\r\n                                });\r\n                                var endpoint = g2.sfs.GeometryFactory.createGeometryFromWkt(dataArr[i].centerid, 4326)\r\n\r\n                                var polyline = new g2.sfs.Polyline({\r\n                                    spatialReference: 4326\r\n                                });\r\n                                var path = new g2.sfs.Path({\r\n                                    spatialReference: 4326\r\n                                });\r\n                                path.addPoint(startpoint);\r\n                                path.addPoint(endpoint);\r\n                                polyline.addGeometry(path);\r\n                                var projectService = new g2.sfs.CoordinateTransform();\r\n                                var measureService = new g2.sfs.MeasureService({\r\n                                    projectService: projectService\r\n                                });\r\n                                var length = measureService.length(polyline);\r\n                                tmpitem._distance = length;\r\n                                tmpitem._id = dataArr[i].objectid;\r\n                                tmpitem.centerid = dataArr[i].centerid;\r\n                                result.push(tmpitem);\r\n                            }\r\n                        }\r\n                    }\r\n\r\n\r\n                    result.sort(function (a, b) {\r\n                        if (a._distance < b._distance) {\r\n                            return -1;\r\n                        } else if (a._distance == b._distance) {\r\n                            return 0;\r\n                        } else {\r\n                            return 1;\r\n                        }\r\n                    })\r\n                    cb(result);\r\n                }\r\n            },\r\n            error: function (err) {\r\n\r\n            }\r\n        })\r\n\r\n        // this.servicemodule = new ServiceModule({\r\n        //     server: EMAP_CONFIG.common.mongoService\r\n        // })\r\n        // var queryOpts = {\r\n        //     point: point,\r\n        //     //指定每类最多返回的记录数\r\n        //     limit: 9999,\r\n        //     eId: 'safety',\r\n        //     //查询的表配置\r\n        //     querys: {\r\n        //         \"TOWN\": {\r\n        //             \"table\": \"BAS_TOWN\",\r\n        //             \"fieldMap\": {\r\n        //                 \"name\": \"TOWN\",\r\n        //                 \"adcode\":\"TOWN_CODE\"\r\n        //             }\r\n        //         }\r\n        //     },\r\n        //     //缓冲区\r\n        //     buffer: dataA,\r\n        // }\r\n        // this.servicemodule.bufferQuery(queryOpts, function (err, data) {\r\n        //     if (err == null) {\r\n        //         cb(data);\r\n        //     } else {\r\n        //         console.error('查询失败：' + err.message)\r\n        //     }\r\n        // })\r\n    }\r\n\r\n    //查询城市\r\n    service._queryCity = function (point, dataA, cb) {\r\n        this.servicemodule = new window.EMapServerV2.ServiceModule({\r\n            server: EMAP_CONFIG.common.mongoService\r\n        })\r\n\r\n        var queryOpts = {\r\n            point: point,\r\n            //指定每类最多返回的记录数\r\n            limit: 9999,\r\n            eId: \"siptea\",\r\n            //查询的表配置\r\n            querys: {\r\n                \"city0.03\": {\r\n                    \"table\": \"city0.03\",\r\n                    \"fieldMap\": {\r\n                        \"name\": \"name\",\r\n                        \"adcode\": \"adcode\",\r\n                        \"gov\": \"gov\"\r\n                    }\r\n                }\r\n            },\r\n            //缓冲区\r\n            buffer: dataA,\r\n        }\r\n        this.servicemodule.bufferQuery(queryOpts, function (err, data) {\r\n            if (err == null) {\r\n                cb(data[\"city0.03\"]);\r\n            } else {\r\n                console.error('查询失败：' + err.message)\r\n            }\r\n        })\r\n    }\r\n\r\n    //查询防护目标\r\n    service.getProctectObjectDatacount = function (cb, dataA, point) {\r\n        this.servicemodule = new window.EMapServerV2.ServiceModule({\r\n            server: EMAP_CONFIG.common.mongoService\r\n        })\r\n        var queryOpts = {\r\n            //查询的表配置\r\n            querys: DefenceObjConfig,\r\n            //缓冲区\r\n            bufferList: [dataA]\r\n        }\r\n        this.servicemodule.bufferStatistics(queryOpts, function (err, data) {\r\n            if (err == null) {\r\n                if (cb) {\r\n                    cb(data);\r\n                }\r\n            } else {\r\n                console.error('查询失败：' + err.message)\r\n            }\r\n        })\r\n    }\r\n    /**\r\n     * 查询列表数据\r\n     * @param opts\r\n     * @param opts.keyWord\r\n     * @param opts.level\r\n     * @param opts.typecode\r\n     * @param opts.geometry 几何对象（geojson）\r\n     * @param [opts.fields] 字段列表（筛选字段）\r\n     * @param [opts.query] 参数查询\r\n     * @param callback\r\n     * @param ctx\r\n     */\r\n    service.getMapDataList = function (opts, callback, ctx) {\r\n        var self = this;\r\n        var typeCodeQuery = QueryConfig[opts.typecode];\r\n        var param = {};\r\n        if (typeCodeQuery) {\r\n\r\n\r\n            var tableName = typeCodeQuery.table;\r\n            var config = this.getSelectColumn(typeCodeQuery, opts.fields);\r\n            var fieldProject = config.fieldProject;\r\n            var query = {};\r\n            query.$and = [];\r\n            if (opts.geometry) {\r\n                var geom = {\r\n                    $geoIntersects: {\r\n                        $geometry: opts.geometry,\r\n                    },\r\n                };\r\n                query.$and.push({\r\n                    geom: geom\r\n                });\r\n            }\r\n            if (opts.query) {\r\n                query.$and.push(opts.query);\r\n            }\r\n            if (opts.keyWord) {\r\n                var keyWords = [];\r\n                if (Array.isArray(opts.keyWord)) {\r\n                    keyWords = opts.keyWord;\r\n                } else if (typeof (opts.keyWord) == 'string') {\r\n                    keyWords.push(opts.keyWord);\r\n                }\r\n                var self = this;\r\n                keyWords.forEach(function (keyWord) {\r\n                    var kwMatch = self.getSearchMatch(keyWord, typeCodeQuery);\r\n                    query.$and.push(kwMatch);\r\n                });\r\n            }\r\n            if (opts.districtCode) {\r\n                typeCodeQuery.districtField = typeCodeQuery.districtField || 'DISTRICTCODE';\r\n                var districtMatch = this.getDistrictMatch(opts.districtCode, typeCodeQuery);\r\n                if (districtMatch && districtMatch.length > 0) {\r\n                    query.$and = query.$and.concat(districtMatch);\r\n                }\r\n            }\r\n            if (query.$and.length === 0) {\r\n                delete query.$and;\r\n            }\r\n            param[tableName] = {\r\n                query: query,\r\n                select: config.select\r\n            }\r\n            $.ajax({\r\n                url: EMAP_CONFIG.common.mongoService + '/dataOperate/queryMulti',\r\n                dataType: 'json',\r\n                type: 'post',\r\n                data: {\r\n                    eId: 'safety',\r\n                    data: JSON.stringify(param),\r\n                },\r\n                success: function (data) {\r\n                    var res = self.formatResultColumns(data.data[tableName], fieldProject)\r\n                    callback && callback.call(ctx, null, res);\r\n                },\r\n                error: function (err) {\r\n                    callback && callback.call(ctx, err);\r\n                }\r\n            });\r\n        }\r\n    }\r\n    /**\r\n     * 拼接关键字条件--预留方法\r\n     * @param kw\r\n     * @param resource\r\n     */\r\n    service.getSearchMatch = function (kw, resource) {\r\n        if (kw) {\r\n            var query = {};\r\n            var filter = {};\r\n            filter['$regex'] = \"^.*\" + kw + \".*$\";\r\n            query['tag.' + resource.keyWordFields] = filter;\r\n            return query;\r\n        } else {\r\n            return null;\r\n        }\r\n    }\r\n    service.getDistrictMatch = function (districtCode, resource) {\r\n        var match = null;\r\n        if (districtCode && districtCode !== '000000' && resource.districtField) {\r\n            var districtCodes = districtCode.split(','),\r\n                districtField = resource.districtField;\r\n            var or = [],\r\n                districtKey = null;\r\n            if (resource.districtKey) {\r\n                districtKey = resource.districtKey;\r\n            } else {\r\n                districtKey = 'tag.' + districtField;\r\n            }\r\n            var eachFilter = {};\r\n            const regStrArr = [];\r\n            for (var i = 0; i < districtCodes.length; i++) {\r\n                var districtCode = districtCodes[i];\r\n                if (districtCode) {\r\n                    regStrArr.push(getDistrictRegex(districtCode));\r\n\r\n                }\r\n            }\r\n            eachFilter[districtKey] = {\r\n                $regex: regStrArr.join('|')\r\n            };\r\n            or.push(eachFilter);\r\n            match = or;\r\n        } else {\r\n            var matchObj = {};\r\n            // matchObj['tag.'+resource.districtField] = {\r\n            //     $regex: '.*',\r\n            // };\r\n            match = []\r\n            console.debug('ignore district filter');\r\n        }\r\n        return match;\r\n\r\n        function getDistrictRegex(code) {\r\n            var c = code.substr(0, 6);\r\n            if ('000000' == c) { //全国不过滤\r\n                c = '.*';\r\n            } else if (/^\\d{2}0000$/.test(c)) {\r\n                c = c.substr(0, 2) + '.*';\r\n            } else if (/^\\d{4}00$/.test(c)) {\r\n                c = c.substr(0, 4) + '.*';\r\n            } else { //灾情信息员code都是12位\r\n                c = c + '.*'\r\n            }\r\n            return '^' + c + '$';\r\n        }\r\n    }\r\n    service.getSelectColumn = function (resource, fields) {\r\n        var fieldMap = resource.fieldMap;\r\n        var selectArr = [];\r\n        var fieldProject = {};\r\n        selectArr.push(\"_id\");\r\n        selectArr.push(\"geom\");\r\n        for (var key in fieldMap) {\r\n            if (fieldMap.hasOwnProperty(key)) {\r\n                var originalField = fieldMap[key]\r\n                if (fields.includes(key)) {\r\n                    fieldProject[originalField] = key;\r\n                    selectArr.push(\"tag.\" + originalField);\r\n                }\r\n            }\r\n        }\r\n        var result = {};\r\n\r\n        result.select = selectArr.join(\" \");\r\n        result.fieldProject = fieldProject;\r\n        return result;\r\n    }\r\n    service.formatResultColumns = function (data, fieldProject) {\r\n        data.forEach(function (element) {\r\n            var tag = element.tag;\r\n            Object.keys(tag).forEach(function (key) {\r\n                element[key] = tag[key];\r\n            });\r\n            for (var key in element) {\r\n                if (element.hasOwnProperty(key)) {\r\n                    if (fieldProject[key]) {\r\n                        element[fieldProject[key]] = element[key];\r\n                    }\r\n                }\r\n            }\r\n        });\r\n        return data;\r\n    }\r\n    window.EMapServerV2 = window.EMapServerV2 || {};\r\n    // 参考\r\n    window.EMapServerV2.queryservice = service;\r\n})(window);","(function (window) {\r\n    window.EMapServerV2 = window.EMapServerV2 || {};\r\n    // 参考\r\n    window.EMapServerV2.typeTree = {};\r\n    /*\r\n    *\r\n    * 点击出现ztree树\r\n    *\r\n    * */\r\n    window.EMapServerV2.typeTree.getZtree = function () {\r\n        var self = this;\r\n        G.equConfigInf = {};\r\n        //查询结果的回调\r\n        var callBackFun = function (data) {\r\n            //ztree树的弹框\r\n            var setting = {\r\n                check: {\r\n                    enable: true,\r\n                    chkboxType: { \"Y\": \"ps\", \"N\": \"ps\" }\r\n                },\r\n                view: {\r\n                    dblClickExpand: false\r\n                },\r\n                data: {\r\n                    simpleData: {\r\n                        enable: true\r\n                    }\r\n                },\r\n                callback: {\r\n                    beforeClick: beforeClick,\r\n                    onCheck: onCheck\r\n                }\r\n            };\r\n            var data1 = data[0];\r\n            var data2 = data[1];\r\n            //json数据\r\n            var edu_type_list = [];\r\n            for (var i = 0; i < data1.length; i++) {\r\n                var obj = {};\r\n                obj.id = data1[i].id;\r\n                obj.pId = data1[i].pId;\r\n                obj.name = data1[i].label;\r\n                obj.table = data1[i].table;\r\n                obj.field = data1[i].field;\r\n                obj.value = data1[i].value;\r\n                obj.checked = true;\r\n                edu_type_list.push(obj)\r\n            }\r\n            var learner_list = [];\r\n            var equContrast = {};\r\n            for (var j = 0; j < data2.length; j++) {\r\n                if (data2[j].value.length > 1 && data2[j].value.length < 8) {\r\n                    var obj1 = {};\r\n                    obj1.id = data2[j].value;\r\n                    obj1.pId = data2[j].pId;\r\n                    obj1.name = data2[j].label;\r\n                    obj1.table = data2[j].table;\r\n                    obj1.field = data2[j].field;\r\n                    obj1.value = data2[j].value;\r\n                    obj1.checked = true;\r\n                    learner_list.push(obj1);\r\n                    equContrast[data2[j].value] = data2[j].label;\r\n                }\r\n            }\r\n            G.equConfigInf.equContrast = equContrast;\r\n            function beforeClick(treeId, treeNode) {\r\n                var zTree = $.fn.zTree.getZTreeObj(treeId);\r\n                zTree.checkNode(treeNode, !treeNode.checked, null, true);\r\n                return false;\r\n            }\r\n\r\n            function onCheck(e, treeId, treeNode) {\r\n                var zTree = $.fn.zTree.getZTreeObj(treeId),\r\n                    nodes = zTree.getCheckedNodes(true),\r\n                    v = \"\";\r\n                //返回checkbox值\r\n                for (var i = 0, l = nodes.length; i < l; i++) {\r\n                    if (!nodes[i].isParent) {\r\n                        v += nodes[i].name + \",\";//多值用,隔开\r\n                    }\r\n                }\r\n                if (v.length > 0) v = v.substring(0, v.length - 1);\r\n                var cityObj = $(\"#input_\" + treeId);\r\n                cityObj.attr(\"value\", v);\r\n            }\r\n            function showMenu(v) {\r\n                var cityObj = $(\"#input_\" + v + \"_a\");\r\n                var cityOffset = $(\"#input_\" + v + \"_a\").offset();\r\n                $(\"#menuContent ul\").hide();\r\n                $(\"#\" + v).show();\r\n                $(\"#menuContent\").css({ left: cityOffset.left + \"px\", top: cityOffset.top + cityObj.outerHeight() + \"px\" }).slideDown(\"fast\");\r\n\r\n                $(\"body\").bind(\"mousedown\", onBodyDown);\r\n            }\r\n            function hideMenu() {\r\n                $(\"#menuContent\").fadeOut(\"fast\");\r\n                $(\"body\").unbind(\"mousedown\", onBodyDown);\r\n            }\r\n            function onBodyDown(event) {\r\n                if (!(event.target.id == \"menuBtn\" || event.target.id == \"citySel\" || event.target.id == \"menuContent\" || $(event.target).parents(\"#menuContent\").length > 0)) {\r\n                    hideMenu();\r\n                }\r\n            }\r\n\r\n            $(document).ready(function () {\r\n                //初始化ztree\r\n                $.fn.zTree.init($(\"#treeDemo\"), setting, edu_type_list);\r\n                $.fn.zTree.init($(\"#learner_list\"), setting, learner_list);\r\n                G.equConfigInf.objTree1 = $.fn.zTree.getZTreeObj(\"treeDemo\");\r\n                G.equConfigInf.objTree2 = $.fn.zTree.getZTreeObj(\"learner_list\");\r\n            });\r\n        };\r\n        window.EMapServerV2.queryData.queryTree([1, 2], callBackFun);\r\n    };\r\n})(window);        "],"sourceRoot":""}
